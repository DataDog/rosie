{
  "rules": [
    {
      "name": "python-security/request-verify",
      "language": "PYTHON",
      "type": "AST_CHECK",
      "entity_checked": "FUNCTION_CALL",
      "code": "ZnVuY3Rpb24gdmlzaXQobm9kZSkgewogIGlmKCFub2RlLmFyZ3VtZW50cyB8fCAhbm9kZS5hcmd1bWVudHMudmFsdWVzIHx8ICFub2RlLmNvbnRleHQpIHsKICAgIHJldHVybjsKICB9CiAgCiAgY29uc3QgZnVuY3Rpb25zID0gWyJwb3N0IiwgImdldCIsICJwdXQiLCAicGF0Y2giXTsKICAKICBpZiAoISBub2RlLmZ1bmN0aW9uTmFtZSB8fCAhZnVuY3Rpb25zLmluY2x1ZGVzKG5vZGUuZnVuY3Rpb25OYW1lLnZhbHVlKSkgewogICAgcmV0dXJuOwogIH0KICAKICBjb25zdCBhcmd1bWVudHMgPSBub2RlLmFyZ3VtZW50cy52YWx1ZXM7CiAgY29uc3QgbmJBcmd1bWVudHMgPSBub2RlLmFyZ3VtZW50cy52YWx1ZXMubGVuZ3RoOwogIGNvbnN0IGFsbFBhY2thZ2VzID0gbm9kZS5jb250ZXh0LmltcG9ydHMuZmlsdGVyKHIgPT4gci5wYWNrYWdlcykuZmxhdE1hcChpID0+IGkucGFja2FnZXMubWFwKHAgPT4gcC5uYW1lLnN0cikpOwogIGNvbnN0IHVzZVJlcXVlc3RzUGFja2FnZSA9IGFsbFBhY2thZ2VzLmZpbHRlcihpID0+IGkgPT09ICJyZXF1ZXN0cyIpLmxlbmd0aCA+IDA7CgoKICBjb25zdCBoYXNWZXJpZnkgPSBub2RlLmFyZ3VtZW50cy52YWx1ZXMuZmlsdGVyKGEgPT4gYS5uYW1lICYmIGEubmFtZS52YWx1ZSA9PT0gInZlcmlmeSIgJiYgYS52YWx1ZSAmJiBhLnZhbHVlLnZhbHVlID09PSAiRmFsc2UiKS5sZW5ndGggPiAwOwogIAogIGZ1bmN0aW9ucy5mb3JFYWNoKGZ1bmN0aW9uTmFtZSA9PiB7CiAgICBjb25zdCBpbXBvcnRGcm9tID0gbm9kZS5jb250ZXh0LmltcG9ydHMKICAgIAkuZmlsdGVyKHIgPT4gci5wa2cgJiYgci5wa2cudmFsdWUgPT09ICJyZXF1ZXN0cyIgJiYgci5lbGVtZW50cyAmJiByLmVsZW1lbnRzLmZpbHRlcihlID0+IGUubmFtZSkubWFwKGUgPT4gZS5uYW1lLnZhbHVlKS5pbmNsdWRlcyhmdW5jdGlvbk5hbWUpKTsKCQljb25zdCB1c2VJbXBvcnRGcm9tID0gaW1wb3J0RnJvbS5sZW5ndGggPiAwOwoKICAgIGlmKCh1c2VSZXF1ZXN0c1BhY2thZ2UgJiYgaGFzVmVyaWZ5ICYmIG5vZGUubW9kdWxlT3JPYmplY3QgJiYgbm9kZS5mdW5jdGlvbk5hbWUgJiYgbm9kZS5mdW5jdGlvbk5hbWUudmFsdWUgPT09IGZ1bmN0aW9uTmFtZSAmJiBub2RlLm1vZHVsZU9yT2JqZWN0LnZhbHVlID09PSAicmVxdWVzdHMiKQogICAgICB8fCAodXNlSW1wb3J0RnJvbSAmJiBub2RlLmZ1bmN0aW9uTmFtZS52YWx1ZSA9PT0gZnVuY3Rpb25OYW1lICYmIGhhc1ZlcmlmeSkpewogICAgY29uc3QgZXJyb3IgPSBidWlsZEVycm9yKG5vZGUuc3RhcnQubGluZSwgbm9kZS5zdGFydC5jb2wsIG5vZGUuZW5kLmxpbmUsIG5vZGUuZW5kLmNvbCwgInZlcmlmeSBwYXJhbWV0ZXIgaXMgRmFsc2UiLCAiQ1JJVElDQUwiLCAiU0VDVVJJVFkiKTsKICAgIGNvbnN0IHZlcmlmeUFyZ3VtZW50ID0gbm9kZS5hcmd1bWVudHMudmFsdWVzLmZpbHRlcihhID0+IGEubmFtZSAmJiBhLm5hbWUudmFsdWUgPT0gInZlcmlmeSIpWzBdOwoKICAgIGNvbnN0IGVkaXQgPSBidWlsZEVkaXRVcGRhdGUodmVyaWZ5QXJndW1lbnQudmFsdWUuc3RhcnQubGluZSwgdmVyaWZ5QXJndW1lbnQudmFsdWUuc3RhcnQuY29sLCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2ZXJpZnlBcmd1bWVudC52YWx1ZS5lbmQubGluZSwgdmVyaWZ5QXJndW1lbnQudmFsdWUuZW5kLmNvbCwgIlRydWUiKTsKICAgIGNvbnN0IGZpeCA9IGJ1aWxkRml4KCJyZXBsYWNlIHdpdGggVHJ1ZSIsIFtlZGl0XSk7CiAgICBhZGRFcnJvcihlcnJvci5hZGRGaXgoZml4KSk7CiAgfQogIH0pOwogIAp9",
      "regex": null
    },
    {
      "name": "python-security/subprocess-shell-true",
      "language": "PYTHON",
      "type": "AST_CHECK",
      "entity_checked": "FUNCTION_CALL",
      "code": "ZnVuY3Rpb24gdmlzaXQobm9kZSwgZmlsZW5hbWUsIGNvZGUpIHsKICBpZiAoIW5vZGUuYXJndW1lbnRzIHx8ICFub2RlLmNvbnRleHQgfHwgIW5vZGUuYXJndW1lbnRzLnZhbHVlcyB8fCAhbm9kZS5mdW5jdGlvbk5hbWUpewogICAgcmV0dXJuOwogIH0KICAKICBjb25zdCBmdW5jdGlvbnMgPSBbIlBvcGVuIiwgInJ1biIsICJjYWxsIl07CiAgCiAgaWYgKCFmdW5jdGlvbnMuaW5jbHVkZXMobm9kZS5mdW5jdGlvbk5hbWUudmFsdWUpKSB7CiAgICByZXR1cm47CiAgfQogIAogIGZ1bmN0aW9ucy5mb3JFYWNoKGZ1bmN0aW9uTmFtZSA9PiB7CiAgICBjb25zdCBoYXNTaGVsbFRydWUgPSBub2RlLmFyZ3VtZW50cy52YWx1ZXMuZmlsdGVyKGEgPT4gYS5uYW1lICYmIGEubmFtZS52YWx1ZSA9PSAic2hlbGwiICYmIGEudmFsdWUgJiYgYS52YWx1ZS52YWx1ZSA9PSAiVHJ1ZSIpLmxlbmd0aCA+IDA7CiAgICBjb25zdCBhbGxQYWNrYWdlcyA9IG5vZGUuY29udGV4dC5pbXBvcnRzLmZpbHRlcihpID0+IGkucGFja2FnZXMpLmZsYXRNYXAoaSA9PiBpLnBhY2thZ2VzLm1hcChwID0+IHAubmFtZS5zdHIpKTsKICAgIGNvbnN0IHVzZVN1YnByb2Nlc3NQYWNrYWdlID0gYWxsUGFja2FnZXMuZmlsdGVyKGkgPT4gaSA9PT0gInN1YnByb2Nlc3MiKS5sZW5ndGggPiAwOwogICAgY29uc3QgaW1wb3J0RnJvbSA9IG5vZGUuY29udGV4dC5pbXBvcnRzCiAgICAgICAgLmZpbHRlcihyID0+IHIucGtnICYmIHIucGtnLnZhbHVlID09PSAic3VicHJvY2VzcyIgJiYgci5lbGVtZW50cyAmJiByLmVsZW1lbnRzLmZpbHRlcihlID0+IGUubmFtZSkubWFwKGUgPT4gZS5uYW1lLnZhbHVlKS5pbmNsdWRlcyhmdW5jdGlvbk5hbWUpKTsKICAgIGNvbnN0IHVzZUltcG9ydEZyb20gPSBpbXBvcnRGcm9tLmxlbmd0aCA+IDA7CiAgICBpZigoaGFzU2hlbGxUcnVlICYmIHVzZVN1YnByb2Nlc3NQYWNrYWdlICYmIG5vZGUuZnVuY3Rpb25OYW1lLnZhbHVlID09PSBmdW5jdGlvbk5hbWUgJiYgbm9kZS5tb2R1bGVPck9iamVjdC52YWx1ZSA9PT0gInN1YnByb2Nlc3MiKXx8CiAgICAgICAodXNlSW1wb3J0RnJvbSAmJiBub2RlLmZ1bmN0aW9uTmFtZS52YWx1ZSA9PT0gZnVuY3Rpb25OYW1lKSl7CiAgICAgIAogICAgICAKICAgICAgZm9yICh2YXIgaSA9IDAgOyBpIDwgbm9kZS5hcmd1bWVudHMudmFsdWVzLmxlbmd0aCA7IGkrKykgewogICAgICAgIGNvbnN0IGFyZyA9IG5vZGUuYXJndW1lbnRzLnZhbHVlc1tpXTsKICAgICAgICBjb25zdCBuYkFyZ3VtZW50cyA9IG5vZGUuYXJndW1lbnRzLnZhbHVlcy5sZW5ndGg7CiAgICAgICAgaWYoYXJnLm5hbWUgJiYgYXJnLm5hbWUudmFsdWUgPT0gInNoZWxsIiAmJiBhcmcudmFsdWUgJiYgYXJnLnZhbHVlLnZhbHVlID09ICJUcnVlIikgewogICAgICAgICAgdmFyIGVycm9yID0gYnVpbGRFcnJvcihub2RlLnN0YXJ0LmxpbmUsIG5vZGUuc3RhcnQuY29sLCBub2RlLmVuZC5saW5lLCBub2RlLmVuZC5jb2wsICJzaGVsbCBkZWZpbmVkIHdpdGggdHJ1ZSIsICJDUklUSUNBTCIsICJTRUNVUklUWSIpOwoKCgkJCQkJaWYoaSA+IDApIHsKICAgICAgICAgICBjb25zdCBwcmV2aW91c0FyZ3VtZW50ID0gbm9kZS5hcmd1bWVudHMudmFsdWVzW2ktMV07CiAgICAgICAgICAgY29uc3QgZWRpdCA9IGJ1aWxkRWRpdFJlbW92ZShwcmV2aW91c0FyZ3VtZW50LmVuZC5saW5lLCBwcmV2aW91c0FyZ3VtZW50LmVuZC5jb2wsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcmcuZW5kLmxpbmUsIGFyZy5lbmQuY29sKQogICAgCQkJIGNvbnN0IGZpeCA9IGJ1aWxkRml4KCJyZW1vdmUgc2hlbGwgYXJndW1lbnQiLCBbZWRpdF0pOwogICAgICAgICAgIGVycm9yID0gZXJyb3IuYWRkRml4KGZpeCk7CiAgICAgICAgICB9CgogICAgICAgICAgCgkJCQkJIGFkZEVycm9yKGVycm9yKTsKICAgICAgICB9CiAgICAgIH0gICAgICAKICAgIH0KICB9KTsKfQ==",
      "regex": null
    },
    {
      "name": "python-security/requests-timeout",
      "language": "PYTHON",
      "type": "AST_CHECK",
      "entity_checked": "FUNCTION_CALL",
      "code": "ZnVuY3Rpb24gdmlzaXQobm9kZSkgewogIGlmKCFub2RlLmFyZ3VtZW50cyB8fCAhbm9kZS5hcmd1bWVudHMudmFsdWVzIHx8ICFub2RlLmNvbnRleHQpIHsKICAgIHJldHVybjsKICB9CiAgCiAgY29uc3QgZnVuY3Rpb25zID0gWyJwb3N0IiwgImdldCIsICJwdXQiLCAicGF0Y2giXTsKICAKICBpZiAoISBub2RlLmZ1bmN0aW9uTmFtZSB8fCAhZnVuY3Rpb25zLmluY2x1ZGVzKG5vZGUuZnVuY3Rpb25OYW1lLnZhbHVlKSkgewogICAgcmV0dXJuOwogIH0KICAKICBjb25zdCBhcmd1bWVudHMgPSBub2RlLmFyZ3VtZW50cy52YWx1ZXM7CiAgY29uc3QgbmJBcmd1bWVudHMgPSBub2RlLmFyZ3VtZW50cy52YWx1ZXMubGVuZ3RoOwogIGNvbnN0IGFsbFBhY2thZ2VzID0gbm9kZS5jb250ZXh0LmltcG9ydHMuZmlsdGVyKHIgPT4gci5wYWNrYWdlcykuZmxhdE1hcChpID0+IGkucGFja2FnZXMubWFwKHAgPT4gcC5uYW1lLnN0cikpOwogIGNvbnN0IHVzZVJlcXVlc3RzUGFja2FnZSA9IGFsbFBhY2thZ2VzLmZpbHRlcihpID0+IGkgPT09ICJyZXF1ZXN0cyIpLmxlbmd0aCA+IDA7CgoKICBjb25zdCBoYXNUaW1lb3V0ID0gbm9kZS5hcmd1bWVudHMudmFsdWVzLmZpbHRlcihhID0+IGEubmFtZSAmJiBhLm5hbWUudmFsdWUgPT0gInRpbWVvdXQiKS5sZW5ndGggPiAwOwogIAogIGZ1bmN0aW9ucy5mb3JFYWNoKGZ1bmN0aW9uTmFtZSA9PiB7CiAgICBjb25zdCBpbXBvcnRGcm9tID0gbm9kZS5jb250ZXh0LmltcG9ydHMKICAgIAkuZmlsdGVyKHIgPT4gci5wa2cgJiYgci5wa2cudmFsdWUgPT09ICJyZXF1ZXN0cyIgJiYgci5lbGVtZW50cyAmJiByLmVsZW1lbnRzLmZpbHRlcihlID0+IGUubmFtZSkubWFwKGUgPT4gZS5uYW1lLnZhbHVlKS5pbmNsdWRlcyhmdW5jdGlvbk5hbWUpKTsKCQljb25zdCB1c2VJbXBvcnRGcm9tID0gaW1wb3J0RnJvbS5sZW5ndGggPiAwOwoKICAgIGlmKCh1c2VSZXF1ZXN0c1BhY2thZ2UgJiYgIWhhc1RpbWVvdXQgJiYgbm9kZS5tb2R1bGVPck9iamVjdCAmJiBub2RlLmZ1bmN0aW9uTmFtZSAmJiBub2RlLmZ1bmN0aW9uTmFtZS52YWx1ZSA9PT0gZnVuY3Rpb25OYW1lICYmIG5vZGUubW9kdWxlT3JPYmplY3QudmFsdWUgPT09ICJyZXF1ZXN0cyIpCiAgICAgIHx8ICh1c2VJbXBvcnRGcm9tICYmIG5vZGUuZnVuY3Rpb25OYW1lLnZhbHVlID09PSBmdW5jdGlvbk5hbWUgJiYgIWhhc1RpbWVvdXQpKXsKICAgIGNvbnN0IGVycm9yID0gYnVpbGRFcnJvcihub2RlLnN0YXJ0LmxpbmUsIG5vZGUuc3RhcnQuY29sLCBub2RlLmVuZC5saW5lLCBub2RlLmVuZC5jb2wsICJ0aW1lb3V0IG5vdCBkZWZpbmVkIiwgIkNSSVRJQ0FMIiwgIlNBRkVUWSIpOwogICAgY29uc3QgbGluZVRvSW5zZXJ0ID0gYXJndW1lbnRzW2FyZ3VtZW50cy5sZW5ndGggLSAxXS5lbmQubGluZTsKICAgIGNvbnN0IGNvbFRvSW5zZXJ0ID0gYXJndW1lbnRzW2FyZ3VtZW50cy5sZW5ndGggLSAxXS5lbmQuY29sOwogICAgY29uc3QgZWRpdCA9IGJ1aWxkRWRpdEFkZChsaW5lVG9JbnNlcnQsIGNvbFRvSW5zZXJ0LCAiLCB0aW1lb3V0PTUiKQogICAgY29uc3QgZml4ID0gYnVpbGRGaXgoImFkZCB0aW1lb3V0IGFyZ3VtZW50IiwgW2VkaXRdKTsKICAgIGFkZEVycm9yKGVycm9yLmFkZEZpeChmaXgpKTsKICB9CiAgfSk7CiAgCn0=",
      "regex": null
    },
    {
      "name": "python-security/aws-boto3-credentials",
      "language": "PYTHON",
      "type": "AST_CHECK",
      "entity_checked": "FUNCTION_CALL",
      "code": "ZnVuY3Rpb24gdmlzaXQobm9kZSkgewogIGlmICghbm9kZS5hcmd1bWVudHMgfHwgIW5vZGUuYXJndW1lbnRzLnZhbHVlcyB8fCAhbm9kZS5jb250ZXh0KSB7CiAgICByZXR1cm47CiAgfQogIGNvbnN0IGZ1bmN0aW9ucyA9IFsiU2Vzc2lvbiIsICJjbGllbnQiXTsKCiAgaWYgKCFub2RlLmZ1bmN0aW9uTmFtZSB8fCAhZnVuY3Rpb25zLmluY2x1ZGVzKG5vZGUuZnVuY3Rpb25OYW1lLnZhbHVlKSl7CiAgICByZXR1cm47CiAgfQogIAogIGNvbnN0IGFyZ3VtZW50cyA9IG5vZGUuYXJndW1lbnRzLnZhbHVlczsKICBjb25zdCBuYkFyZ3VtZW50cyA9IG5vZGUuYXJndW1lbnRzLnZhbHVlcy5sZW5ndGg7CiAgY29uc3QgYWxsUGFja2FnZXMgPSBub2RlLmNvbnRleHQuaW1wb3J0cy5maWx0ZXIoaSA9PiBpLnBhY2thZ2VzKS5mbGF0TWFwKGkgPT4gaS5wYWNrYWdlcy5tYXAocCA9PiBwLm5hbWUuc3RyKSk7CiAgY29uc3QgdXNlQm90b1BhY2thZ2UgPSBhbGxQYWNrYWdlcy5maWx0ZXIoaSA9PiBpID09PSAiYm90bzMiKS5sZW5ndGggPiAwOwogIAogIGlmICghdXNlQm90b1BhY2thZ2UpewogICAgcmV0dXJuOwogIH0KICAKICBjb25zdCBBQ0NFU1NfS0VZX1BSRUZJWCA9IFsKICAgICJBQklBIiwgIkFDQ0EiLCAiQUdQQSIsICJBSURBIiwgIkFJUEEiLCAiQUtJQSIsICJBTlBBIiwgIkFOVkEiLAogICAgIkFQS0EiLCAiQVJPQSIsICJBU0NBIiwgIkFTSUEiXTsKICBjb25zdCBhY2Nlc3NLZXlBcmd1bWVudHMgPSBub2RlLmFyZ3VtZW50cy52YWx1ZXMuZmlsdGVyKGEgPT4gYS5uYW1lICYmIGEubmFtZS52YWx1ZSA9PSAiYXdzX2FjY2Vzc19rZXlfaWQiKTsKICBjb25zdCBzZWNyZXRLZXlBcmd1bWVudHMgPSBub2RlLmFyZ3VtZW50cy52YWx1ZXMuZmlsdGVyKGEgPT4gYS5uYW1lICYmIGEubmFtZS52YWx1ZSA9PSAiYXdzX3NlY3JldF9hY2Nlc3Nfa2V5Iik7CiAgCiAgZnVuY3Rpb25zLmZvckVhY2goZnVuY3Rpb25OYW1lID0+IHsKICAgIGNvbnN0IGhhc0FjY2Vzc0tleUFyZ3VtZW50ID0gYWNjZXNzS2V5QXJndW1lbnRzLmxlbmd0aCA+IDA7CiAgICBjb25zdCBoYXNTZWNyZXRLZXlBcmd1bWVudCA9IHNlY3JldEtleUFyZ3VtZW50cy5sZW5ndGggPiAwOwogICAgCiAgICBpZigoaGFzQWNjZXNzS2V5QXJndW1lbnQgfHxoYXNTZWNyZXRLZXlBcmd1bWVudCkgICYmIG5vZGUuZnVuY3Rpb25OYW1lLnZhbHVlID09PSBmdW5jdGlvbk5hbWUgJiYgbm9kZS5tb2R1bGVPck9iamVjdC52YWx1ZSA9PT0gImJvdG8zIil7CiAgICAgIGNvbnN0IGFjY2Vzc0tleSA9IGFjY2Vzc0tleUFyZ3VtZW50c1swXS52YWx1ZS52YWx1ZTsKICAgICAgY29uc3Qgc2VjcmV0S2V5ID0gc2VjcmV0S2V5QXJndW1lbnRzWzBdLnZhbHVlLnZhbHVlOwogICAgICAKICAgICAgLy8gcmVtb3ZlIHBvdGVudGlhbCBxdW90ZQogICAgICBjb25zdCBhY2Nlc3NLZXlQcmVmaXggPSBhY2Nlc3NLZXkucmVwbGFjZSgvWyciXSsvZywgJycpLnN1YnN0cmluZygwLCA0KTsKICAgICAgY29uc29sZS5sb2coYWNjZXNzS2V5UHJlZml4KTsKICAgICAgCiAgICAgIGlmIChBQ0NFU1NfS0VZX1BSRUZJWC5pbmNsdWRlcyhhY2Nlc3NLZXlQcmVmaXgpKSB7CiAgICAgICAgY29uc3QgZXJyb3IgPSBidWlsZEVycm9yKG5vZGUuc3RhcnQubGluZSwgbm9kZS5zdGFydC5jb2wsIG5vZGUuZW5kLmxpbmUsIG5vZGUuZW5kLmNvbCwgIkNsZWFyIGNyZWRlbnRpYWxzIHBhc3NlZCwgdXNlIGVudmlyb25tZW50IHZhcmlhYmxlcyIsICJDUklUSUNBTCIsICJTRUNVUklUWSIpOwogICAgICAgIGNvbnN0IGxpbmVUb0luc2VydCA9IGFyZ3VtZW50c1thcmd1bWVudHMubGVuZ3RoIC0gMV0uZW5kLmxpbmU7CiAgICAgICAgY29uc3QgY29sVG9JbnNlcnQgPSBhcmd1bWVudHNbYXJndW1lbnRzLmxlbmd0aCAtIDFdLmVuZC5jb2w7CiAgICAgICAgYWRkRXJyb3IoZXJyb3IpOwogICAgICB9CiAgICAgCiAgCX0KICB9KTsKICAKfQ==",
      "regex": null
    },
    {
      "name": "python-security/insecure-hash-functions",
      "language": "PYTHON",
      "type": "AST_CHECK",
      "entity_checked": "FUNCTION_CALL",
      "code": "ZnVuY3Rpb24gY2hlY2tBbGdvcml0aG0obm9kZSwgaGFzaE1ldGhvZCkgewogIGlmICghKG5vZGUuZnVuY3Rpb25OYW1lLnZhbHVlID09PSAibmV3IiAmJiBub2RlLm1vZHVsZU9yT2JqZWN0LnZhbHVlID09PSAiaGFzaGxpYiIpKSB7CiAgICByZXR1cm47CiAgfQogIGlmICghbm9kZS5hcmd1bWVudHMgfHwgIW5vZGUuYXJndW1lbnRzLnZhbHVlcyB8fCAhbm9kZS5jb250ZXh0KXsKICAgIHJldHVybjsKICB9CgogIGNvbnN0IHVzZU91dGRhdGVkSGFzaE1ldGhvZCA9IG5vZGUuYXJndW1lbnRzLnZhbHVlcwogIAkuZmlsdGVyKGEgPT4gYS52YWx1ZSAmJiBhLnZhbHVlLnN0ci50b0xvd2VyQ2FzZSgpID09IGAnJHtoYXNoTWV0aG9kfSdgKS5sZW5ndGggPiAwOwoKICBjb25zdCBhbGxQYWNrYWdlcyA9IG5vZGUuY29udGV4dC5pbXBvcnRzCiAgCS5maWx0ZXIoaSA9PiBpLnBhY2thZ2VzKQogIAkuZmxhdE1hcChpID0+IGkucGFja2FnZXMubWFwKHAgPT4gcC5uYW1lLnN0cikpOwogIGNvbnN0IHVzZUhhc2hsaWIgPSBhbGxQYWNrYWdlcy5maWx0ZXIoaSA9PiBpID09PSAiaGFzaGxpYiIpLmxlbmd0aCA+IDA7CgogIGlmKHVzZU91dGRhdGVkSGFzaE1ldGhvZCAmJiB1c2VIYXNobGliKXsKICAgIGNvbnN0IGVycm9yID0gYnVpbGRFcnJvcihub2RlLnN0YXJ0LmxpbmUsIG5vZGUuc3RhcnQuY29sLCBub2RlLmVuZC5saW5lLCBub2RlLmVuZC5jb2wsIGBVc2Ugb2YgaW5zZWN1cmUgaGFzaGluZyBtZXRob2QgJHtoYXNoTWV0aG9kfWAsICJDUklUSUNBTCIsICJTRUNVUklUWSIpOwogICAgYWRkRXJyb3IoZXJyb3IpOwogIH0gCn0KCmNvbnN0IGNoZWNrSGFzaGxpYiA9IChub2RlKSA9PiB7CiAgY29uc3QgbWV0aG9kcyA9IFsibWQ0IiwgIm1kNSIsICJzaGExIl07CiAgbWV0aG9kcy5mb3JFYWNoKG1ldGhvZCA9PiB7CiAgICBjaGVja0FsZ29yaXRobShub2RlLCBtZXRob2QpOwogIH0pOwp9Cgpjb25zdCBjaGVja0NyeXB0b2dyYXBoeSA9IChub2RlKSA9PiB7CiAgaWYobm9kZS5tb2R1bGVPck9iamVjdCAmJiBub2RlLm1vZHVsZU9yT2JqZWN0LnZhbHVlID09PSAiaGFzaGVzIiAmJiBub2RlLmZ1bmN0aW9uTmFtZSAmJiBub2RlLmZ1bmN0aW9uTmFtZS52YWx1ZSA9PT0gIk1ENSIpIHsKCQljb25zdCB1c2VIYXNoZXMgPSBub2RlLmNvbnRleHQuaW1wb3J0cy5maWx0ZXIoaSA9PiBpLnBrZyAmJiBpLnBrZy52YWx1ZSA9PT0gImNyeXB0b2dyYXBoeS5oYXptYXQucHJpbWl0aXZlcyIgJiYgaS5lbGVtZW50cyAmJiBpLmVsZW1lbnRzLm1hcChlID0+IGUubmFtZS52YWx1ZSkuaW5jbHVkZXMoImhhc2hlcyIpKS5sZW5ndGggPiAwOwogICAgaWYgKHVzZUhhc2hlcykgewogICAgICBjb25zdCBlcnJvciA9IGJ1aWxkRXJyb3Iobm9kZS5mdW5jdGlvbk5hbWUuc3RhcnQubGluZSwgbm9kZS5mdW5jdGlvbk5hbWUuc3RhcnQuY29sLCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vZGUuZnVuY3Rpb25OYW1lLmVuZC5saW5lLCBub2RlLmZ1bmN0aW9uTmFtZS5lbmQuY29sLCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJNRDUgaXMgbm90IHNlY3VyZSIsICJFUlJPUiIsICJTRUNVUklUWSIpOwogICAgICBjb25zdCBlZGl0ID0gYnVpbGRFZGl0VXBkYXRlKG5vZGUuZnVuY3Rpb25OYW1lLnN0YXJ0LmxpbmUsIG5vZGUuZnVuY3Rpb25OYW1lLnN0YXJ0LmNvbCwgbm9kZS5mdW5jdGlvbk5hbWUuZW5kLmxpbmUsIG5vZGUuZnVuY3Rpb25OYW1lLmVuZC5jb2wsICJTSEEzXzI1NiIpCiAgICAgIGNvbnN0IGZpeCA9IGJ1aWxkRml4KCJ1c2UgU0hBM18yNTYgaW5zdGVhZCIsIFtlZGl0XSk7CiAgICAgIGFkZEVycm9yKGVycm9yLmFkZEZpeChmaXgpKTsKICAgIH0KICB9Cn07CgoKZnVuY3Rpb24gdmlzaXQobm9kZSwgZmlsZW5hbWUpIHsKICBjaGVja0hhc2hsaWIobm9kZSk7CiAgY2hlY2tDcnlwdG9ncmFwaHkobm9kZSk7Cn0=",
      "regex": null
    },
    {
      "name": "python-security/sql-server-security-credentials",
      "language": "PYTHON",
      "type": "AST_CHECK",
      "entity_checked": "FUNCTION_CALL",
      "code": "Y29uc3QgZGV0ZWN0Q2xlYXJDcmVkZW50aWFscyA9IChub2RlLCBweXRob25Nb2R1bGVOYW1lLCBmdW5jdGlvbk5hbWUsIHBhcmFtZXRlck5hbWUpID0+IHsKICAKICBpZighbm9kZS5tb2R1bGVPck9iamVjdCB8fCBub2RlLm1vZHVsZU9yT2JqZWN0LnZhbHVlICE9PSBweXRob25Nb2R1bGVOYW1lKXsKICAgIHJldHVybjsKICB9CiAgCgogIGlmKCFub2RlLmZ1bmN0aW9uTmFtZSB8fCBub2RlLmZ1bmN0aW9uTmFtZS52YWx1ZSAhPT0gZnVuY3Rpb25OYW1lKXsKICAgIHJldHVybjsKICB9CiAgCiAgLy8gR2V0IHRoZSBsaXN0IG9mIGFyZ3VtZW50CiAgY29uc3QgYXJndW1lbnRzID0gbm9kZS5hcmd1bWVudHMudmFsdWVzOwogIGNvbnN0IG5iQXJndW1lbnRzID0gbm9kZS5hcmd1bWVudHMudmFsdWVzLmxlbmd0aDsKICAvLyBHZXQgYWxsIHRoZSBwYWNrYWdlIGxpc3QgdGhhdCBhcmUgaW1wb3J0ZWQgd2l0aCAiaW1wb3J0IDxuYW1lPiIKICBjb25zdCBhbGxQYWNrYWdlcyA9IG5vZGUuY29udGV4dC5pbXBvcnRzLmZpbHRlcihyID0+IHIucGFja2FnZXMpLmZsYXRNYXAoaSA9PiBpLnBhY2thZ2VzLm1hcChwID0+IHAubmFtZS5zdHIpKTsKICAvLyBEbyB3ZSB1c2UgdGhlIHBhY2thZ2Ugd2UgYXJlIGxvb2tpbmcgZm9yPwogIGNvbnN0IHVzZVBhY2thZ2UgPSBhbGxQYWNrYWdlcy5maWx0ZXIoaSA9PiBpID09PSBweXRob25Nb2R1bGVOYW1lKS5sZW5ndGggPiAwOwogIGlmICghdXNlUGFja2FnZSl7CiAgICByZXR1cm47CiAgfQogIAogIC8vIElzIHRoZSBmaXJzdCBhcmd1bWVudCB2YWx1ZSBmb28/CiAgY29uc3QgYXJndW1lbnRQYXNzd29yZHMgPSBub2RlLmFyZ3VtZW50cy52YWx1ZXMuZmlsdGVyKGEgPT4gYS5uYW1lICYmIGEubmFtZS52YWx1ZSA9PT0gcGFyYW1ldGVyTmFtZSk7CiAgCiAgaWYoYXJndW1lbnRQYXNzd29yZHMgJiYgYXJndW1lbnRQYXNzd29yZHMubGVuZ3RoID4gMCl7CiAgICBjb25zdCBhcmd1bWVudFBhc3N3b3JkID0gYXJndW1lbnRQYXNzd29yZHNbMF07CiAgICBpZiAoIWFyZ3VtZW50UGFzc3dvcmQudmFsdWUgfHwgIWFyZ3VtZW50UGFzc3dvcmQudmFsdWUudmFsdWUpIHsKICAgICAgcmV0dXJuOwogICAgfQogICAgY29uc3QgYXJndW1lbnRWYWx1ZSA9IGFyZ3VtZW50UGFzc3dvcmQudmFsdWUudmFsdWU7CiAgICAKICAgIGlmKGFyZ3VtZW50VmFsdWUuc3RhcnRzV2l0aCgiXCIiKSB8fCBhcmd1bWVudFZhbHVlLnN0YXJ0c1dpdGgoImZcIiIpKSB7CiAgICAgICAKICAgICAgLy8gYnVpbGQgdGhlIGVycm9yCiAgICAgIGNvbnN0IGVycm9yID0gYnVpbGRFcnJvcihhcmd1bWVudFBhc3N3b3JkLnZhbHVlLnN0YXJ0LmxpbmUsIGFyZ3VtZW50UGFzc3dvcmQudmFsdWUuc3RhcnQuY29sLCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3VtZW50UGFzc3dvcmQudmFsdWUuZW5kLmxpbmUsIGFyZ3VtZW50UGFzc3dvcmQudmFsdWUuZW5kLmNvbCwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiaGFyZGNvZGVkIGNyZWRlbnRpYWwiLCAiQ1JJVElDQUwiLCAiU0VDVVJJVFkiKTsKCiAgICAgIC8vIHJlcG9ydCBhbiBlcnJvciB3aXRoIGEgZml4CiAgICAgIGFkZEVycm9yKGVycm9yKTsKICAJfQogIH0KfQoKCmZ1bmN0aW9uIHZpc2l0KG5vZGUsIGZpbGVuYW1lLCBjb2RlKSB7CiAgCiAgLy8gSWYgZmlsZW5hbWUgc3RhcnRzIG9yIGVuZHMgd2l0aCB0ZXN0XyBvciBfdGVzdCwgZG8gbm90IGRvIGFueXRoaW5nCiAgaWYoZmlsZW5hbWUuaW5jbHVkZXMoIl90ZXN0LnB5IikgfHwgZmlsZW5hbWUuc3RhcnRzV2l0aCgidGVzdF8iKSkgewogICAgcmV0dXJuOwogIH0KICAvLyBJZiB0aGUgYW5hbHl6ZXIgZGlkIG5vdCBnZXQgdGhlIGFyZ3VtZW50cyBvciBpZiB0aGVyZSBpcyBubyBhcmd1bWVudCwgZXhpdAogIGlmKCFub2RlLmFyZ3VtZW50cyB8fCAhbm9kZS5jb250ZXh0IHx8ICFub2RlLmFyZ3VtZW50cy52YWx1ZXMgfHwgbm9kZS5hcmd1bWVudHMudmFsdWVzLmxlbmd0aCAgPT09IDApIHsKICAgIHJldHVybjsKICB9CglkZXRlY3RDbGVhckNyZWRlbnRpYWxzKG5vZGUsICJteXNxbC5jb25uZWN0b3IiLCAiY29ubmVjdCIsICJwYXNzd2QiKTsKICBkZXRlY3RDbGVhckNyZWRlbnRpYWxzKG5vZGUsICJwc3ljb3BnMiIsICJjb25uZWN0IiwgInBhc3N3b3JkIik7Cn0KICA=",
      "regex": null
    },
    {
      "name": "python-security/deserialize-untrusted-data",
      "language": "PYTHON",
      "type": "AST_CHECK",
      "entity_checked": "FUNCTION_CALL",
      "code": "Y29uc3QgTU9EVUxFU19GVU5DVElPTlNfVE9fQVZPSUQgPSB7CiAgInBpY2tsZSI6IFsibG9hZHMiLCAibG9hZCIsICJVbnBpY2tsZXIiXSwKICAic2hlbHZlIjogWyJvcGVuIl0sCiAgIm1hcnNoYWwiOiBbImxvYWQiLCAibG9hZHMiXSwKICAianNvbnBpY2tsZWQiOiBbImRlY29kZSJdLAogICJwYW5kYXMiOiBbInJlYWRfcGlja2xlIl0sCgkibWFyc2hhbCI6IFsibG9hZCIsICJsb2FkcyJdCn0KCgpmdW5jdGlvbiB2aXNpdChub2RlLCBmaWxlbmFtZSwgY29kZSkgewogIGlmICghbm9kZSB8fCAhbm9kZS5mdW5jdGlvbk5hbWUgfHwgIW5vZGUubW9kdWxlT3JPYmplY3QgfHwgIW5vZGUuY29udGV4dCkgewogICAgcmV0dXJuOwogIH0KCiAgaWYgKGZpbGVuYW1lLmluY2x1ZGVzKCJfdGVzdC5weSIpIHx8IGZpbGVuYW1lLnN0YXJ0c1dpdGgoInRlc3RfIikpIHsKICAgIHJldHVybjsKICB9CgogIGNvbnN0IG1vZHVsZSA9IG5vZGUubW9kdWxlT3JPYmplY3QudmFsdWU7CiAgY29uc3QgZnVuYyA9IG5vZGUuZnVuY3Rpb25OYW1lLnZhbHVlOwoKICBpZiAoTU9EVUxFU19GVU5DVElPTlNfVE9fQVZPSURbbW9kdWxlXSkgewogICAgY29uc3QgYWxsUGFja2FnZXMgPSBub2RlLmNvbnRleHQuaW1wb3J0cy5maWx0ZXIociA9PiByLnBhY2thZ2VzKS5mbGF0TWFwKGkgPT4gaS5wYWNrYWdlcy5tYXAocCA9PiBwLm5hbWUuc3RyKSk7CiAgICBjb25zdCB1c2VNb2R1bGUgPSBhbGxQYWNrYWdlcy5maWx0ZXIoaSA9PiBpID09PSBtb2R1bGUpLmxlbmd0aCA+IDA7CiAgICBpZiAoIXVzZU1vZHVsZSkgewogICAgICByZXR1cm47CiAgICB9CgogICAgY29uc3QgZnVuY3Rpb25zID0gTU9EVUxFU19GVU5DVElPTlNfVE9fQVZPSURbbW9kdWxlXTsKCiAgICBpZiAoZnVuY3Rpb25zLmluY2x1ZGVzKGZ1bmMpKSB7CiAgICAgIGNvbnN0IGVycm9yID0gYnVpbGRFcnJvcihub2RlLnN0YXJ0LmxpbmUsIG5vZGUuc3RhcnQuY29sLCBub2RlLmVuZC5saW5lLCBub2RlLmVuZC5jb2wsIGAke21vZHVsZX0uJHtmdW5jfSBpcyBub3Qgc2FmZSBmb3IgZGVzZXJpYWxpemluZyB1bnN0cnVzdGVkIGRhdGFgLCAiQ1JJVElDQUwiLCAiU0VDVVJJVFkiKTsKICAgICAgYWRkRXJyb3IoZXJyb3IpOwogICAgfQogIH0KfQ==",
      "regex": null
    },
    {
      "name": "python-security/sql-injection",
      "language": "PYTHON",
      "type": "AST_CHECK",
      "entity_checked": "FUNCTION_CALL",
      "code": "ZnVuY3Rpb24gdmlzaXQobm9kZSkgewogIC8vIG5vIGFyZ3VtZW50cwogIGlmICghbm9kZS5hcmd1bWVudHMgfHwgIW5vZGUuY29udGV4dCB8fCAhbm9kZS5hcmd1bWVudHMudmFsdWVzIHx8IG5vZGUuYXJndW1lbnRzLnZhbHVlcy5sZW5ndGggPT0gMCkgewogICAgcmV0dXJuOwogIH0KCiAgY29uc3QgYXJndW1lbnRzID0gbm9kZS5hcmd1bWVudHMudmFsdWVzOwogIGNvbnN0IG5iQXJndW1lbnRzID0gbm9kZS5hcmd1bWVudHMudmFsdWVzLmxlbmd0aDsKCiAgLy8gbm8gZnVuY3Rpb24gb3IgbW9kdWxlIG5hbWUKICBpZiAoIW5vZGUuZnVuY3Rpb25OYW1lKSB7CiAgICByZXR1cm47CiAgfQoKCiAgLy8gY29tbW9uIG5hbWVzIGdpdmVuIGZvciBjdXJzb3IgdG8gZXhlY3V0ZSBTUUwKICBjb25zdCBvYmplY3RzID0gWyJjdXJzb3IiLCAiY3VyIl07CiAgY29uc3QgYXJndW1lbnRWYWx1ZVN0cmluZyA9IG5vZGUuYXJndW1lbnRzLnZhbHVlc1swXS52YWx1ZS52YWx1ZTsKCWNvbnN0IGFyZ3VtZW50VmFsdWUgPSBub2RlLmFyZ3VtZW50cy52YWx1ZXNbMF0udmFsdWU7CgogIGNvbnN0IHVzZUZzdHJpbmcgPSBhcmd1bWVudFZhbHVlU3RyaW5nICYmIGFyZ3VtZW50VmFsdWVTdHJpbmcuc3RhcnRzV2l0aCgiZiIpOwogIGNvbnN0IHVzZUZvcm1hdFN0cmluZyA9IGFyZ3VtZW50VmFsdWVTdHJpbmcgJiYgYXJndW1lbnRWYWx1ZVN0cmluZy5pbmNsdWRlcygiLmZvcm1hdCgiKTsKCWNvbnN0IHVzZUZvcm1hdEZ1bmN0aW9uID0gYXJndW1lbnRWYWx1ZSAmJiBhcmd1bWVudFZhbHVlLmFzdFR5cGUgPT09ICJmdW5jdGlvbmNhbGwiICYmIGFyZ3VtZW50VmFsdWUuZnVuY3Rpb25OYW1lLnZhbHVlID09PSAiZm9ybWF0IjsKICBjb25zdCBoYXNFcnJvciA9IHVzZUZzdHJpbmcgfHwgdXNlRm9ybWF0U3RyaW5nIHx8IHVzZUZvcm1hdEZ1bmN0aW9uOwoKCiAgdmFyIGVycm9yTWVzc2FnZSA9ICJEbyBub3QgdXNlIGYtc3RyaW5nIGluIFNRTCBxdWVyaWVzLCBpdCBsZWFkcyB0byBTUUwgaW5qZWN0aW9ucyI7CgogIGlmICh1c2VGb3JtYXRTdHJpbmcpIHsKICAgIGVycm9yTWVzc2FnZSA9ICJEbyBub3QgdXNlIGZvcm1hdCBzdHJpbmcgaW4gU1FMIHF1ZXJpZXMsIGl0IGxlYWRzIHRvIFNRTCBpbmplY3Rpb25zIjsKICB9CgogIGlmIChub2RlLm1vZHVsZU9yT2JqZWN0ICYmIG9iamVjdHMuaW5jbHVkZXMobm9kZS5tb2R1bGVPck9iamVjdC52YWx1ZSkpIHsKICAgIC8vIGNoZWNrIHRoYXQgd2UgZG8gbm90IGhhdmUgY3Vyc29yLmV4ZWN1dGUoKSBvciBjdXIuZXhlY3V0ZSgpIHdpdGggYSBwb3RlbnRpYWwgYnVnZ3kgU1FMIHF1ZXJ5CiAgICBvYmplY3RzLmZvckVhY2gobyA9PiB7CiAgICAgIGlmIChoYXNFcnJvciAmJiBub2RlLmZ1bmN0aW9uTmFtZS52YWx1ZSA9PT0gImV4ZWN1dGUiICYmIG5vZGUubW9kdWxlT3JPYmplY3QgJiYgbm9kZS5tb2R1bGVPck9iamVjdC52YWx1ZSA9PT0gbykgewoKICAgICAgICBjb25zdCBlcnJvciA9IGJ1aWxkRXJyb3Iobm9kZS5zdGFydC5saW5lLCBub2RlLnN0YXJ0LmNvbCwgbm9kZS5lbmQubGluZSwgbm9kZS5lbmQuY29sLCBlcnJvck1lc3NhZ2UsICJDUklUSUNBTCIsICJTQUZFVFkiKTsKICAgICAgICBhZGRFcnJvcihlcnJvcik7CiAgICAgIH0KICAgIH0pOwogIH0KCgogIGlmIChub2RlLmZ1bmN0aW9uTmFtZSAmJiBub2RlLmZ1bmN0aW9uTmFtZS52YWx1ZSA9PT0gInRleHQiKSB7CiAgICAvLyBjaGVjayBmb3IgU1FMIEFsY2hlbXkKICAgIGNvbnN0IGltcG9ydFRleHRGcm9tU3FsQWxjaGVteSA9IG5vZGUuY29udGV4dC5pbXBvcnRzCiAgICAgIC5maWx0ZXIociA9PiByLnBrZyAmJiByLnBrZy52YWx1ZSA9PT0gInNxbGFsY2hlbXkiICYmIHIuZWxlbWVudHMgJiYKICAgICAgICByLmVsZW1lbnRzLmZpbHRlcihlID0+IGUubmFtZSkubWFwKGUgPT4gZS5uYW1lLnZhbHVlKS5pbmNsdWRlcygidGV4dCIpKS5sZW5ndGggPiAwOwoKICAgIGlmIChoYXNFcnJvciAmJiBpbXBvcnRUZXh0RnJvbVNxbEFsY2hlbXkgJiYgbm9kZS5mdW5jdGlvbk5hbWUudmFsdWUgPT09ICJ0ZXh0IikgewogICAgICBjb25zdCBlcnJvciA9IGJ1aWxkRXJyb3Iobm9kZS5zdGFydC5saW5lLCBub2RlLnN0YXJ0LmNvbCwgbm9kZS5lbmQubGluZSwgbm9kZS5lbmQuY29sLCBlcnJvck1lc3NhZ2UsICJDUklUSUNBTCIsICJTQUZFVFkiKTsKICAgICAgYWRkRXJyb3IoZXJyb3IpOwogICAgfQogIH0KfQ==",
      "regex": null
    },
    {
      "name": "python-security/insecure-ssl-protocols",
      "language": "PYTHON",
      "type": "AST_CHECK",
      "entity_checked": "FUNCTION_CALL",
      "code": "ZnVuY3Rpb24gY2hlY2tQcm90b2NvbChub2RlLCBwcm90b2NvbCkgewogIGlmICghbm9kZS5hcmd1bWVudHMgfHwgIW5vZGUuY29udGV4dCl7CiAgICByZXR1cm47CiAgfQogIGlmICghKG5vZGUuZnVuY3Rpb25OYW1lLnZhbHVlID09PSAid3JhcF9zb2NrZXQiICYmIG5vZGUubW9kdWxlT3JPYmplY3QudmFsdWUgPT09ICJzc2wiKSkgewogICAgcmV0dXJuOwogIH0KCiAgY29uc3QgdXNlT3V0ZGF0ZWRQcm90b2NvbCA9IG5vZGUuYXJndW1lbnRzLnZhbHVlcy5maWx0ZXIoYSA9PiBhLnZhbHVlICYmIGEudmFsdWUuc3RyID09IGBzc2wuJHtwcm90b2NvbH1gKS5sZW5ndGggPiAwOwoKICBjb25zdCBhbGxQYWNrYWdlcyA9IG5vZGUuY29udGV4dC5pbXBvcnRzLmZpbHRlcihpID0+IGkucGFja2FnZXMpLmZsYXRNYXAoaSA9PiBpLnBhY2thZ2VzLm1hcChwID0+IHAubmFtZS5zdHIpKTsKICBjb25zdCB1c2VTc2xQYWNrYWdlID0gYWxsUGFja2FnZXMuZmlsdGVyKGkgPT4gaSA9PT0gInNzbCIpLmxlbmd0aCA+IDA7CgogIGlmKHVzZU91dGRhdGVkUHJvdG9jb2wgJiYgdXNlU3NsUGFja2FnZSl7CiAgICBjb25zdCBlcnJvciA9IGJ1aWxkRXJyb3Iobm9kZS5zdGFydC5saW5lLCBub2RlLnN0YXJ0LmNvbCwgbm9kZS5lbmQubGluZSwgbm9kZS5lbmQuY29sLCBgVXNlIG9mIGluc2VjdXJlIHByb3RvY29sICR7cHJvdG9jb2x9YCwgIkNSSVRJQ0FMIiwgIlNFQ1VSSVRZIik7CiAgICBhZGRFcnJvcihlcnJvcik7CiAgfSAKfQoKZnVuY3Rpb24gdmlzaXQobm9kZSkgewogIGlmICghbm9kZS5hcmd1bWVudHMpewogICAgcmV0dXJuOwogIH0KICBpZiAoIShub2RlLmZ1bmN0aW9uTmFtZS52YWx1ZSA9PT0gIndyYXBfc29ja2V0IiAmJiBub2RlLm1vZHVsZU9yT2JqZWN0LnZhbHVlID09PSAic3NsIikpIHsKICAgIHJldHVybjsKICB9CiAgY29uc3QgcHJvdG9jb2xzID0gWyJQUk9UT0NPTF9TU0x2MyIsICJQUk9UT0NPTF9TU0x2MiIsICJTU0x2Ml9NRVRIT0QiLCAiU1NMdjIzX01FVEhPRCIsICJQUk9UT0NPTF9UTFN2MSIsICJTU0x2M19NRVRIT0QiLCAiVExTdjFfTUVUSE9EIl07CiAgcHJvdG9jb2xzLmZvckVhY2gocHJvdG9jb2wgPT4gewogICAgY2hlY2tQcm90b2NvbChub2RlLCBwcm90b2NvbCk7CiAgfSk7Cgp9",
      "regex": null
    },
    {
      "name": "python-security/mktemp",
      "language": "PYTHON",
      "type": "AST_CHECK",
      "entity_checked": "FUNCTION_CALL",
      "code": "ZnVuY3Rpb24gdmlzaXQobm9kZSkgewogIGlmKCFub2RlLmFyZ3VtZW50cyB8fCAhbm9kZS5hcmd1bWVudHMudmFsdWVzIHx8ICFub2RlLmNvbnRleHQpIHsKICAgIHJldHVybjsKICB9CiAgCiAgaWYgKCFub2RlLmZ1bmN0aW9uTmFtZSB8fCBub2RlLmZ1bmN0aW9uTmFtZS52YWx1ZSAhPT0gIm1rdGVtcCIpIHsKICAgIHJldHVybjsKICB9CiAgCiAgY29uc3QgYXJndW1lbnRzID0gbm9kZS5hcmd1bWVudHMudmFsdWVzOwogIGNvbnN0IG5iQXJndW1lbnRzID0gbm9kZS5hcmd1bWVudHMudmFsdWVzLmxlbmd0aDsKICBjb25zdCBhbGxQYWNrYWdlcyA9IG5vZGUuY29udGV4dC5pbXBvcnRzLmZpbHRlcihyID0+IHIucGFja2FnZXMpLmZsYXRNYXAoaSA9PiBpLnBhY2thZ2VzLm1hcChwID0+IHAubmFtZS5zdHIpKTsKICBjb25zdCB1c2VUZW1wZmlsZVBhY2thZ2UgPSBhbGxQYWNrYWdlcy5maWx0ZXIoaSA9PiBpID09PSAidGVtcGZpbGUiKS5sZW5ndGggPiAwOwogIGNvbnN0IGltcG9ydEZyb20gPSBub2RlLmNvbnRleHQuaW1wb3J0cwogIAkuZmlsdGVyKHIgPT4gci5wa2cgJiYgci5wa2cudmFsdWUgPT09ICJ0ZW1wZmlsZSIgJiYgci5lbGVtZW50cyAmJiByLmVsZW1lbnRzLmZpbHRlcihlID0+IGUubmFtZSkubWFwKGUgPT4gZS5uYW1lLnZhbHVlKS5pbmNsdWRlcygibWt0ZW1wIikpOwoJY29uc3QgdXNlSW1wb3J0RnJvbSA9IGltcG9ydEZyb20ubGVuZ3RoID4gMDsKICBpZiAoIXVzZVRlbXBmaWxlUGFja2FnZSAmJiAhdXNlSW1wb3J0RnJvbSl7CiAgICByZXR1cm47CiAgfQogIAoKICBpZigodXNlVGVtcGZpbGVQYWNrYWdlICYmIG5vZGUubW9kdWxlT3JPYmplY3QgJiYgbm9kZS5mdW5jdGlvbk5hbWUgJiYgbm9kZS5mdW5jdGlvbk5hbWUudmFsdWUgPT09ICJta3RlbXAiICYmIG5vZGUubW9kdWxlT3JPYmplY3QudmFsdWUgPT09ICJ0ZW1wZmlsZSIpIHx8CiAgICAodXNlSW1wb3J0RnJvbSAmJiBub2RlLmZ1bmN0aW9uTmFtZS52YWx1ZSA9PT0gIm1rdGVtcCIpICl7CiAgICBjb25zdCBlcnJvciA9IGJ1aWxkRXJyb3Iobm9kZS5zdGFydC5saW5lLCBub2RlLnN0YXJ0LmNvbCwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9kZS5lbmQubGluZSwgbm9kZS5lbmQuY29sLCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAibWt0ZW1wIGlzIHVuc2FmZSIsICJDUklUSUNBTCIsICJTRUNVUklUWSIpOwoKICAgIGNvbnN0IGVkaXRzID0gW107CiAgICBjb25zdCBlZGl0ID0gYnVpbGRFZGl0VXBkYXRlKG5vZGUuZnVuY3Rpb25OYW1lLnN0YXJ0LmxpbmUsIG5vZGUuZnVuY3Rpb25OYW1lLnN0YXJ0LmNvbCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9kZS5mdW5jdGlvbk5hbWUuZW5kLmxpbmUsIG5vZGUuZnVuY3Rpb25OYW1lLmVuZC5jb2wsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJta3N0ZW1wIik7CiAgICAKICAgIGlmKHVzZUltcG9ydEZyb20pIHsKICAgICAgCiAgICAgICBjb25zdCBhZGRNaXNzaW5nSW1wb3J0ID0gYnVpbGRFZGl0VXBkYXRlKGltcG9ydEZyb21bMF0uZWxlbWVudHNbMF0uc3RhcnQubGluZSwgaW1wb3J0RnJvbVswXS5lbGVtZW50c1swXS5zdGFydC5jb2wsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGltcG9ydEZyb21bMF0uZWxlbWVudHNbMF0uZW5kLmxpbmUsIGltcG9ydEZyb21bMF0uZWxlbWVudHNbMF0uZW5kLmNvbCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCQkJCQkJCQkibWtzdGVtcCIpOwogICAgICBlZGl0cy5wdXNoKGFkZE1pc3NpbmdJbXBvcnQpOwogICAgfQogICAgCiAgICBlZGl0cy5wdXNoKGVkaXQpOwogICAgY29uc3QgZml4ID0gYnVpbGRGaXgoInVzZSBta3N0ZW1wIGluc3RlYWQiLCBlZGl0cyk7CiAgICBhZGRFcnJvcihlcnJvci5hZGRGaXgoZml4KSk7CiAgfQogIAp9",
      "regex": null
    },
    {
      "name": "python-security/yaml-load",
      "language": "PYTHON",
      "type": "AST_CHECK",
      "entity_checked": "FUNCTION_CALL",
      "code": "ZnVuY3Rpb24gdmlzaXQobm9kZSwgZmlsZW5hbWUsIGNvZGUpIHsKCiAgLy8gSWYgZmlsZW5hbWUgc3RhcnRzIG9yIGVuZHMgd2l0aCB0ZXN0XyBvciBfdGVzdCwgZG8gbm90IGRvIGFueXRoaW5nCiAgaWYgKGZpbGVuYW1lLmluY2x1ZGVzKCJfdGVzdC5weSIpIHx8IGZpbGVuYW1lLnN0YXJ0c1dpdGgoInRlc3RfIikpIHsKICAgIHJldHVybjsKICB9CgogIC8vIGlmIHRoZSBmdW5jdGlvbiBpcyBub3QgZGVmaW5lZCBvciBub3QgZXF1YWwgdG8gImluZm8iCiAgLy8gd2UgY2FuIHJldHVybi4KICBpZiAoIW5vZGUuZnVuY3Rpb25OYW1lIHx8IG5vZGUuZnVuY3Rpb25OYW1lLnZhbHVlICE9PSAibG9hZCIpIHsKICAgIHJldHVybjsKICB9CgogIC8vIElmIHRoZSBhbmFseXplciBkaWQgbm90IGdldCB0aGUgYXJndW1lbnRzIG9yIGlmIHRoZXJlIGlzIG5vIGFyZ3VtZW50LCBleGl0CiAgaWYgKCFub2RlLmFyZ3VtZW50cyB8fCAhbm9kZS5jb250ZXh0IHx8ICFub2RlLmFyZ3VtZW50cy52YWx1ZXMgfHwgbm9kZS5hcmd1bWVudHMudmFsdWVzLmxlbmd0aCA9PT0gMCkgewogICAgcmV0dXJuOwogIH0KCgoKICAvLyBHZXQgdGhlIGxpc3Qgb2YgYXJndW1lbnQKICBjb25zdCBhcmd1bWVudHMgPSBub2RlLmFyZ3VtZW50cy52YWx1ZXM7CiAgY29uc3QgbmJBcmd1bWVudHMgPSBub2RlLmFyZ3VtZW50cy52YWx1ZXMubGVuZ3RoOwoKICAvLyBHZXQgYWxsIHRoZSBwYWNrYWdlIGxpc3QgdGhhdCBhcmUgaW1wb3J0ZWQgd2l0aCAiaW1wb3J0IDxuYW1lPiIKICBjb25zdCBhbGxQYWNrYWdlcyA9IG5vZGUuY29udGV4dC5pbXBvcnRzLmZpbHRlcihyID0+IHIucGFja2FnZXMpLmZsYXRNYXAoaSA9PiBpLnBhY2thZ2VzLm1hcChwID0+IHAubmFtZS5zdHIpKTsKCiAgLy8gRG8gd2UgdXNlIHRoZSBsb2dnaW5nIHBhY2thZ2UgZm9yIFB5dGhvbj8KICBjb25zdCB1c2VZYW1sUGFja2FnZSA9IGFsbFBhY2thZ2VzLmZpbHRlcihpID0+IGkgPT09ICJ5YW1sIikubGVuZ3RoID4gMDsKCiAgY29uc3QgdXNlQnlJbXBvcnQgPSB1c2VZYW1sUGFja2FnZSAmJiBub2RlLm1vZHVsZU9yT2JqZWN0ICYmIG5vZGUubW9kdWxlT3JPYmplY3QudmFsdWUgPT09ICJ5YW1sIjsKCgogIGNvbnN0IGltcG9ydEZyb21TdGF0ZW1lbnRzID0gbm9kZS5jb250ZXh0LmltcG9ydHMKICAgIC5maWx0ZXIociA9PiByLnBrZyAmJiByLnBrZy52YWx1ZSA9PT0gInlhbWwiICYmIHIuZWxlbWVudHMgJiYKICAgICAgci5lbGVtZW50cy5maWx0ZXIoZSA9PiBlLm5hbWUpLm1hcChlID0+IGUubmFtZS52YWx1ZSkuaW5jbHVkZXMoImxvYWQiKSk7CiAgY29uc3QgaW1wb3J0RnJvbSA9IGltcG9ydEZyb21TdGF0ZW1lbnRzLmxlbmd0aCA+IDA7CiAgY29uc3QgdXNlQnlJbXBvcnRGcm9tID0gaW1wb3J0RnJvbSAmJiAhbm9kZS5tb2R1bGVPck9iamVjdDsKCgogIGNvbnN0IGhhc1NhZmVMb2FkZXIgPSBhcmd1bWVudHMuZmlsdGVyKGEgPT4gYS5uYW1lICYmIGEubmFtZSA9PT0gIkxvYWRlciIgJiYgYS52YWx1ZSAmJiBhLnZhbHVlLnZhbHVlLmluY2x1ZGVzKCJTYWZlTG9hZGVyIikpLmxlbmd0aCA+IDA7CgogIGlmICghaGFzU2FmZUxvYWRlciAmJiAodXNlQnlJbXBvcnQgfHwgdXNlQnlJbXBvcnRGcm9tKSkgewogICAgLy8gYnVpbGQgdGhlIGVycm9yCiAgICBjb25zdCBlcnJvciA9IGJ1aWxkRXJyb3Iobm9kZS5mdW5jdGlvbk5hbWUuc3RhcnQubGluZSwgbm9kZS5mdW5jdGlvbk5hbWUuc3RhcnQuY29sLAogICAgICBub2RlLmZ1bmN0aW9uTmFtZS5lbmQubGluZSwgbm9kZS5mdW5jdGlvbk5hbWUuZW5kLmNvbCwKICAgICAgInByZWZlciB1c2luZyBzYWZlX2xvYWQgdG8gYXZvaWQgYXJiaXRyYXJ5IGNvZGUgZXhlY3V0aW9uIiwgIldBUk5JTkciLCAiU0VDVVJJVFkiKTsKICAgIGNvbnN0IGVkaXRzID0gW107CiAgICAvLyBidWlsZCB0aGUgZml4IChyZXBsYWNlIGZvbyBieSBiYXIpCiAgICBjb25zdCBlZGl0ID0gYnVpbGRFZGl0VXBkYXRlKG5vZGUuZnVuY3Rpb25OYW1lLnN0YXJ0LmxpbmUsIG5vZGUuZnVuY3Rpb25OYW1lLnN0YXJ0LmNvbCwKICAgICAgbm9kZS5mdW5jdGlvbk5hbWUuZW5kLmxpbmUsIG5vZGUuZnVuY3Rpb25OYW1lLmVuZC5jb2wsCiAgICAgICJzYWZlX2xvYWQiKTsKICAgIGlmIChpbXBvcnRGcm9tKSB7CiAgICAgIGNvbnNvbGUubG9nKCJhZGRpdGlvbmFsIGZpeCIpOwogICAgICBjb25zdCBlbGVtZW50VG9VcGRhdGUgPSBpbXBvcnRGcm9tU3RhdGVtZW50c1swXS5lbGVtZW50cy5maWx0ZXIoZSA9PiBlLm5hbWUgJiYgZS5uYW1lLnZhbHVlID09PSAibG9hZCIpWzBdOwogICAgICBjb25zdCBlZGl0SW1wb3J0RnJvbSA9IGJ1aWxkRWRpdFVwZGF0ZShlbGVtZW50VG9VcGRhdGUuc3RhcnQubGluZSwgZWxlbWVudFRvVXBkYXRlLnN0YXJ0LmNvbCwKICAgICAgICBlbGVtZW50VG9VcGRhdGUuZW5kLmxpbmUsIGVsZW1lbnRUb1VwZGF0ZS5lbmQuY29sLAogICAgICAgICJzYWZlX2xvYWQiKTsKICAgICAgZWRpdHMucHVzaChlZGl0SW1wb3J0RnJvbSk7CiAgICB9CiAgICBlZGl0cy5wdXNoKGVkaXQpOwogICAgLy8gYnVpbGQgYSBmaXggd2l0aCBvbmUgZWRpdAogICAgY29uc3QgZml4ID0gYnVpbGRGaXgoInVzZSBzYWZlX2xvYWQiLCBlZGl0cyk7CgogICAgLy8gcmVwb3J0IGFuIGVycm9yIHdpdGggYSBmaXgKICAgIGFkZEVycm9yKGVycm9yLmFkZEZpeChmaXgpKTsKICB9Cn0=",
      "regex": null
    },
    {
      "name": "python-security/avoid-random",
      "language": "PYTHON",
      "type": "AST_CHECK",
      "entity_checked": "FUNCTION_CALL",
      "code": "ZnVuY3Rpb24gdmlzaXQobm9kZSwgZmlsZW5hbWUsIGNvZGUpIHsKICBpZiAoZmlsZW5hbWUuaW5jbHVkZXMoIl90ZXN0LnB5IikgfHwgZmlsZW5hbWUuc3RhcnRzV2l0aCgidGVzdF8iKSkgewogIAlyZXR1cm47Cgl9CiAgCiAgaWYoIW5vZGUuZnVuY3Rpb25OYW1lIHx8ICFub2RlLmNvbnRleHQpewogICAgcmV0dXJuOwogIH0KICBpZihub2RlLmZ1bmN0aW9uTmFtZS52YWx1ZSAhPT0gInJhbmRyYW5nZSIgJiYgbm9kZS5mdW5jdGlvbk5hbWUudmFsdWUgIT09ICJyYW5kb20iKXsKICAgIHJldHVybjsKICB9CiAgCiAgY29uc3QgYWxsUGFja2FnZXMgPSBub2RlLmNvbnRleHQuaW1wb3J0cy5maWx0ZXIociA9PiByLnBhY2thZ2VzKS5mbGF0TWFwKGkgPT4gaS5wYWNrYWdlcy5tYXAocCA9PiBwLm5hbWUuc3RyKSk7CiAgY29uc3QgdXNlUmFuZG9tUGFja2FnZSA9IGFsbFBhY2thZ2VzLmZpbHRlcihpID0+IGkgPT09ICJyYW5kb20iKS5sZW5ndGggPiAwOwogIGNvbnN0IHVzZVNlY3JldHNQYWNrYWdlID0gYWxsUGFja2FnZXMuZmlsdGVyKGkgPT4gaSA9PT0gInNlY3JldHMiKS5sZW5ndGggPiAwOwogIGNvbnN0IGltcG9ydFJhbmRvbUZ1bmN0aW9uRnJvbSA9IG5vZGUuY29udGV4dC5pbXBvcnRzCiAgCS5maWx0ZXIociA9PiByLnBrZyAmJiByLnBrZy52YWx1ZSA9PT0gInJhbmRvbSIgJiYgci5lbGVtZW50cyAmJiByLmVsZW1lbnRzLmZpbHRlcihlID0+IGUubmFtZSkubWFwKGUgPT4gZS5uYW1lLnZhbHVlKS5pbmNsdWRlcygicmFuZG9tIikpLmxlbmd0aCA+IDA7Cgljb25zdCBpbXBvcnRSYW5kUmFuZ2VGdW5jdGlvbkZyb20gPSBub2RlLmNvbnRleHQuaW1wb3J0cwogIAkuZmlsdGVyKHIgPT4gci5wa2cgJiYgci5wa2cudmFsdWUgPT09ICJyYW5kb20iICYmIHIuZWxlbWVudHMgJiYgci5lbGVtZW50cy5maWx0ZXIoZSA9PiBlLm5hbWUpLm1hcChlID0+IGUubmFtZS52YWx1ZSkuaW5jbHVkZXMoInJhbmRyYW5nZSIpKS5sZW5ndGggPiAwOwogIAoJY29uc3QgZWRpdHMgPSBbXTsKCgogIGlmKCFub2RlLmZ1bmN0aW9uTmFtZSl7CiAgICByZXR1cm47CiAgfQoKICBjb25zdCBlZGl0QWRkSW1wb3J0ID0gYnVpbGRFZGl0QWRkKDEsIDEsICJpbXBvcnQgc2VjcmV0c1xuIik7CiAgCiAgaWYodXNlUmFuZG9tUGFja2FnZSAmJiBub2RlLm1vZHVsZU9yT2JqZWN0ICYmIAogICAgIG5vZGUuZnVuY3Rpb25OYW1lICYmIG5vZGUuZnVuY3Rpb25OYW1lLnZhbHVlID09PSAicmFuZG9tIiAmJiAKICAgICBub2RlLm1vZHVsZU9yT2JqZWN0LnZhbHVlID09PSAicmFuZG9tIil7CiAgICBjb25zdCBoYXNBcmd1bWVudHMgPSAobm9kZS5hcmd1bWVudHMgJiYgbm9kZS5hcmd1bWVudHMudmFsdWVzICYmIG5vZGUuYXJndW1lbnRzLnZhbHVlcyAmJiBub2RlLmFyZ3VtZW50cy52YWx1ZXMubGVuZ3RoID4gMCkgfHwgZmFsc2U7CiAgCQogICAgdmFyIGVycm9yID0gYnVpbGRFcnJvcihub2RlLnN0YXJ0LmxpbmUsIG5vZGUuc3RhcnQuY29sLCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9kZS5lbmQubGluZSwgbm9kZS5lbmQuY29sLCAKICAgICAgICAgICAgICAgICAgICAgICAgICAiZG8gbm90IHVzZSByYW5kb20iLCAiV0FSTklORyIsICJTRUNVUklUWSIpOwoKICAgIGlmKCFoYXNBcmd1bWVudHMpIHsKICAgICAgICAgIAogICAgIAljb25zdCBlZGl0ID0gYnVpbGRFZGl0VXBkYXRlKG5vZGUuc3RhcnQubGluZSwgbm9kZS5zdGFydC5jb2wsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9kZS5lbmQubGluZSwgbm9kZS5lbmQuY29sLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJzZWNyZXRzLnJhbmRiZWxvdygxMDApIC8gMTAwIik7CiAgICAgIGVkaXRzLnB1c2goZWRpdCk7CiAgICAgIGlmKCF1c2VTZWNyZXRzUGFja2FnZSl7CiAgICAgICAgZWRpdHMucHVzaChidWlsZEVkaXRBZGQoMSwgMSwgImltcG9ydCBzZWNyZXRzXG4iKSk7CiAgICAgIH0KICAgICAgY29uc3QgZml4ID0gYnVpbGRGaXgoInVzZSBzZWNyZXRzLnJhbmRiZWxvdyBpbnN0ZWFkIiwgZWRpdHMpOwogICAgICBlcnJvciA9IGVycm9yLmFkZEZpeChmaXgpOwogICAgfQogICAgCiAgIAlhZGRFcnJvcihlcnJvcik7CiAgfQogIGlmKGltcG9ydFJhbmRvbUZ1bmN0aW9uRnJvbSAmJiAKICAgICBub2RlLmZ1bmN0aW9uTmFtZSAmJiBub2RlLmZ1bmN0aW9uTmFtZS52YWx1ZSA9PT0gInJhbmRvbSIpewogICAgY29uc3QgaGFzQXJndW1lbnRzID0gKG5vZGUuYXJndW1lbnRzICYmIG5vZGUuYXJndW1lbnRzLnZhbHVlcyAmJiAKICAgICAgICAgICAgICAgICAgICAgICAgICBub2RlLmFyZ3VtZW50cy52YWx1ZXMgJiYgbm9kZS5hcmd1bWVudHMudmFsdWVzLmxlbmd0aCA+IDApIHx8IGZhbHNlOwogIAkKICAgIHZhciBlcnJvciA9IGJ1aWxkRXJyb3Iobm9kZS5zdGFydC5saW5lLCBub2RlLnN0YXJ0LmNvbCwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vZGUuZW5kLmxpbmUsIG5vZGUuZW5kLmNvbCwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgImRvIG5vdCB1c2UgcmFuZG9tIiwgIldBUk5JTkciLCAiU0VDVVJJVFkiKTsKCiAgICBpZighaGFzQXJndW1lbnRzKSB7CiAgICAgICAgICAKICAgICAJY29uc3QgZWRpdCA9IGJ1aWxkRWRpdFVwZGF0ZShub2RlLnN0YXJ0LmxpbmUsIG5vZGUuc3RhcnQuY29sLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vZGUuZW5kLmxpbmUsIG5vZGUuZW5kLmNvbCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAic2VjcmV0cy5yYW5kYmVsb3coMTAwKSAvIDEwMCIpOwogICAgICBlZGl0cy5wdXNoKGVkaXQpOwogICAgICBpZighdXNlU2VjcmV0c1BhY2thZ2UpewogICAgICAgIGVkaXRzLnB1c2goYnVpbGRFZGl0QWRkKDEsIDEsICJpbXBvcnQgc2VjcmV0c1xuIikpOwogICAgICB9CiAgICAgIGNvbnN0IGZpeCA9IGJ1aWxkRml4KCJ1c2Ugc2VjcmV0cy5yYW5kYmVsb3cgaW5zdGVhZCIsIGVkaXRzKTsKICAgICAgZXJyb3IgPSBlcnJvci5hZGRGaXgoZml4KTsKICAgIH0KICAgIAogICAgY29uc3QgZWRpdEFkZEltcG9ydCA9IGJ1aWxkRWRpdEFkZCgxLCAxLCAiaW1wb3J0IHN5c1xuIik7CiAgIAlhZGRFcnJvcihlcnJvcik7CiAgfQogIGlmKHVzZVJhbmRvbVBhY2thZ2UgJiYgbm9kZS5tb2R1bGVPck9iamVjdCAmJiAKICAgICBub2RlLmZ1bmN0aW9uTmFtZSAmJiBub2RlLmZ1bmN0aW9uTmFtZS52YWx1ZSA9PT0gInJhbmRyYW5nZSIgJiYgCiAgICAgbm9kZS5tb2R1bGVPck9iamVjdC52YWx1ZSA9PT0gInJhbmRvbSIpewogICAgY29uc3QgaGFzQXJndW1lbnRzID0gKG5vZGUuYXJndW1lbnRzICYmIG5vZGUuYXJndW1lbnRzLnZhbHVlcyAmJiBub2RlLmFyZ3VtZW50cy52YWx1ZXMgJiYgbm9kZS5hcmd1bWVudHMudmFsdWVzLmxlbmd0aCA+IDApIHx8IGZhbHNlOwogIAljb25zb2xlLmxvZygiaGVyZSIpOwogICAgaWYgKGhhc0FyZ3VtZW50cykgewogICAgICAJdmFyIGVycm9yID0gYnVpbGRFcnJvcihub2RlLnN0YXJ0LmxpbmUsIG5vZGUuc3RhcnQuY29sLCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9kZS5lbmQubGluZSwgbm9kZS5lbmQuY29sLCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgImRvIG5vdCB1c2UgcmFuZ3JhbmdlIiwgIldBUk5JTkciLCAiU0VDVVJJVFkiKTsKCiAgICAgIGNvbnN0IGZpcnN0QXJndW1lbnRWYWx1ZSA9IG5vZGUuYXJndW1lbnRzLnZhbHVlc1swXS52YWx1ZS52YWx1ZTsKICAgICAgY29uc3QgZWRpdCA9IGJ1aWxkRWRpdFVwZGF0ZShub2RlLnN0YXJ0LmxpbmUsIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vZGUuc3RhcnQuY29sLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vZGUuZW5kLmxpbmUsIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vZGUuZW5kLmNvbCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBgc2VjcmV0cy5yYW5kYmVsb3coJHtmaXJzdEFyZ3VtZW50VmFsdWV9KWApOwogICAgICBlZGl0cy5wdXNoKGVkaXQpOwogICAgICBpZighdXNlU2VjcmV0c1BhY2thZ2UpewogICAgICAgIGVkaXRzLnB1c2goYnVpbGRFZGl0QWRkKDEsIDEsICJpbXBvcnQgc2VjcmV0c1xuIikpOwogICAgICB9CiAgICAgIGNvbnN0IGZpeCA9IGJ1aWxkRml4KCJ1c2Ugc2VjcmV0cy5yYW5kYmVsb3cgaW5zdGVhZCIsIGVkaXRzKTsKICAgICAgZXJyb3IgPSBlcnJvci5hZGRGaXgoZml4KTsKCiAgICAJYWRkRXJyb3IoZXJyb3IpOwogICAgfQogIH0KICAKICBpZihpbXBvcnRSYW5kUmFuZ2VGdW5jdGlvbkZyb20gJiYgCiAgICAgbm9kZS5mdW5jdGlvbk5hbWUgJiYgbm9kZS5mdW5jdGlvbk5hbWUudmFsdWUgPT09ICJyYW5kcmFuZ2UiKXsKICAgIGNvbnN0IGhhc0FyZ3VtZW50cyA9IChub2RlLmFyZ3VtZW50cyAmJiBub2RlLmFyZ3VtZW50cy52YWx1ZXMgJiYgbm9kZS5hcmd1bWVudHMudmFsdWVzICYmIG5vZGUuYXJndW1lbnRzLnZhbHVlcy5sZW5ndGggPiAwKSB8fCBmYWxzZTsKICAJCiAgICB2YXIgZXJyb3IgPSBidWlsZEVycm9yKG5vZGUuc3RhcnQubGluZSwgbm9kZS5zdGFydC5jb2wsIAogICAgICAgICAgICAgICAgICAgICAgICAgICBub2RlLmVuZC5saW5lLCBub2RlLmVuZC5jb2wsIAogICAgICAgICAgICAgICAgICAgICAgICAgICJkbyBub3QgdXNlIHJhbmRyYW5nZSIsICJXQVJOSU5HIiwgIlNFQ1VSSVRZIik7CgogICAgaWYoIWhhc0FyZ3VtZW50cykgewogICAgICAgICAgCiAgICAgCWNvbnN0IGVkaXQgPSBidWlsZEVkaXRVcGRhdGUobm9kZS5zdGFydC5saW5lLCBub2RlLnN0YXJ0LmNvbCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBub2RlLmVuZC5saW5lLCBub2RlLmVuZC5jb2wsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgInNlY3JldHMucmFuZGJlbG93KDEwMCkgLyAxMDAiKTsKICAgICAgZWRpdHMucHVzaChlZGl0KTsKICAgICAgaWYoIXVzZVNlY3JldHNQYWNrYWdlKXsKICAgICAgICBlZGl0cy5wdXNoKGJ1aWxkRWRpdEFkZCgxLCAxLCAiaW1wb3J0IHNlY3JldHNcbiIpKTsKICAgICAgfQogICAgICBjb25zdCBmaXggPSBidWlsZEZpeCgidXNlIHNlY3JldHMucmFuZGJlbG93IGluc3RlYWQiLCBlZGl0cyk7CiAgICAgIGVycm9yID0gZXJyb3IuYWRkRml4KGZpeCk7CiAgICB9CiAgICAKICAgIGNvbnN0IGVkaXRBZGRJbXBvcnQgPSBidWlsZEVkaXRBZGQoMSwgMSwgImltcG9ydCBzeXNcbiIpOwogICAJYWRkRXJyb3IoZXJyb3IpOwogIH0KICAKfQ==",
      "regex": null
    },
    {
      "name": "python-security/insecure-jwt",
      "language": "PYTHON",
      "type": "AST_CHECK",
      "entity_checked": "FUNCTION_CALL",
      "code": "ZnVuY3Rpb24gdmlzaXQobm9kZSwgZmlsZW5hbWUsIGNvZGUpIHsKCiAgLy8gSWYgdGhlIGFuYWx5emVyIGRpZCBub3QgZ2V0IHRoZSBhcmd1bWVudHMgb3IgaWYgdGhlcmUgaXMgbm8gYXJndW1lbnQsIGV4aXQKICBpZiAoIW5vZGUuYXJndW1lbnRzIHx8ICFub2RlLmFyZ3VtZW50cy52YWx1ZXMgfHwgbm9kZS5hcmd1bWVudHMudmFsdWVzLmxlbmd0aCA9PT0gMCkgewogICAgcmV0dXJuOwogIH0KCiAgaWYgKCFub2RlLm1vZHVsZU9yT2JqZWN0IHx8IG5vZGUubW9kdWxlT3JPYmplY3QudmFsdWUgIT09ICJqd3QiKSB7CiAgICByZXR1cm47CiAgfQoKICAvLyBpZiB0aGUgZnVuY3Rpb24gaXMgbm90IGRlZmluZWQgb3Igbm90IGVxdWFsIHRvICJpbmZvIgogIC8vIHdlIGNhbiByZXR1cm4uCiAgaWYgKCFub2RlLmZ1bmN0aW9uTmFtZSB8fCBub2RlLmZ1bmN0aW9uTmFtZS52YWx1ZSAhPT0gImRlY29kZSIpIHsKICAgIHJldHVybjsKICB9CgogIGNvbnN0IGFyZ3VtZW50cyA9IG5vZGUuYXJndW1lbnRzLnZhbHVlczsKICBjb25zdCBuYkFyZ3VtZW50cyA9IG5vZGUuYXJndW1lbnRzLnZhbHVlcy5sZW5ndGg7CgogIGNvbnN0IGFsbFBhY2thZ2VzID0gbm9kZS5jb250ZXh0LmltcG9ydHMuZmlsdGVyKHIgPT4gci5wYWNrYWdlcykuZmxhdE1hcChpID0+IGkucGFja2FnZXMubWFwKHAgPT4gcC5uYW1lLnN0cikpOwoKICBjb25zdCB1c2VKd3RQYWNrYWdlID0gYWxsUGFja2FnZXMuZmlsdGVyKGkgPT4gaSA9PT0gImp3dCIpLmxlbmd0aCA+IDA7CiAgaWYgKCF1c2VKd3RQYWNrYWdlKSB7CiAgICByZXR1cm47CiAgfQoKICAvLyBEbyB3ZSBoYXZlIGFuIG9wdGlvbnMgYXJndW1lbnRzPwogIGNvbnN0IG9wdGlvbkFyZ3VtZW50cyA9IGFyZ3VtZW50cy5maWx0ZXIoYSA9PiBhLm5hbWUgJiYgYS5uYW1lLnZhbHVlID09PSAib3B0aW9ucyIpOwogIGlmIChvcHRpb25Bcmd1bWVudHMgJiYgb3B0aW9uQXJndW1lbnRzLmxlbmd0aCA+IDApIHsKICAgIGNvbnN0IG9wdGlvbkFyZ3VtZW50ID0gb3B0aW9uQXJndW1lbnRzWzBdOwoJCWlmKG9wdGlvbkFyZ3VtZW50LnZhbHVlICYmIG9wdGlvbkFyZ3VtZW50LnZhbHVlLmFzdFR5cGUgPT09ICJkaWN0aW9uYXJ5IikgewoJCQljb25zdCBkaWN0aW9uYXJ5ID0gb3B0aW9uQXJndW1lbnQudmFsdWU7CgkJCWNvbnN0IGhhc0lzc3VlID0gZGljdGlvbmFyeS5lbGVtZW50cwoJCQkJLmZpbHRlcihlID0+IGUua2V5ICYmIGUua2V5LnZhbHVlICYmIGUua2V5LnZhbHVlID09PSAiXCJ2ZXJpZnlfc2lnbmF0dXJlXCIiICYmIGUudmFsdWUgJiYgZS52YWx1ZS52YWx1ZSAmJiBlLnZhbHVlLnZhbHVlID09PSAiRmFsc2UiKS5sZW5ndGggPiAwOwoJCQlpZiAoaGFzSXNzdWUpIHsKCQkJCS8vIGJ1aWxkIHRoZSBlcnJvcgoJCQkJY29uc3QgZXJyb3IgPSBidWlsZEVycm9yKG9wdGlvbkFyZ3VtZW50LnN0YXJ0LmxpbmUsIG9wdGlvbkFyZ3VtZW50LnN0YXJ0LmNvbCwKCQkJCQlvcHRpb25Bcmd1bWVudC5lbmQubGluZSwgb3B0aW9uQXJndW1lbnQuZW5kLmNvbCwKCQkJCQkiaW5zZWN1cmUgSldULCBjaGFuZ2UgdmVyaWZ5X3NpZ25hdHVyZSB0byBUcnVlIiwgIldBUk5JTkciLCAiU0VDVVJJVFkiKTsKCgkJCQlhZGRFcnJvcihlcnJvcik7CiAgICAJfQoJCX0KICB9Cn0=",
      "regex": null
    },
    {
      "name": "python-security/jinja2-autoescape",
      "language": "PYTHON",
      "type": "AST_CHECK",
      "entity_checked": "FUNCTION_CALL",
      "code": "ZnVuY3Rpb24gdmlzaXQobm9kZSwgZmlsZW5hbWUsIGNvZGUpIHsKICAKICBpZighbm9kZS5mdW5jdGlvbk5hbWUgfHwgIW5vZGUuY29udGV4dCkgewogICAgcmV0dXJuOwogIH0KICAKICBpZiAobm9kZS5mdW5jdGlvbk5hbWUudmFsdWUgPT09ICJFbnZpcm9ubWVudCIpIHsKICAgIAogICAgY29uc3QgdXNlSmluamEyRW52aXJvbm1lbnQgPSBub2RlLmNvbnRleHQuaW1wb3J0cy5maWx0ZXIoaSA9PiBpLmVsZW1lbnRzICYmIGkucGtnKS5maWx0ZXIoaSA9PiBpLmVsZW1lbnRzLm1hcChlID0+IGUubmFtZS52YWx1ZSkuaW5jbHVkZXMoIkVudmlyb25tZW50IikgJiYgaS5wa2cudmFsdWUgPT09ICJqaW5qYTIiKS5sZW5ndGggPiAwOwoJCiAgICBpZih1c2VKaW5qYTJFbnZpcm9ubWVudCkgewogICAgICBpZighbm9kZS5hcmd1bWVudHMgfHwgIW5vZGUuYXJndW1lbnRzLnZhbHVlcyl7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIAogICAgICBjb25zdCBoYXNBdXRvRXNjYXBlID0gbm9kZS5hcmd1bWVudHMudmFsdWVzLmZpbHRlcihhID0+IGEubmFtZSAmJiBhLm5hbWUudmFsdWUgPT0gImF1dG9lc2NhcGUiKS5sZW5ndGggPiAwOwoJCQkKICAgICAgaWYoaGFzQXV0b0VzY2FwZSl7CiAgICAgIAljb25zdCBhcmcgPSBub2RlLmFyZ3VtZW50cy52YWx1ZXMuZmlsdGVyKGEgPT4gYS5uYW1lICYmIGEubmFtZS52YWx1ZSA9PSAiYXV0b2VzY2FwZSIpWzBdOwogICAgICAgIGlmKGFyZy52YWx1ZS52YWx1ZSA9PT0gIkZhbHNlIil7CiAgICAgICAgICAgICBjb25zdCBlcnJvciA9IGJ1aWxkRXJyb3IoYXJnLnN0YXJ0LmxpbmUsIGFyZy5zdGFydC5jb2wsIGFyZy5lbmQubGluZSwgYXJnLmVuZC5jb2wsICJhdXRvZXNjYXBlPUZhbHNlIGxlYWRzIHRvIFhTUyBpc3N1ZXMiLCAiQ1JJVElDQUwiLCAiU0VDVVJJVFkiKTsKCiAgICAgICAgICAgICBjb25zdCBlZGl0ID0gYnVpbGRFZGl0VXBkYXRlKAogICAgICAgICAgICAgICBhcmcudmFsdWUuc3RhcnQubGluZSwgYXJnLnZhbHVlLnN0YXJ0LmNvbCwKICAgICAgICAgICAgICAgYXJnLnZhbHVlLmVuZC5saW5lLCBhcmcudmFsdWUuZW5kLmNvbCwgIlRydWUiKQogICAgCQkJCWNvbnN0IGZpeCA9IGJ1aWxkRml4KCJ1c2UgYXV0b2VzY2FwZSBUcnVlIiwgW2VkaXRdKTsKICAgIAkJCQlhZGRFcnJvcihlcnJvci5hZGRGaXgoZml4KSk7CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgfQogIAp9",
      "regex": null
    },
    {
      "name": "python-security/variable-sql-statement-injection",
      "language": "PYTHON",
      "type": "AST_CHECK",
      "entity_checked": "ASSIGNMENT",
      "code": "Y29uc3QgaGFzUG90ZW50aWFsSW5qZWN0aW9uID0gKHF1ZXJ5KSA9PiB7CiAgY29uc3QgZm9ybWF0UmVnRXhwID0gL1x7W2EtekEtWjAtOV0qXH0vaTsKICBpZiAocXVlcnkubWF0Y2goZm9ybWF0UmVnRXhwKSkgewogICAgcmV0dXJuIHRydWU7CiAgfQogIHJldHVybiBmYWxzZTsKfTsKCmNvbnN0IGlzU3FsUXVlcnkgPSAocmFuZG9tU3RyaW5nKSA9PiB7CiAgY29uc3Qgc2VsZWN0UmVnZXhwID0gLy4qXHMqU0VMRUNUXHMrW2EtekEtWjAtOSwqXC5cX1wtXStccytGUk9NXHMrW2EtekEtWjAtOSwqXC5cX10vaTsKICBpZiAocmFuZG9tU3RyaW5nLm1hdGNoKHNlbGVjdFJlZ2V4cCkpIHsKICAgIHJldHVybiB0cnVlOwogIH0KICBjb25zdCB1cGRhdGVSZWdleHAgPSAvLipccypVUERBVEVccytbYS16QS1aMC05XF9cLV0rXHMrU0VUL2k7CiAgaWYgKHJhbmRvbVN0cmluZy5tYXRjaCh1cGRhdGVSZWdleHApKSB7CiAgICByZXR1cm4gdHJ1ZTsKICB9CiAgY29uc3QgZGVsZXRlUmVnZXhwID0gLy4qXHMqREVMRVRFXHMrRlJPTVxzK1thLXpBLVowLTksKlwuXF9cLV0rL2k7CiAgaWYgKHJhbmRvbVN0cmluZy5tYXRjaChkZWxldGVSZWdleHApKSB7CiAgICByZXR1cm4gdHJ1ZTsKICB9CiAgcmV0dXJuIGZhbHNlOwp9OwoKZnVuY3Rpb24gdmlzaXQobm9kZSwgZmlsZW5hbWUsIGNvZGUpIHsKICAKICBpZiAoZmlsZW5hbWUuaW5jbHVkZXMoIl90ZXN0LnB5IikgfHwgZmlsZW5hbWUuc3RhcnRzV2l0aCgidGVzdF8iKSkgewogIAlyZXR1cm47Cgl9CiAgCiAgaWYoIW5vZGUucmlnaHQpIHsKICAgIHJldHVybjsKICB9CgogIAogIGlmKG5vZGUucmlnaHQuYXN0VHlwZSA9PT0gInN0cmluZyIpIHsKICAgIGNvbnN0IG5vZGVTdHJpbmcgPSBub2RlLnJpZ2h0OwogICAgY29uc3Qgc3RyVmFsdWUgPSBub2RlU3RyaW5nLnZhbHVlLnRvTG93ZXJDYXNlKCk7CiAgICBpZighc3RyVmFsdWUuaW5jbHVkZXMoInNlbGVjdCIpICYmCiAgICAgICAhc3RyVmFsdWUuaW5jbHVkZXMoInVwZGF0ZSIpICYmCiAgICAgICAhc3RyVmFsdWUuaW5jbHVkZXMoImRlbGV0ZSIpKSB7CiAgICAgIHJldHVybjsKICAgIH0KICAgIGlmKGlzU3FsUXVlcnkobm9kZVN0cmluZy52YWx1ZSkgJiYgaGFzUG90ZW50aWFsSW5qZWN0aW9uKG5vZGVTdHJpbmcudmFsdWUpKXsKICAgICAgY29uc3QgZXJyb3IgPSBidWlsZEVycm9yKG5vZGVTdHJpbmcuc3RhcnQubGluZSwgbm9kZVN0cmluZy5zdGFydC5jb2wsIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9kZVN0cmluZy5lbmQubGluZSwgbm9kZVN0cmluZy5lbmQuY29sLCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJwb3RlbnRpYWwgU1FMIGluamVjdGlvbiIsICJXQVJOSU5HIiwgIlNFQ1VSSVRZIik7CiAgICAgIGFkZEVycm9yKGVycm9yKTsKCiAgICB9CiAgfQogIAogIGlmKG5vZGUucmlnaHQuYXN0VHlwZSA9PT0gImZ1bmN0aW9uY2FsbCIpIHsKICAgIGNvbnN0IGZ1bmN0aW9uQ2FsbCA9IG5vZGUucmlnaHQ7CiAgICBpZiAoIWZ1bmN0aW9uQ2FsbC5tb2R1bGVPck9iamVjdCkgewogICAgICByZXR1cm47CiAgICB9CiAgICBpZihmdW5jdGlvbkNhbGwuZnVuY3Rpb25OYW1lLnZhbHVlID09PSAiZm9ybWF0IikgewogICAgICBpZihpc1NxbFF1ZXJ5KGZ1bmN0aW9uQ2FsbC5tb2R1bGVPck9iamVjdC52YWx1ZSkgJiYgaGFzUG90ZW50aWFsSW5qZWN0aW9uKGZ1bmN0aW9uQ2FsbC5tb2R1bGVPck9iamVjdC52YWx1ZSkpewogICAgICAgIAljb25zdCBlcnJvciA9IGJ1aWxkRXJyb3IoZnVuY3Rpb25DYWxsLm1vZHVsZU9yT2JqZWN0LnN0YXJ0LmxpbmUsIGZ1bmN0aW9uQ2FsbC5tb2R1bGVPck9iamVjdC5zdGFydC5jb2wsIAogICAgICAgICAgICAgICAgICAJCQkJCQkJCSBmdW5jdGlvbkNhbGwubW9kdWxlT3JPYmplY3QuZW5kLmxpbmUsIGZ1bmN0aW9uQ2FsbC5tb2R1bGVPck9iamVjdC5lbmQuY29sLCAKICAgICAgICAgICAgICAgICAgIAkJCQkJCQkJICJwb3RlbnRpYWwgU1FMIGluamVjdGlvbiIsICJXQVJOSU5HIiwgIlNFQ1VSSVRZIik7CiAgICAgICAgICBhZGRFcnJvcihlcnJvcik7CgogICAgICB9CiAgICB9CiAgfQp9",
      "regex": null
    },
    {
      "name": "python-security/no-empty-array-as-parameter",
      "language": "PYTHON",
      "type": "AST_CHECK",
      "entity_checked": "FUNCTION_DEFINITION",
      "code": "ZnVuY3Rpb24gdmlzaXQobm9kZSkgewogIGlmIChub2RlLnBhcmFtZXRlcnMgJiYgbm9kZS5wYXJhbWV0ZXJzLnZhbHVlcykgewogICAgY29uc3QgcGFyYW1ldGVyc1dpdGhFbXB0eUFycmF5ID0gbm9kZS5wYXJhbWV0ZXJzLnZhbHVlcy5maWx0ZXIocCA9PiBwICYmIHAuZGVmYXVsdFZhbHVlICYmIHAuZGVmYXVsdFZhbHVlLnZhbHVlID09PSAiW10iKTsKCiAgICBmb3IodmFyIGkgPSAwIDsgaSA8IHBhcmFtZXRlcnNXaXRoRW1wdHlBcnJheS5sZW5ndGggOyBpKyspIHsKICAgICAgY29uc3QgcGFyYW1ldGVyID0gcGFyYW1ldGVyc1dpdGhFbXB0eUFycmF5W2ldOwogICAgICBjb25zdCBlcnJvciA9IGJ1aWxkRXJyb3IocGFyYW1ldGVyLmRlZmF1bHRWYWx1ZS5zdGFydC5saW5lLCBwYXJhbWV0ZXIuZGVmYXVsdFZhbHVlLnN0YXJ0LmNvbCwgcGFyYW1ldGVyLmRlZmF1bHRWYWx1ZS5lbmQubGluZSwgcGFyYW1ldGVyLmRlZmF1bHRWYWx1ZS5lbmQuY29sLCAiY2Fubm90IHVzZSBkZWZhdWx0IGluaXRpYWxpemVyIFtdIGluIGZ1bmN0aW9uIiwgIkNSSVRJQ0FMIiwgIlNBRkVUWSIpOwogICAgICBhZGRFcnJvcihlcnJvcik7CiAgICB9CiAgfQp9",
      "regex": null
    },
    {
      "name": "python-security/no-eval",
      "language": "PYTHON",
      "type": "AST_CHECK",
      "entity_checked": "FUNCTION_CALL",
      "code": "ZnVuY3Rpb24gdmlzaXQobm9kZSkgewogIGlmKG5vZGUuZnVuY3Rpb25OYW1lLnZhbHVlID09PSAiZXZhbCIgJiYgIW5vZGUubW9kdWxlT3JPYmplY3QpewogICAgY29uc3QgaGFzT25lQXJndW1lbnQgPSBub2RlLmFyZ3VtZW50cyAmJiBub2RlLmFyZ3VtZW50cy52YWx1ZXMgJiYgbm9kZS5hcmd1bWVudHMudmFsdWVzLmxlbmd0aCA9PT0gMTsKCiAgICBjb25zdCBlcnJvciA9IGJ1aWxkRXJyb3Iobm9kZS5zdGFydC5saW5lLCBub2RlLnN0YXJ0LmNvbCwgbm9kZS5lbmQubGluZSwgbm9kZS5lbmQuY29sLCAiZG8gbm90IHVzZSBldmFsIGFzIHRoaXMgaXMgdW5zYWZlIiwgIkNSSVRJQ0FMIiwgIlNBRkVUWSIpOwoKICAgIGNvbnN0IGFyZ3VtZW50VmFsdWUgPSBub2RlLmFyZ3VtZW50cy52YWx1ZXNbMF0udmFsdWUuc3RyOwogICAgY29uc3QgbmV3RnVuY3Rpb25DYWxsID0gYGxpdGVyYWxfZXZhbCgke2FyZ3VtZW50VmFsdWV9KWA7CiAgICBjb25zdCBlZGl0UmVwbGFjZUZ1bmN0aW9uQ2FsbCA9IGJ1aWxkRWRpdFVwZGF0ZShub2RlLnN0YXJ0LmxpbmUsIG5vZGUuc3RhcnQuY29sLCBub2RlLmVuZC5saW5lLCBub2RlLmVuZC5jb2wsIG5ld0Z1bmN0aW9uQ2FsbCkKCiAgICBjb25zdCBlZGl0QWRkSW1wb3J0ID0gYnVpbGRFZGl0QWRkKDEsIDEsICJmcm9tIGFzdCBpbXBvcnQgbGl0ZXJhbF9ldmFsXG4iKTsKCgogICAgY29uc3QgZml4ID0gYnVpbGRGaXgoInJlcGxhY2Ugd2l0aCBsaXRlcmFsX2V2YWwiLCBbZWRpdFJlcGxhY2VGdW5jdGlvbkNhbGwsIGVkaXRBZGRJbXBvcnRdKTsKICAgIGFkZEVycm9yKGVycm9yLmFkZEZpeChmaXgpKTsKICB9Cn0=",
      "regex": null
    },
    {
      "name": "python-security/file-write-others",
      "language": "PYTHON",
      "type": "REGEX",
      "entity_checked": null,
      "code": "ZNVUY3RPB24GDMLZAXQOCGF0DGVYBIWGZMLSZW5HBWUSIGNVZGUPIHSKICBJB25ZDCBTB2RLID0GCGF0DGVYBI52YXJPYWJSZXMUZ2V0KCJTB2RLIIK7CIAGCIAGAWYOZMLSZW5HBWUUAW5JBHVKZXMOIL90ZXN0LNB5IIKGFHWGZMLSZW5HBWUUC3RHCNRZV2L0ACGIDGVZDF8IKSKGEWOGICAGCMV0DXJUOWOGIH0KCIAGY29UC29SZS5SB2COBW9KZS52YWX1ZSK7CIAGAWYGKG1VZGUUDMFSDWUUAW5JBHVKZXMOINN0YXQUU19JV09USCIPKSB7CIAGICBJB25ZDCBLCNJVCIA9IGJ1AWXKRXJYB3IOBW9KZS5ZDGFYDC5SAW5LLCBTB2RLLNN0YXJ0LMNVBCWGBW9KZS5LBMQUBGLUZSWGBW9KZS5LBMQUY29SLCAIZMLSZSBJYW4GYMUGD3JPDHRLBIBIESBVDGHLCNMILCAIQ1JJVELDQUWILCAIC2VJDXJPDHKIKTSKICAGIGNVBNN0IGZPBGVUYW1LID0GCGF0DGVYBI52YXJPYWJSZXMUZ2V0KCJMAWXLIIKUDMFSDWU7CIAGICBJB25ZDCBTB2RLCYA9IG1VZGUUDMFSDWUUCMVWBGFJZUFSBCGIICISICIIKS5ZCGXPDCGIFCIPLMZPBHRLCIHLID0+IGUgIT09ICJzdGF0LlNfSVdPVEgiKTsKICAgIGNvbnN0IG5ld01vZGVzID0gbW9kZXMuam9pbigiIHwgIik7CiAgICBjb25zdCBlZGl0ID0gYnVpbGRFZGl0KG1vZGUuc3RhcnQubGluZSwgbW9kZS5zdGFydC5jb2wsIG1vZGUuZW5kLmxpbmUsIG1vZGUuZW5kLmNvbCwgInVwZGF0ZSIsIG5ld01vZGVzKTsKICAgIGNvbnN0IGZpeCA9IGJ1aWxkRml4KCJyZW1vdmUgdGhlIHdyaXRlIGZsYWciLCBbZWRpdF0pOwogICAgYWRkRXJyb3IoZXJyb3IuYWRkRml4KGZpeCkpOwogIH0KCn0=",
      "regex": "b3MuY2htb2QoJHtmaWxlfSwgJHttb2RlfSk="
    },
    {
      "name": "python-inclusive/variable-name",
      "language": "PYTHON",
      "type": "AST_CHECK",
      "entity_checked": "ASSIGNMENT",
      "code": "Y29uc3QgTkFNRVNfVE9fUkVQTEFDRSA9IG5ldyBNYXAoWwogIFsnYmxhY2tsaXN0JywgJ2RlbnlsaXN0J10sCiAgWyd3aGl0ZWxpc3QnLCAnYWxsb3dsaXN0J10sCiAgWydtYXN0ZXInLCAncHJpbWFyeSddLAogIFsnc2xhdmUnLCAnc2Vjb25kYXJ5J10sCiAgWydkdW1teScsICdwbGFjZWhvbGRlciddLApdKTsKCgpjb25zdCBjaGVja1N0cmluZyA9IChub2RlLCBhdm9pZFN0cmluZywgcmVwbGFjZVN0cmluZykgPT4gewogIGlmKG5vZGUgJiYgbm9kZS52YWx1ZSAmJiBub2RlLnZhbHVlLmluY2x1ZGVzKGF2b2lkU3RyaW5nKSkgewogICAgY29uc3QgdXBkYXRlZE5hbWUgPSBub2RlLnZhbHVlLnJlcGxhY2UoYXZvaWRTdHJpbmcsIHJlcGxhY2VTdHJpbmcpOwogICAgY29uc3QgZXJyb3IgPSBidWlsZEVycm9yKG5vZGUuc3RhcnQubGluZSwgbm9kZS5zdGFydC5jb2wsIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vZGUuZW5kLmxpbmUsIG5vZGUuZW5kLmNvbCwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYGRvIG5vdCB1c2Ugd29yZCAke2F2b2lkU3RyaW5nfWAsICJJTkZPIiwgIkJFU1RfUFJBQ1RJQ0VTIik7CiAgICBjb25zdCBlZGl0ID0gYnVpbGRFZGl0VXBkYXRlKG5vZGUuc3RhcnQubGluZSwgbm9kZS5zdGFydC5jb2wsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vZGUuZW5kLmxpbmUsIG5vZGUuZW5kLmNvbCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdXBkYXRlZE5hbWUpOwogICAgY29uc3QgZml4ID0gYnVpbGRGaXgoYHVzZSAke3VwZGF0ZWROYW1lfSBpbnN0ZWFkYCwgW2VkaXRdKTsKICAgIGFkZEVycm9yKGVycm9yLmFkZEZpeChmaXgpKTsKICB9Cn0KCgpmdW5jdGlvbiB2aXNpdChub2RlLCBmaWxlbmFtZSwgY29kZSkgewoJaWYoIW5vZGUubGVmdCkgewogICAgcmV0dXJuOwogIH0KCiAgZm9yIChjb25zdCBuYW1lIG9mIE5BTUVTX1RPX1JFUExBQ0Uua2V5cygpKSB7CiAgICBjb25zdCByZXBsYWNlbWVudCA9IE5BTUVTX1RPX1JFUExBQ0UuZ2V0KG5hbWUpOwogICAgaWYobm9kZS5sZWZ0LmFzdFR5cGUgPT09ICJzdHJpbmciKSB7CiAgICAgIGNoZWNrU3RyaW5nKG5vZGUubGVmdCwgbmFtZSwgcmVwbGFjZW1lbnQpOwogICAgfQogICAgaWYobm9kZS5sZWZ0LmFzdFR5cGUgPT09ICJsaXN0IikgewogICAgICBpZihub2RlLmxlZnQuZWxlbWVudHMpIHsKICAgICAgICBub2RlLmxlZnQuZWxlbWVudHMuZm9yRWFjaChlbGVtZW50ID0+IHsKICAgICAgICAgIGlmKGVsZW1lbnQuYXN0VHlwZSA9PT0gInN0cmluZyIpewogICAgICAgICAgICBjaGVja1N0cmluZyhlbGVtZW50LCBuYW1lLCByZXBsYWNlbWVudCk7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0KICB9Cn0=",
      "regex": null
    },
    {
      "name": "python-inclusive/function-definition",
      "language": "PYTHON",
      "type": "AST_CHECK",
      "entity_checked": "FUNCTION_DEFINITION",
      "code": "Y29uc3QgTkFNRVNfVE9fUkVQTEFDRSA9IG5ldyBNYXAoWwogIFsnYmxhY2tsaXN0JywgJ2RlbnlsaXN0J10sCiAgWyd3aGl0ZWxpc3QnLCAnYWxsb3dsaXN0J10sCiAgWydtYXN0ZXInLCAncHJpbWFyeSddLAogIFsnc2xhdmUnLCAnc2Vjb25kYXJ5J10sCiAgWydkdW1teScsICdwbGFjZWhvbGRlciddLApdKTsKCmNvbnN0IGNoZWNrU3RyaW5nID0gKG5vZGUsIGF2b2lkU3RyaW5nLCByZXBsYWNlU3RyaW5nKSA9PiB7CiAgaWYobm9kZSAmJiBub2RlLnZhbHVlICYmIG5vZGUudmFsdWUuaW5jbHVkZXMoYXZvaWRTdHJpbmcpKSB7CiAgICBjb25zdCB1cGRhdGVkTmFtZSA9IG5vZGUudmFsdWUucmVwbGFjZShhdm9pZFN0cmluZywgcmVwbGFjZVN0cmluZyk7CiAgICBjb25zdCBlcnJvciA9IGJ1aWxkRXJyb3Iobm9kZS5zdGFydC5saW5lLCBub2RlLnN0YXJ0LmNvbCwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9kZS5lbmQubGluZSwgbm9kZS5lbmQuY29sLCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICBgZG8gbm90IHVzZSB3b3JkICR7YXZvaWRTdHJpbmd9YCwgIklORk8iLCAiQkVTVF9QUkFDVElDRVMiKTsKICAgIGNvbnN0IGVkaXQgPSBidWlsZEVkaXRVcGRhdGUobm9kZS5zdGFydC5saW5lLCBub2RlLnN0YXJ0LmNvbCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9kZS5lbmQubGluZSwgbm9kZS5lbmQuY29sLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cGRhdGVkTmFtZSk7CiAgICBjb25zdCBmaXggPSBidWlsZEZpeChgdXNlICR7dXBkYXRlZE5hbWV9IGluc3RlYWRgLCBbZWRpdF0pOwogICAgYWRkRXJyb3IoZXJyb3IuYWRkRml4KGZpeCkpOwogIH0KfQoKZnVuY3Rpb24gdmlzaXQobm9kZSwgZmlsZW5hbWUsIGNvZGUpIHsKICAKICAvLyBJZiBmaWxlbmFtZSBzdGFydHMgb3IgZW5kcyB3aXRoIHRlc3RfIG9yIF90ZXN0LCBkbyBub3QgZG8gYW55dGhpbmcKICBpZihmaWxlbmFtZS5pbmNsdWRlcygiX3Rlc3QucHkiKSB8fCBmaWxlbmFtZS5zdGFydHNXaXRoKCJ0ZXN0XyIpKSB7CiAgICByZXR1cm47CiAgfQogIGZvciAoY29uc3QgbmFtZSBvZiBOQU1FU19UT19SRVBMQUNFLmtleXMoKSkgewogICAgCWNvbnN0IHJlcGxhY2VtZW50ID0gTkFNRVNfVE9fUkVQTEFDRS5nZXQobmFtZSk7CiAgICAgIGlmKG5vZGUubmFtZSAmJiBub2RlLm5hbWUudmFsdWUpIHsKCQkJCWNoZWNrU3RyaW5nKG5vZGUubmFtZSwgbmFtZSwgcmVwbGFjZW1lbnQpOwogICAgICB9CgogICAgICAvLyBpZiB0aGUgcGFyYW1ldGVycyBvZiB0aGUgZnVuY3Rpb24gYXJlIGRlZmluZWQKICAgICAgaWYgKG5vZGUucGFyYW1ldGVycyAmJiBub2RlLnBhcmFtZXRlcnMudmFsdWVzKSB7CgogICAgICAgIG5vZGUucGFyYW1ldGVycy52YWx1ZXMuZm9yRWFjaChwYXJhbWV0ZXIgPT4gewogICAgICAgICAgY2hlY2tTdHJpbmcocGFyYW1ldGVyLm5hbWUsIG5hbWUsIHJlcGxhY2VtZW50KTsKICAgICAgICB9KTsKICAgICAgfQogIH0KfQ==",
      "regex": null
    },
    {
      "name": "python-flask/form-validation",
      "language": "PYTHON",
      "type": "AST_CHECK",
      "entity_checked": "FUNCTION_CALL",
      "code": "ZnVuY3Rpb24gdmlzaXQobm9kZSwgZmlsZW5hbWUsIGNvZGUpIHsKCWNvbnN0IEZVTkNUSU9OX05BTUVTID0gWyJTdHJpbmdGaWVsZCIsICJQYXNzd29yZEZpZWxkIiwgIkJvb2xlYW5GaWVsZCJdOyAgCiAgLy8gSWYgZmlsZW5hbWUgc3RhcnRzIG9yIGVuZHMgd2l0aCB0ZXN0XyBvciBfdGVzdCwgZG8gbm90IGRvIGFueXRoaW5nCiAgaWYoZmlsZW5hbWUuaW5jbHVkZXMoIl90ZXN0LnB5IikgfHwgZmlsZW5hbWUuc3RhcnRzV2l0aCgidGVzdF8iKSkgewogICAgcmV0dXJuOwogIH0KICAKICBpZighbm9kZS5mdW5jdGlvbk5hbWUpewogICAgY29uc29sZS5sb2coImJwbG9wIik7CiAgICByZXR1cm47CiAgfQogIAogIGlmKCFGVU5DVElPTl9OQU1FUy5pbmNsdWRlcyhub2RlLmZ1bmN0aW9uTmFtZS52YWx1ZSkpewogICAgcmV0dXJuOwogIH0KICAKICAKICAvLyBHZXQgdGhlIGxpc3Qgb2YgYXJndW1lbnQKICBjb25zdCBhcmd1bWVudHMgPSAobm9kZS5hcmd1bWVudHMgJiYgbm9kZS5hcmd1bWVudHMudmFsdWVzKSB8fCBbXTsKICAKICAvLyBHZXQgYWxsIHRoZSBwYWNrYWdlIGxpc3QgdGhhdCBhcmUgaW1wb3J0ZWQgd2l0aCAiaW1wb3J0IDxuYW1lPiIKICBjb25zdCB1c2VXdGZGb3JtcyA9IG5vZGUuZ2V0SW1wb3J0cygpLmZpbHRlcihyID0+IHIucGtnICYmIHIucGtnLnZhbHVlID09PSAid3Rmb3JtcyIpLmxlbmd0aCA+IDA7CiAgCgljb25zdCBoYXNWYWxpZGF0b3JzQXJndW1lbnQgPSBhcmd1bWVudHMuZmlsdGVyKGEgPT4gYS5uYW1lICYmIGEubmFtZS52YWx1ZSA9PT0gInZhbGlkYXRvcnMiKS5sZW5ndGggPiAwOwogIGNvbnNvbGUubG9nKGhhc1ZhbGlkYXRvcnNBcmd1bWVudCk7CiAgCiAgaWYoIWhhc1ZhbGlkYXRvcnNBcmd1bWVudCl7CiAgICAvLyBidWlsZCB0aGUgZXJyb3IKICAgIGNvbnN0IGVycm9yID0gYnVpbGRFcnJvcihub2RlLnN0YXJ0LmxpbmUsIG5vZGUuc3RhcnQuY29sLCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICBub2RlLmVuZC5saW5lLCBub2RlLmVuZC5jb2wsIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIGAke25vZGUuZnVuY3Rpb25OYW1lLnZhbHVlfSBkb2VzIG5vdCB1c2UgdmFsaWRhdG9yc2AsICJXQVJOSU5HIiwgIkNSSVRJQ0FMIik7CiAgICAvLyBidWlsZCB0aGUgZml4IChyZXBsYWNlIGZvbyBieSBiYXIpCiAgICAKICAgIGNvbnN0IGVkaXQgPSBidWlsZEVkaXRBZGQobm9kZS5lbmQubGluZSwgbm9kZS5lbmQuY29sIC0gMSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcmd1bWVudHMubGVuZ3RoID4gMCA/ICIsIHZhbGlkYXRvcnM9W10iIDogInZhbGlkYXRvcnM9W10iKQogICAgLy8gYnVpbGQgYSBmaXggd2l0aCBvbmUgZWRpdAogICAgY29uc3QgZml4ID0gYnVpbGRGaXgoImFkZCB2YWxpZGF0b3JzIiwgW2VkaXRdKTsKICAgIAogICAgLy8gcmVwb3J0IGFuIGVycm9yIHdpdGggYSBmaXgKICAgIGFkZEVycm9yKGVycm9yLmFkZEZpeChmaXgpKTsKICB9Cn0KICA=",
      "regex": null
    },
    {
      "name": "python-flask/no-debug-mode",
      "language": "PYTHON",
      "type": "AST_CHECK",
      "entity_checked": "FUNCTION_CALL",
      "code": "ZnVuY3Rpb24gcHJpbnRBcmd1bWVudChhKSB7CiAgaWYoYS5uYW1lICYmIGEudmFsdWUpewogICAgcmV0dXJuIGAke2EubmFtZS5zdHJ9ID0gJHthLnZhbHVlLnN0cn1gOwogIH0KICByZXR1cm4gYCR7YS52YWx1ZS5zdHJ9YDsKfQoKZnVuY3Rpb24gdmlzaXQobm9kZSkgewoKICBjb25zdCB1c2VGbGFzayA9IG5vZGUuY29udGV4dC5pbXBvcnRzLmZpbHRlcihpID0+IHsKICAgIGNvbnN0IHVzZUZsYXNrQXNJbXBvcnQgPSBpLmFzdFR5cGUgPT09ICJpbXBvcnRwYWNrYWdlIiAmJiBpLm5hbWUuc3RyID09PSAiZmxhc2siOwogICAgY29uc3QgdXNlRmxhc2tBc0Zyb20gPSBpLmFzdFR5cGUgPT09ICJmcm9tc3RhdGVtZW50IiAmJiBpLnBrZy5zdHIgPT09ICJmbGFzayI7CiAgICByZXR1cm4gdXNlRmxhc2tBc0ltcG9ydCB8fCB1c2VGbGFza0FzRnJvbTsKICB9KS5sZW5ndGggPiAwOwogIGNvbnN0IHVzZURlYnVnID0gbm9kZS5hcmd1bWVudHMgJiYgbm9kZS5hcmd1bWVudHMudmFsdWVzICYmIG5vZGUuYXJndW1lbnRzLnZhbHVlcy5maWx0ZXIoYSA9PiBhLm5hbWUgJiYgYS5uYW1lLnN0ciA9PT0gImRlYnVnIiAmJiBhLnZhbHVlICYmIGEudmFsdWUuc3RyID09PSAiVHJ1ZSIpLmxlbmd0aCA+IDA7CgoKICBpZiAodXNlRGVidWcgJiYgdXNlRmxhc2spIHsKICAgIGNvbnN0IGxhc3RBcmd1bWVudCA9IG5vZGUuYXJndW1lbnRzLnZhbHVlc1tub2RlLmFyZ3VtZW50cy52YWx1ZXMubGVuZ3RoIC0gMV07CiAgICBjb25zdCBsYXN0QXJndW1lbnRQb3NpdGlvbiA9IGxhc3RBcmd1bWVudC52YWx1ZS5lbmQ7CgogICAgY29uc3QgYXJndW1lbnRzV2l0aG91dERlYnVnID0gbm9kZS5hcmd1bWVudHMudmFsdWVzLmZpbHRlcihhID0+IChhLm5hbWUgJiYgYS5uYW1lLnN0ciAhPT0gImRlYnVnIikgJiYgKGEudmFsdWUgJiYgYS52YWx1ZS5zdHIgIT09ICJUcnVlIikpOwogICAgY29uc3QgbmV3QXJndW1lbnRzID0gYXJndW1lbnRzV2l0aG91dERlYnVnLm1hcChhID0+IHByaW50QXJndW1lbnQoYSkpLmpvaW4oIiwgIik7CiAgICBjb25zdCBuZXdGdW5jdGlvbkNhbGwgPSBgYXBwLnJ1bigke2FyZ3VtZW50c1dpdGhvdXREZWJ1Z30pYDsKICAgIGNvbnN0IGVkaXRSZW1vdmVEZWJ1Z0ZsYWcgPSBidWlsZEVkaXRVcGRhdGUobm9kZS5hcmd1bWVudHMuc3RhcnQubGluZSwgbm9kZS5hcmd1bWVudHMuc3RhcnQuY29sLCBsYXN0QXJndW1lbnRQb3NpdGlvbi5saW5lLCBsYXN0QXJndW1lbnRQb3NpdGlvbi5jb2wsIG5ld0FyZ3VtZW50cykKICAgIGNvbnN0IGZpeCA9IGJ1aWxkRml4KCJyZW1vdmUgZGVidWcgZmxhZyIsIFtlZGl0UmVtb3ZlRGVidWdGbGFnXSk7CgogICAgY29uc3QgZXJyb3IgPSBidWlsZEVycm9yKG5vZGUuc3RhcnQubGluZSwgbm9kZS5zdGFydC5jb2wsIG5vZGUuZW5kLmxpbmUsIG5vZGUuZW5kLmNvbCwgImRvIG5vdCB1c2UgZGVidWcgPSBUcnVlIiwgIkNSSVRJQ0FMIiwgIlNBRkVUWSIpOwoKICAgIGFkZEVycm9yKGVycm9yLmFkZEZpeChmaXgpKTsKICB9Cgp9",
      "regex": null
    }
  ]
}

{"rules": [{"name": "python-best-practices/replace-format-string", "language": "PYTHON", "ruleType": "AST_CHECK", "entityChecked": "FUNCTION_CALL", "code": "ZnVuY3Rpb24gdmlzaXQobm9kZSwgZmlsZW5hbWUsIGNvZGUpIHsKICBpZiAobm9kZS5mdW5jdGlvbk5hbWUudmFsdWUgIT09ICJmb3JtYXQiKXsKICAgIHJldHVybjsKICB9CiAgaWYgKCFub2RlLm1vZHVsZU9yT2JqZWN0IHx8ICFub2RlLm1vZHVsZU9yT2JqZWN0LnZhbHVlIHx8ICFub2RlLmFyZ3VtZW50cyB8fCAhbm9kZS5hcmd1bWVudHMudmFsdWVzKXsKICAgIHJldHVybjsKICB9CiAgdmFyIG5ld1RleHQgPSBub2RlLm1vZHVsZU9yT2JqZWN0LnZhbHVlOwogIGNvbnN0IGFyZ3VtZW50cyA9IG5vZGUuYXJndW1lbnRzLnZhbHVlcy5tYXAoYSA9PiB7CiAgICByZXR1cm4gYS52YWx1ZS5zdHI7CiAgfSk7CiAgCiAgZm9yKHZhciBpID0gMDsgaSA8IGFyZ3VtZW50cy5sZW5ndGggOyBpID0gaSArIDEpIHsKICAgIGNvbnN0IHYgPSBhcmd1bWVudHNbaV07CiAgICBjb25zdCBpc1N0cmluZyA9IHYuc3RhcnRzV2l0aCgnIicpICYmIHYubGVuZ3RoID4gMiAmJiB2LmVuZHNXaXRoKCciJyk7CiAgICAKICAgIGlmIChpc1N0cmluZykgewogICAgICAvLyByZW1vdmUgdGhlIHF1b3RlcwogICAgICBjb25zdCBzID0gdi5zdWJzdHJpbmcoMSwgdi5sZW5ndGggLSAxKTsKICAgICAgbmV3VGV4dCA9IG5ld1RleHQucmVwbGFjZUFsbChgeyR7aX19YCwgcyk7CiAgICB9IGVsc2UgewogICAgICBuZXdUZXh0ID0gbmV3VGV4dC5yZXBsYWNlQWxsKGB7JHtpfX1gLGB7JHthcmd1bWVudHNbaV19fWApOwogICAgfQogICAgCiAgfQogICAgCiAgY29uc3QgbmV3VmFsdWUgPSBgZiR7bmV3VGV4dH1gOwogIGNvbnN0IGVycm9yID0gYnVpbGRFcnJvcihub2RlLnN0YXJ0LmxpbmUsIG5vZGUuc3RhcnQuY29sLCBub2RlLmVuZC5saW5lLCBub2RlLmVuZC5jb2wsICJGb3JtYXQgc3RyaW5nIGFyZSBvbGQgZm9ybWF0IiwgIklORk8iLCAiQkVTVF9QUkFDVElDRVMiKTsKICBjb25zdCBlZGl0ID0gYnVpbGRFZGl0KG5vZGUuc3RhcnQubGluZSwgbm9kZS5zdGFydC5jb2wsIG5vZGUuZW5kLmxpbmUsIG5vZGUuZW5kLmNvbCwgInVwZGF0ZSIsIG5ld1ZhbHVlKTsKICBjb25zdCBmaXggPSBidWlsZEZpeCgicmVwbGFjZSB3aXRoIGYtc3RyaW5nIiwgW2VkaXRdKTsKICBhZGRFcnJvcihlcnJvci5hZGRGaXgoZml4KSk7CiAgICAKfQ==", "pattern": null}, {"name": "python-best-practices/no-silent-exception", "language": "PYTHON", "ruleType": "AST_CHECK", "entityChecked": "TRY_BLOCK", "code": "ZnVuY3Rpb24gdmlzaXQobm9kZSwgZmlsZW5hbWUsIGNvZGUpIHsKICBjb25zdCBhbGxDbGF1c2VzV2l0aFBhc3MgPSBub2RlLmV4Y2VwdENsYXVzZXMuZmlsdGVyKGUgPT4gZS5nZXRDb2RlQmxvY2soKSAmJiBlLmdldENvZGVCbG9jaygpID09PSAicGFzcyIpOwogIGFsbENsYXVzZXNXaXRoUGFzcy5mb3JFYWNoKGMgPT4gewogICAgY29uc3QgZXJyb3IgPSBidWlsZEVycm9yKGMuc3RhcnQubGluZSwgYy5zdGFydC5jb2wsIGMuZW5kLmxpbmUsIGMuZW5kLmNvbCwgInNpbGVudCBleGNlcHRpb24iLCAiV0FSTklORyIsICJCRVNUX1BSQUNUSUNFUyIpOwogICAgYWRkRXJyb3IoZXJyb3IpOwogIH0pOwp9", "pattern": null}, {"name": "python-best-practices/no-if-true", "language": "PYTHON", "ruleType": "AST_CHECK", "entityChecked": "IF_STATEMENT", "code": "ZnVuY3Rpb24gdmlzaXQobm9kZSkgewogIGlmKG5vZGUuY29uZGl0aW9uICYmIG5vZGUuY29uZGl0aW9uLnJpZ2h0U2lkZSAmJiBub2RlLmNvbmRpdGlvbi5yaWdodFNpZGUuZXhwcmVzc2lvbiAmJiBub2RlLmNvbmRpdGlvbi5yaWdodFNpZGUuZXhwcmVzc2lvbi5hdG9tICYmIG5vZGUuY29uZGl0aW9uLnJpZ2h0U2lkZS5leHByZXNzaW9uLmF0b20uc3RyID09PSAiVHJ1ZSIpewogICAgY29uc3QgZXJyb3IgPSBidWlsZEVycm9yKG5vZGUuY29uZGl0aW9uLnN0YXJ0LmxpbmUsIG5vZGUuY29uZGl0aW9uLnN0YXJ0LmNvbCwgbm9kZS5jb25kaXRpb24uZW5kLmxpbmUsIG5vZGUuY29uZGl0aW9uLmVuZC5jb2wsICJkbyBub3QgbWFrZSBlcXVhbCB3aXRoIHRydWUiLCAiSU5GTyIsICJCRVNUX1BSQUNUSUNFIik7CgogICAgY29uc3QgZWRpdFJlcGxhY2VDb25kaXRpb24gPSBidWlsZEVkaXRVcGRhdGUobm9kZS5jb25kaXRpb24uc3RhcnQubGluZSwgbm9kZS5jb25kaXRpb24uc3RhcnQuY29sLCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vZGUuY29uZGl0aW9uLnJpZ2h0U2lkZS5leHByZXNzaW9uLmF0b20uZW5kLmxpbmUsIG5vZGUuY29uZGl0aW9uLnJpZ2h0U2lkZS5leHByZXNzaW9uLmF0b20uZW5kLmNvbCwgbm9kZS5jb25kaXRpb24ubGVmdFNpZGUuZ2V0VGV4dCgpKQoKCiAgICBjb25zdCBmaXggPSBidWlsZEZpeCgicmVtb3ZlIFRydWUiLCBbZWRpdFJlcGxhY2VDb25kaXRpb25dKTsKICAgIGFkZEVycm9yKGVycm9yLmFkZEZpeChmaXgpKTsKICB9Cn0=", "pattern": null}, {"name": "python-best-practices/no-generic-exception", "language": "PYTHON", "ruleType": "AST_CHECK", "entityChecked": "TRY_BLOCK", "code": "ZnVuY3Rpb24gdmlzaXQobm9kZSkgewogIGNvbnN0IGdlbmVyaWNFeGNlcHRpb25zID0gbm9kZS5leGNlcHRDbGF1c2VzLmZsYXRNYXAoZSA9PiBlLmV4Y2VwdGlvbnMuZmlsdGVyKGUgPT4gZS5zdHIgPT09ICJFeGNlcHRpb24iKSk7CgogIGZvciAodmFyIGkgPSAwIDsgaSA8IGdlbmVyaWNFeGNlcHRpb25zLmxlbmd0aCA7IGkrKykgewogICAgZXhjZXB0aW9uID0gZ2VuZXJpY0V4Y2VwdGlvbnNbaV07CiAgICBjb25zdCBlcnJvciA9IGJ1aWxkRXJyb3IoZXhjZXB0aW9uLnN0YXJ0LmxpbmUsIGV4Y2VwdGlvbi5zdGFydC5jb2wsIGV4Y2VwdGlvbi5lbmQubGluZSwgZXhjZXB0aW9uLmVuZC5jb2wsICJnZW5lcmljIGV4Y2VwdGlvbiIsICJXQVJOSU5HIiwgIkJFU1RfUFJBQ1RJQ0VTIik7CiAgICBhZGRFcnJvcihlcnJvcik7CiAgfQp9", "pattern": null}, {"name": "python-best-practices/no-exit", "language": "PYTHON", "ruleType": "AST_CHECK", "entityChecked": "FUNCTION_CALL", "code": "ZnVuY3Rpb24gdmlzaXQobm9kZSkgewogIGlmKCghbm9kZS5tb2R1bGVPck9iamVjdCB8fCBub2RlLm1vZHVsZU9yT2JqZWN0LnZhbHVlICE9PSAic3lzIikgJiYgbm9kZS5mdW5jdGlvbk5hbWUudmFsdWUgPT09ICJleGl0Iil7CiAgICBjb25zdCBoYXNPbmVBcmd1bWVudCA9IG5vZGUuYXJndW1lbnRzLnZhbHVlcyAmJiBub2RlLmFyZ3VtZW50cy52YWx1ZXMubGVuZ3RoID09PSAxOwoKICAgIGNvbnN0IGVycm9yID0gYnVpbGRFcnJvcihub2RlLnN0YXJ0LmxpbmUsIG5vZGUuc3RhcnQuY29sLCBub2RlLmVuZC5saW5lLCBub2RlLmVuZC5jb2wsICJkbyBub3QgdXNlIGV4aXQoKSIsICJDUklUSUNBTCIsICJTQUZFVFkiKTsKCiAgICBjb25zdCBhcmd1bWVudFZhbHVlID0gbm9kZS5hcmd1bWVudHMudmFsdWVzWzBdLnZhbHVlLnN0cjsKICAgIGNvbnN0IG5ld0Z1bmN0aW9uQ2FsbCA9IGBzeXMuZXhpdCgke2FyZ3VtZW50VmFsdWV9KWA7CiAgICBjb25zdCBlZGl0UmVwbGFjZUZ1bmN0aW9uQ2FsbCA9IGJ1aWxkRWRpdFVwZGF0ZShub2RlLnN0YXJ0LmxpbmUsIG5vZGUuc3RhcnQuY29sLCBub2RlLmVuZC5saW5lLCBub2RlLmVuZC5jb2wsIG5ld0Z1bmN0aW9uQ2FsbCkKCiAgICBjb25zdCBlZGl0QWRkSW1wb3J0ID0gYnVpbGRFZGl0QWRkKDEsIDEsICJpbXBvcnQgc3lzXG4iKTsKCiAgICBjb25zdCBmaXggPSBidWlsZEZpeCgicmVwbGFjZSB3aXRoIHN5cy5leGl0KCkiLCBbZWRpdFJlcGxhY2VGdW5jdGlvbkNhbGwsIGVkaXRBZGRJbXBvcnRdKTsKICAgIGFkZEVycm9yKGVycm9yLmFkZEZpeChmaXgpKTsKICB9Cn0=", "pattern": null}, {"name": "python-best-practices/no-range-loop-with-len", "language": "PYTHON", "ruleType": "AST_CHECK", "entityChecked": "UNKNOWN", "code": "ZnVuY3Rpb24gdmlzaXQobm9kZSwgZmlsZW5hbWUsIGNvZGUpIHsKICBpZihub2RlLmxpc3QgJiYgbm9kZS5saXN0LnN0cikgewogICAgY29uc3QgcGF0dGVybiA9ICAvcmFuZ2VcKFxzKmxlblwoXHMqKFthLXpBLVowLTldKylccypcKS87CiAgICBjb25zdCBmb3VuZCA9IG5vZGUubGlzdC5zdHIubWF0Y2gocGF0dGVybik7CiAgICBpZiAoZm91bmQgJiYgZm91bmQubGVuZ3RoID09PSAyKXsKICAgICAgY29uc3QgZm9yY29kZSA9IGNvZGUuc3Vic3RyaW5nKG5vZGUuc3RhdGVtZW50cy5zdGFydEluZGV4LCBub2RlLnN0YXRlbWVudHMuc3RvcEluZGV4KTsKCiAgICAgIGNvbnN0IGxpc3RuYW1lID0gZm91bmRbMV07CiAgICAgIGNvbnN0IGZvclZhcmlhYmxlID0gbm9kZS52YXJpYWJsZXNbMF0uYXRvbS5zdHI7CgogICAgICBjb25zdCB0b1JlcGxhY2UgPSBgJHtsaXN0bmFtZX1cWyR7Zm9yVmFyaWFibGV9XF1gOwoKICAgICAgY29uc3QgbmV3Q29kZUluc2lkZUZvciA9IGZvcmNvZGUucmVwbGFjZUFsbCh0b1JlcGxhY2UsIGZvclZhcmlhYmxlKTsKICAgICAgY29uc29sZS5sb2coIj09PT0iKTsKICAgICAgY29uc29sZS5sb2cobmV3Q29kZUluc2lkZUZvcik7CiAgICAgIGNvbnNvbGUubG9nKCI9PT09Iik7CiAgICAgIGNvbnN0IHJlcGxhY2VMaXN0RWRpdCA9IGJ1aWxkRWRpdFVwZGF0ZShub2RlLmxpc3Quc3RhcnQubGluZSwgbm9kZS5saXN0LnN0YXJ0LmNvbCwgbm9kZS5saXN0LmVuZC5saW5lLCBub2RlLmxpc3QuZW5kLmNvbCwgbGlzdG5hbWUpOwogICAgICBjb25zdCByZXBsYWNlRm9yQ29udGVudEVkaXQgPSBidWlsZEVkaXRVcGRhdGUobm9kZS5zdGF0ZW1lbnRzLnN0YXJ0LmxpbmUsIG5vZGUuc3RhdGVtZW50cy5zdGFydC5jb2wsIG5vZGUuc3RhdGVtZW50cy5lbmQubGluZSwgbm9kZS5zdGF0ZW1lbnRzLmVuZC5jb2wsIG5ld0NvZGVJbnNpZGVGb3IpOwogICAgICBjb25zdCBmaXggPSBidWlsZEZpeCgidXNlIHRoZSBsaXN0IGRpcmVjdGx5IiwgW3JlcGxhY2VGb3JDb250ZW50RWRpdCwgcmVwbGFjZUxpc3RFZGl0XSk7CiAgICAgIGNvbnN0IGVycm9yID0gYnVpbGRFcnJvcihub2RlLmxpc3Quc3RhcnQubGluZSwgbm9kZS5saXN0LnN0YXJ0LmNvbCwgbm9kZS5saXN0LmVuZC5saW5lLCBub2RlLmxpc3QuZW5kLmNvbCwgYGRvIG5vdCB1c2UgcmFuZ2UobGVuKCR7bGlzdG5hbWV9KSlgLCAiSU5GTyIsICJCRVNUX1BSQUNUSUNFIik7CiAgICAgIGFkZEVycm9yKGVycm9yLmFkZEZpeChmaXgpKTsKICAgIH0KCiAgfQoKfQ==", "pattern": null}, {"name": "python-best-practices/raising-not-implemented", "language": "PYTHON", "ruleType": "PATTERN", "entityChecked": null, "code": "ZnVuY3Rpb24gdmlzaXQocGF0dGVybiwgZmlsZW5hbWUsIGNvZGUpIHsKICBjb25zdCBleGNlcHRpb25OYW1lID0gcGF0dGVybi52YXJpYWJsZXMuZ2V0KCJleGNlcHRpb25OYW1lIik7CiAgaWYgKGV4Y2VwdGlvbk5hbWUgJiYgZXhjZXB0aW9uTmFtZS52YWx1ZSA9PT0gIk5vdEltcGxlbWVudGVkIikgewogICAgY29uc3QgZXJyb3IgPSBidWlsZEVycm9yKHBhdHRlcm4uc3RhcnQubGluZSwgcGF0dGVybi5zdGFydC5jb2wsIHBhdHRlcm4uZW5kLmxpbmUsIHBhdHRlcm4uZW5kLmNvbCwgInJhaXNlIE5vdEltcGxlbWVudGVkIGlzIG5vdCBhIHZhbGlkIGVycm9yIiwgIklORk8iLCAiQkVTVF9QUkFDVElDRVMiKTsKICAgIGNvbnN0IGVkaXQgPSBidWlsZEVkaXQocGF0dGVybi5zdGFydC5saW5lLCBwYXR0ZXJuLnN0YXJ0LmNvbCwgcGF0dGVybi5lbmQubGluZSwgcGF0dGVybi5lbmQuY29sLCAidXBkYXRlIiwgInJhaXNlIE5vdEltcGxlbWVudGVkRXJyb3IiKTsKICAgIGNvbnN0IGZpeCA9IGJ1aWxkRml4KCJyYWlzZSBOb3RJbXBsZW1lbnRlZEVycm9yIiwgW2VkaXRdKTsKICAgIGFkZEVycm9yKGVycm9yLmFkZEZpeChmaXgpKTsKICB9Cn0=", "pattern": "raise ${exceptionName}"}, {"name": "python-best-practices/open-add-flag", "language": "PYTHON", "ruleType": "PATTERN", "entityChecked": null, "code": "ZnVuY3Rpb24gdmlzaXQocGF0dGVybikgewogIGNvbnN0IGVycm9yID0gYnVpbGRFcnJvcihwYXR0ZXJuLnN0YXJ0LmxpbmUsIHBhdHRlcm4uc3RhcnQuY29sLCBwYXR0ZXJuLmVuZC5saW5lLCBwYXR0ZXJuLmVuZC5jb2wsICJmaWxlIHdpdGggcmVhZC1vbmx5IGRlZmluZWQiLCAiV0FSTiIsICJiZXN0cHJhY3RpY2VzIik7CiAgY29uc3QgZmlsZW5hbWUgPSBwYXR0ZXJuLnZhcmlhYmxlcy5nZXQoImZpbGUiKS52YWx1ZTsKICBjb25zdCBlZGl0ID0gYnVpbGRFZGl0KHBhdHRlcm4uc3RhcnQubGluZSwgcGF0dGVybi5zdGFydC5jb2wsIHBhdHRlcm4uZW5kLmxpbmUsIHBhdHRlcm4uZW5kLmNvbCwgInJlcGxhY2UiLCBgb3BlbihcIiR7ZmlsZW5hbWV9XCIpYCk7CiAgY29uc3QgZml4ID0gYnVpbGRGaXgoInJlbW92ZSB0aGUgcmVhZC1vbmx5IGZsYWciLCBbZWRpdF0pOwoKICBhZGRFcnJvcihlcnJvci5hZGRGaXgoZml4KSk7Cn0=", "pattern": "open(\"${file}\", \"r\")"}, {"name": "python-best-practices/no-datetime-today", "language": "PYTHON", "ruleType": "PATTERN", "entityChecked": null, "code": "ZnVuY3Rpb24gdmlzaXQocGF0dGVybiwgZmlsZW5hbWUsIGNvZGUpIHsKICBjb25zdCBlcnJvciA9IGJ1aWxkRXJyb3IocGF0dGVybi5zdGFydC5saW5lLCBwYXR0ZXJuLnN0YXJ0LmNvbCwgcGF0dGVybi5lbmQubGluZSwgcGF0dGVybi5lbmQuY29sLCAidXNlIGRhdGV0aW1lLm5vdygpIGluc3RlYWQgb2YgZGF0ZXRpbWUudG9kYXkoKSIsICJJTkZPIiwgIkJFU1RfUFJBQ1RJQ0VTIik7CiAgY29uc3QgZWRpdCA9IGJ1aWxkRWRpdChwYXR0ZXJuLnN0YXJ0LmxpbmUsIHBhdHRlcm4uc3RhcnQuY29sLCBwYXR0ZXJuLmVuZC5saW5lLCBwYXR0ZXJuLmVuZC5jb2wsICJ1cGRhdGUiLCAiZGF0ZXRpbWUubm93KCkiKTsKICBjb25zdCBmaXggPSBidWlsZEZpeCgidXNlIGRhdGV0aW1lLm5vdygpIiwgW2VkaXRdKTsKICBhZGRFcnJvcihlcnJvci5hZGRGaXgoZml4KSk7Cn0=", "pattern": "datetime.today()"}, {"name": "python-best-practices/no-assert", "language": "PYTHON", "ruleType": "PATTERN", "entityChecked": null, "code": "ZnVuY3Rpb24gdmlzaXQocGF0dGVybiwgZmlsZW5hbWUsIGNvZGUpIHsKICBpZihmaWxlbmFtZS5pbmNsdWRlcygiX3Rlc3QucHkiKSB8fCBmaWxlbmFtZS5zdGFydHNXaXRoKCJ0ZXN0XyIpKSB7CiAgICByZXR1cm47CiAgfQoKICBjb25zdCBlcnJvciA9IGJ1aWxkRXJyb3IocGF0dGVybi5zdGFydC5saW5lLCBwYXR0ZXJuLnN0YXJ0LmNvbCwgcGF0dGVybi5lbmQubGluZSwgcGF0dGVybi5lbmQuY29sLCAiTm8gYXNzZXJ0IGluIHByb2R1Y3Rpb24gY29kZSIsICJXQVJOIiwgImNvZGVzdHlsZSIpOwogIGNvbnN0IGVkaXQgPSBidWlsZEVkaXRSZW1vdmUocGF0dGVybi5zdGFydC5saW5lLCBwYXR0ZXJuLnN0YXJ0LmNvbCwgcGF0dGVybi5lbmQubGluZSwgcGF0dGVybi5lbmQuY29sKTsKICBjb25zdCBmaXggPSBidWlsZEZpeCgicmVtb3ZlIGFzc2VydCIsIFtlZGl0XSk7CiAgYWRkRXJyb3IoZXJyb3IuYWRkRml4KGZpeCkpOwp9", "pattern": "assert ${arguments}"}, {"name": "python-security/variable-sql-statement-injection", "language": "PYTHON", "ruleType": "AST_CHECK", "entityChecked": "ASSIGNMENT", "code": "Y29uc3QgaGFzUG90ZW50aWFsSW5qZWN0aW9uID0gKHF1ZXJ5KSA9PiB7CiAgY29uc3QgZm9ybWF0UmVnRXhwID0gL1x7W2EtekEtWjAtOV0qXH0vaTsKICBpZiAocXVlcnkubWF0Y2goZm9ybWF0UmVnRXhwKSkgewogICAgcmV0dXJuIHRydWU7CiAgfQogIHJldHVybiBmYWxzZTsKfTsKCmNvbnN0IGlzU3FsUXVlcnkgPSAocmFuZG9tU3RyaW5nKSA9PiB7CiAgY29uc3Qgc2VsZWN0UmVnZXhwID0gLy4qXHMqU0VMRUNUXHMrW2EtekEtWjAtOSwqXC5cX1wtXStccytGUk9NXHMrW2EtekEtWjAtOSwqXC5cX10vaTsKICBpZiAocmFuZG9tU3RyaW5nLm1hdGNoKHNlbGVjdFJlZ2V4cCkpIHsKICAgIHJldHVybiB0cnVlOwogIH0KICBjb25zdCB1cGRhdGVSZWdleHAgPSAvLipccypVUERBVEVccytbYS16QS1aMC05XF9cLV0rXHMrU0VUL2k7CiAgaWYgKHJhbmRvbVN0cmluZy5tYXRjaCh1cGRhdGVSZWdleHApKSB7CiAgICByZXR1cm4gdHJ1ZTsKICB9CiAgY29uc3QgZGVsZXRlUmVnZXhwID0gLy4qXHMqREVMRVRFXHMrRlJPTVxzK1thLXpBLVowLTksKlwuXF9cLV0rL2k7CiAgaWYgKHJhbmRvbVN0cmluZy5tYXRjaChkZWxldGVSZWdleHApKSB7CiAgICByZXR1cm4gdHJ1ZTsKICB9CiAgcmV0dXJuIGZhbHNlOwp9OwoKZnVuY3Rpb24gdmlzaXQobm9kZSwgZmlsZW5hbWUsIGNvZGUpIHsKICAKICBpZiAoZmlsZW5hbWUuaW5jbHVkZXMoIl90ZXN0LnB5IikgfHwgZmlsZW5hbWUuc3RhcnRzV2l0aCgidGVzdF8iKSkgewogIAlyZXR1cm47Cgl9CiAgCiAgaWYoIW5vZGUucmlnaHQpIHsKICAgIHJldHVybjsKICB9CgogIAogIGlmKG5vZGUucmlnaHQuYXN0VHlwZSA9PT0gInN0cmluZyIpIHsKICAgIGNvbnN0IG5vZGVTdHJpbmcgPSBub2RlLnJpZ2h0OwogICAgY29uc3Qgc3RyVmFsdWUgPSBub2RlU3RyaW5nLnZhbHVlLnRvTG93ZXJDYXNlKCk7CiAgICBpZighc3RyVmFsdWUuaW5jbHVkZXMoInNlbGVjdCIpICYmCiAgICAgICAhc3RyVmFsdWUuaW5jbHVkZXMoInVwZGF0ZSIpICYmCiAgICAgICAhc3RyVmFsdWUuaW5jbHVkZXMoImRlbGV0ZSIpKSB7CiAgICAgIHJldHVybjsKICAgIH0KICAgIGlmKGlzU3FsUXVlcnkobm9kZVN0cmluZy52YWx1ZSkgJiYgaGFzUG90ZW50aWFsSW5qZWN0aW9uKG5vZGVTdHJpbmcudmFsdWUpKXsKICAgICAgY29uc3QgZXJyb3IgPSBidWlsZEVycm9yKG5vZGVTdHJpbmcuc3RhcnQubGluZSwgbm9kZVN0cmluZy5zdGFydC5jb2wsIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9kZVN0cmluZy5lbmQubGluZSwgbm9kZVN0cmluZy5lbmQuY29sLCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJwb3RlbnRpYWwgU1FMIGluamVjdGlvbiIsICJXQVJOSU5HIiwgIlNFQ1VSSVRZIik7CiAgICAgIGFkZEVycm9yKGVycm9yKTsKCiAgICB9CiAgfQogIAogIGlmKG5vZGUucmlnaHQuYXN0VHlwZSA9PT0gImZ1bmN0aW9uY2FsbCIpIHsKICAgIGNvbnN0IGZ1bmN0aW9uQ2FsbCA9IG5vZGUucmlnaHQ7CiAgICBpZiAoIWZ1bmN0aW9uQ2FsbC5tb2R1bGVPck9iamVjdCkgewogICAgICByZXR1cm47CiAgICB9CiAgICBpZihmdW5jdGlvbkNhbGwuZnVuY3Rpb25OYW1lLnZhbHVlID09PSAiZm9ybWF0IikgewogICAgICBpZihpc1NxbFF1ZXJ5KGZ1bmN0aW9uQ2FsbC5tb2R1bGVPck9iamVjdC52YWx1ZSkgJiYgaGFzUG90ZW50aWFsSW5qZWN0aW9uKGZ1bmN0aW9uQ2FsbC5tb2R1bGVPck9iamVjdC52YWx1ZSkpewogICAgICAgIAljb25zdCBlcnJvciA9IGJ1aWxkRXJyb3IoZnVuY3Rpb25DYWxsLm1vZHVsZU9yT2JqZWN0LnN0YXJ0LmxpbmUsIGZ1bmN0aW9uQ2FsbC5tb2R1bGVPck9iamVjdC5zdGFydC5jb2wsIAogICAgICAgICAgICAgICAgICAJCQkJCQkJCSBmdW5jdGlvbkNhbGwubW9kdWxlT3JPYmplY3QuZW5kLmxpbmUsIGZ1bmN0aW9uQ2FsbC5tb2R1bGVPck9iamVjdC5lbmQuY29sLCAKICAgICAgICAgICAgICAgICAgIAkJCQkJCQkJICJwb3RlbnRpYWwgU1FMIGluamVjdGlvbiIsICJXQVJOSU5HIiwgIlNFQ1VSSVRZIik7CiAgICAgICAgICBhZGRFcnJvcihlcnJvcik7CgogICAgICB9CiAgICB9CiAgfQp9", "pattern": null}, {"name": "python-security/deserialize-untrusted-data", "language": "PYTHON", "ruleType": "AST_CHECK", "entityChecked": "FUNCTION_CALL", "code": "Y29uc3QgTU9EVUxFU19GVU5DVElPTlNfVE9fQVZPSUQgPSB7CiAgInBpY2tsZSI6IFsibG9hZHMiLCAibG9hZCIsICJVbnBpY2tsZXIiXSwKICAic2hlbHZlIjogWyJvcGVuIl0sCiAgIm1hcnNoYWwiOiBbImxvYWQiLCAibG9hZHMiXSwKICAianNvbnBpY2tsZWQiOiBbImRlY29kZSJdLAogICJwYW5kYXMiOiBbInJlYWRfcGlja2xlIl0KfQoKCmZ1bmN0aW9uIHZpc2l0KG5vZGUsIGZpbGVuYW1lLCBjb2RlKXsKICBpZighbm9kZSB8fCAhbm9kZS5mdW5jdGlvbk5hbWUgfHwgIW5vZGUubW9kdWxlT3JPYmplY3QpIHsKICAgIHJldHVybjsKICB9CiAgCiAgaWYoZmlsZW5hbWUuaW5jbHVkZXMoIl90ZXN0LnB5IikgfHwgZmlsZW5hbWUuc3RhcnRzV2l0aCgidGVzdF8iKSkgewogICAgcmV0dXJuOwogIH0KCiAgY29uc3QgbW9kdWxlID0gbm9kZS5tb2R1bGVPck9iamVjdC52YWx1ZTsKICBjb25zdCBmdW5jID0gbm9kZS5mdW5jdGlvbk5hbWUudmFsdWU7CiAgCiAgaWYoTU9EVUxFU19GVU5DVElPTlNfVE9fQVZPSURbbW9kdWxlXSkgewogICAgY29uc3QgYWxsUGFja2FnZXMgPSBub2RlLmdldEltcG9ydHMoKS5maWx0ZXIociA9PiByLnBhY2thZ2VzKS5mbGF0TWFwKGkgPT4gaS5wYWNrYWdlcy5tYXAocCA9PiBwLm5hbWUuc3RyKSk7CiAgICBjb25zdCB1c2VNb2R1bGUgPSBhbGxQYWNrYWdlcy5maWx0ZXIoaSA9PiBpID09PSBtb2R1bGUpLmxlbmd0aCA+IDA7CiAgCWlmICghdXNlTW9kdWxlKXsKICAgIAlyZXR1cm47CiAgCX0KICAgIAogICAgY29uc3QgZnVuY3Rpb25zID0gTU9EVUxFU19GVU5DVElPTlNfVE9fQVZPSURbbW9kdWxlXTsKICAgIAogICAgaWYgKGZ1bmN0aW9ucy5pbmNsdWRlcyhmdW5jKSkgewogICAgICBjb25zdCBlcnJvciA9IGJ1aWxkRXJyb3Iobm9kZS5zdGFydC5saW5lLCBub2RlLnN0YXJ0LmNvbCwgbm9kZS5lbmQubGluZSwgbm9kZS5lbmQuY29sLCBgJHttb2R1bGV9LiR7ZnVuY30gaXMgbm90IHNhZmUgZm9yIGRlc2VyaWFsaXppbmcgdW5zdHJ1c3RlZCBkYXRhYCwgIkNSSVRJQ0FMIiwgIlNFQ1VSSVRZIik7CiAgICAJYWRkRXJyb3IoZXJyb3IpOwogICAgfQogIH0KfQ==", "pattern": null}, {"name": "python-security/sql-injection", "language": "PYTHON", "ruleType": "AST_CHECK", "entityChecked": "FUNCTION_CALL", "code": "ZnVuY3Rpb24gdmlzaXQobm9kZSkgewogIC8vIG5vIGFyZ3VtZW50cwogIGlmICghbm9kZS5hcmd1bWVudHMgfHwgIW5vZGUuYXJndW1lbnRzLnZhbHVlcyB8fCBub2RlLmFyZ3VtZW50cy52YWx1ZXMubGVuZ3RoID09IDApewogICAgcmV0dXJuOwogIH0KICAKICBjb25zdCBhcmd1bWVudHMgPSBub2RlLmFyZ3VtZW50cy52YWx1ZXM7CiAgY29uc3QgbmJBcmd1bWVudHMgPSBub2RlLmFyZ3VtZW50cy52YWx1ZXMubGVuZ3RoOwoKICAvLyBubyBmdW5jdGlvbiBvciBtb2R1bGUgbmFtZQogIGlmICghbm9kZS5mdW5jdGlvbk5hbWUpewogICAgcmV0dXJuOwogIH0KICAKCiAgLy8gY29tbW9uIG5hbWVzIGdpdmVuIGZvciBjdXJzb3IgdG8gZXhlY3V0ZSBTUUwKICBjb25zdCBvYmplY3RzID0gWyJjdXJzb3IiLCAiY3VyIl07CiAgY29uc3QgYXJndW1lbnRWYWx1ZSA9IG5vZGUuYXJndW1lbnRzLnZhbHVlc1swXS52YWx1ZS52YWx1ZTsKCiAgY29uc3QgdXNlRnN0cmluZyA9IGFyZ3VtZW50VmFsdWUuc3RhcnRzV2l0aCgiZiIpOwogIGNvbnN0IHVzZUZvcm1hdFN0cmluZyA9IGFyZ3VtZW50VmFsdWUuaW5jbHVkZXMoIi5mb3JtYXQoIik7CiAgY29uc3QgaGFzRXJyb3IgPSB1c2VGc3RyaW5nIHx8IHVzZUZvcm1hdFN0cmluZzsKICAKICAKICB2YXIgZXJyb3JNZXNzYWdlID0gIkRvIG5vdCB1c2UgZi1zdHJpbmcgaW4gU1FMIHF1ZXJpZXMsIGl0IGxlYWRzIHRvIFNRTCBpbmplY3Rpb25zIjsKCiAgaWYgKHVzZUZvcm1hdFN0cmluZykgewogICAgZXJyb3JNZXNzYWdlID0gIkRvIG5vdCB1c2UgZm9ybWF0IHN0cmluZyBpbiBTUUwgcXVlcmllcywgaXQgbGVhZHMgdG8gU1FMIGluamVjdGlvbnMiOwogIH0KICAKICBpZihub2RlLm1vZHVsZU9yT2JqZWN0ICYmIG9iamVjdHMuaW5jbHVkZXMobm9kZS5tb2R1bGVPck9iamVjdC52YWx1ZSkpIHsKICAJLy8gY2hlY2sgdGhhdCB3ZSBkbyBub3QgaGF2ZSBjdXJzb3IuZXhlY3V0ZSgpIG9yIGN1ci5leGVjdXRlKCkgd2l0aCBhIHBvdGVudGlhbCBidWdneSBTUUwgcXVlcnkKICAgIG9iamVjdHMuZm9yRWFjaChvID0+IHsKICAgICAgaWYoaGFzRXJyb3IgJiYgbm9kZS5mdW5jdGlvbk5hbWUudmFsdWUgPT09ICJleGVjdXRlIiAmJiBub2RlLm1vZHVsZU9yT2JqZWN0ICYmIG5vZGUubW9kdWxlT3JPYmplY3QudmFsdWUgPT09IG8pewoKICAgICAgICBjb25zdCBlcnJvciA9IGJ1aWxkRXJyb3Iobm9kZS5zdGFydC5saW5lLCBub2RlLnN0YXJ0LmNvbCwgbm9kZS5lbmQubGluZSwgbm9kZS5lbmQuY29sLCBlcnJvck1lc3NhZ2UsICJDUklUSUNBTCIsICJTQUZFVFkiKTsKICAgICAgICBhZGRFcnJvcihlcnJvcik7CiAgICAgIH0KICAgIH0pOwogIH0KICAKICAKICBpZiAobm9kZS5mdW5jdGlvbk5hbWUgJiYgbm9kZS5mdW5jdGlvbk5hbWUudmFsdWUgPT09ICJ0ZXh0IiApIHsKICAgIC8vIGNoZWNrIGZvciBTUUwgQWxjaGVteQogICAgY29uc3QgaW1wb3J0VGV4dEZyb21TcWxBbGNoZW15ID0gbm9kZS5nZXRJbXBvcnRzKCkKICAgICAgICAgICAgICAuZmlsdGVyKHIgPT4gci5wa2cgJiYgci5wa2cudmFsdWUgPT09ICJzcWxhbGNoZW15IiAmJiByLmVsZW1lbnRzICYmIAogICAgICAgICAgICAgIHIuZWxlbWVudHMuZmlsdGVyKGUgPT4gZS5uYW1lKS5tYXAoZSA9PiBlLm5hbWUudmFsdWUpLmluY2x1ZGVzKCJ0ZXh0IikpLmxlbmd0aCA+IDA7CgogICAgaWYgKGhhc0Vycm9yICYmIGltcG9ydFRleHRGcm9tU3FsQWxjaGVteSAmJiBub2RlLmZ1bmN0aW9uTmFtZS52YWx1ZSA9PT0gInRleHQiKSB7CiAgICAgICAgY29uc3QgZXJyb3IgPSBidWlsZEVycm9yKG5vZGUuc3RhcnQubGluZSwgbm9kZS5zdGFydC5jb2wsIG5vZGUuZW5kLmxpbmUsIG5vZGUuZW5kLmNvbCwgZXJyb3JNZXNzYWdlLCAiQ1JJVElDQUwiLCAiU0FGRVRZIik7CiAgICAgICAgYWRkRXJyb3IoZXJyb3IpOwogICAgfQogIH0KfQ==", "pattern": null}, {"name": "python-security/insecure-ssl-protocols", "language": "PYTHON", "ruleType": "AST_CHECK", "entityChecked": "FUNCTION_CALL", "code": "ZnVuY3Rpb24gY2hlY2tQcm90b2NvbChub2RlLCBwcm90b2NvbCkgewogIGlmICghbm9kZS5hcmd1bWVudHMpewogICAgcmV0dXJuOwogIH0KICBpZiAoIShub2RlLmZ1bmN0aW9uTmFtZS52YWx1ZSA9PT0gIndyYXBfc29ja2V0IiAmJiBub2RlLm1vZHVsZU9yT2JqZWN0LnZhbHVlID09PSAic3NsIikpIHsKICAgIHJldHVybjsKICB9CgogIGNvbnN0IHVzZU91dGRhdGVkUHJvdG9jb2wgPSBub2RlLmFyZ3VtZW50cy52YWx1ZXMuZmlsdGVyKGEgPT4gYS52YWx1ZSAmJiBhLnZhbHVlLnN0ciA9PSBgc3NsLiR7cHJvdG9jb2x9YCkubGVuZ3RoID4gMDsKCiAgY29uc3QgYWxsUGFja2FnZXMgPSBub2RlLmdldEltcG9ydHMoKS5maWx0ZXIoaSA9PiBpLnBhY2thZ2VzKS5mbGF0TWFwKGkgPT4gaS5wYWNrYWdlcy5tYXAocCA9PiBwLm5hbWUuc3RyKSk7CiAgY29uc3QgdXNlU3NsUGFja2FnZSA9IGFsbFBhY2thZ2VzLmZpbHRlcihpID0+IGkgPT09ICJzc2wiKS5sZW5ndGggPiAwOwoKICBpZih1c2VPdXRkYXRlZFByb3RvY29sICYmIHVzZVNzbFBhY2thZ2UpewogICAgY29uc3QgZXJyb3IgPSBidWlsZEVycm9yKG5vZGUuc3RhcnQubGluZSwgbm9kZS5zdGFydC5jb2wsIG5vZGUuZW5kLmxpbmUsIG5vZGUuZW5kLmNvbCwgYFVzZSBvZiBpbnNlY3VyZSBwcm90b2NvbCAke3Byb3RvY29sfWAsICJDUklUSUNBTCIsICJTRUNVUklUWSIpOwogICAgYWRkRXJyb3IoZXJyb3IpOwogIH0gCn0KCmZ1bmN0aW9uIHZpc2l0KG5vZGUpIHsKICBpZiAoIW5vZGUuYXJndW1lbnRzKXsKICAgIHJldHVybjsKICB9CiAgaWYgKCEobm9kZS5mdW5jdGlvbk5hbWUudmFsdWUgPT09ICJ3cmFwX3NvY2tldCIgJiYgbm9kZS5tb2R1bGVPck9iamVjdC52YWx1ZSA9PT0gInNzbCIpKSB7CiAgICByZXR1cm47CiAgfQogIGNvbnN0IHByb3RvY29scyA9IFsiUFJPVE9DT0xfU1NMdjMiLCAiUFJPVE9DT0xfU1NMdjIiLCAiU1NMdjJfTUVUSE9EIiwgIlNTTHYyM19NRVRIT0QiLCAiUFJPVE9DT0xfVExTdjEiLCAiU1NMdjNfTUVUSE9EIiwgIlRMU3YxX01FVEhPRCJdOwogIHByb3RvY29scy5mb3JFYWNoKHByb3RvY29sID0+IHsKICAgIGNoZWNrUHJvdG9jb2wobm9kZSwgcHJvdG9jb2wpOwogIH0pOwoKfQ==", "pattern": null}, {"name": "python-security/aws-boto3-credentials", "language": "PYTHON", "ruleType": "AST_CHECK", "entityChecked": "FUNCTION_CALL", "code": "ZnVuY3Rpb24gdmlzaXQobm9kZSkgewogIGlmICghbm9kZS5hcmd1bWVudHMgfHwgIW5vZGUuYXJndW1lbnRzLnZhbHVlcykgewogICAgcmV0dXJuOwogIH0KICBjb25zdCBmdW5jdGlvbnMgPSBbIlNlc3Npb24iLCAiY2xpZW50Il07CgogIGlmICghbm9kZS5mdW5jdGlvbk5hbWUgfHwgIWZ1bmN0aW9ucy5pbmNsdWRlcyhub2RlLmZ1bmN0aW9uTmFtZS52YWx1ZSkpewogICAgcmV0dXJuOwogIH0KICAKICBjb25zdCBhcmd1bWVudHMgPSBub2RlLmFyZ3VtZW50cy52YWx1ZXM7CiAgY29uc3QgbmJBcmd1bWVudHMgPSBub2RlLmFyZ3VtZW50cy52YWx1ZXMubGVuZ3RoOwogIGNvbnN0IGFsbFBhY2thZ2VzID0gbm9kZS5nZXRJbXBvcnRzKCkuZmlsdGVyKGkgPT4gaS5wYWNrYWdlcykuZmxhdE1hcChpID0+IGkucGFja2FnZXMubWFwKHAgPT4gcC5uYW1lLnN0cikpOwogIGNvbnN0IHVzZUJvdG9QYWNrYWdlID0gYWxsUGFja2FnZXMuZmlsdGVyKGkgPT4gaSA9PT0gImJvdG8zIikubGVuZ3RoID4gMDsKICAKICBpZiAoIXVzZUJvdG9QYWNrYWdlKXsKICAgIHJldHVybjsKICB9CiAgCiAgY29uc3QgQUNDRVNTX0tFWV9QUkVGSVggPSBbCiAgICAiQUJJQSIsICJBQ0NBIiwgIkFHUEEiLCAiQUlEQSIsICJBSVBBIiwgIkFLSUEiLCAiQU5QQSIsICJBTlZBIiwKICAgICJBUEtBIiwgIkFST0EiLCAiQVNDQSIsICJBU0lBIl07CiAgY29uc3QgYWNjZXNzS2V5QXJndW1lbnRzID0gbm9kZS5hcmd1bWVudHMudmFsdWVzLmZpbHRlcihhID0+IGEubmFtZSAmJiBhLm5hbWUudmFsdWUgPT0gImF3c19hY2Nlc3Nfa2V5X2lkIik7CiAgY29uc3Qgc2VjcmV0S2V5QXJndW1lbnRzID0gbm9kZS5hcmd1bWVudHMudmFsdWVzLmZpbHRlcihhID0+IGEubmFtZSAmJiBhLm5hbWUudmFsdWUgPT0gImF3c19zZWNyZXRfYWNjZXNzX2tleSIpOwogIAogIGZ1bmN0aW9ucy5mb3JFYWNoKGZ1bmN0aW9uTmFtZSA9PiB7CiAgICBjb25zdCBoYXNBY2Nlc3NLZXlBcmd1bWVudCA9IGFjY2Vzc0tleUFyZ3VtZW50cy5sZW5ndGggPiAwOwogICAgY29uc3QgaGFzU2VjcmV0S2V5QXJndW1lbnQgPSBzZWNyZXRLZXlBcmd1bWVudHMubGVuZ3RoID4gMDsKICAgIAogICAgaWYoKGhhc0FjY2Vzc0tleUFyZ3VtZW50IHx8aGFzU2VjcmV0S2V5QXJndW1lbnQpICAmJiBub2RlLmZ1bmN0aW9uTmFtZS52YWx1ZSA9PT0gZnVuY3Rpb25OYW1lICYmIG5vZGUubW9kdWxlT3JPYmplY3QudmFsdWUgPT09ICJib3RvMyIpewogICAgICBjb25zdCBhY2Nlc3NLZXkgPSBhY2Nlc3NLZXlBcmd1bWVudHNbMF0udmFsdWUudmFsdWU7CiAgICAgIGNvbnN0IHNlY3JldEtleSA9IHNlY3JldEtleUFyZ3VtZW50c1swXS52YWx1ZS52YWx1ZTsKICAgICAgCiAgICAJY29uc3QgZXJyb3IgPSBidWlsZEVycm9yKG5vZGUuc3RhcnQubGluZSwgbm9kZS5zdGFydC5jb2wsIG5vZGUuZW5kLmxpbmUsIG5vZGUuZW5kLmNvbCwgIkNsZWFyIGNyZWRlbnRpYWxzIHBhc3NlZCwgdXNlIGVudmlyb25tZW50IHZhcmlhYmxlcyIsICJDUklUSUNBTCIsICJTRUNVUklUWSIpOwogICAgCWNvbnN0IGxpbmVUb0luc2VydCA9IGFyZ3VtZW50c1thcmd1bWVudHMubGVuZ3RoIC0gMV0uZW5kLmxpbmU7CiAgIAkJY29uc3QgY29sVG9JbnNlcnQgPSBhcmd1bWVudHNbYXJndW1lbnRzLmxlbmd0aCAtIDFdLmVuZC5jb2w7CiAgICAJYWRkRXJyb3IoZXJyb3IpOwogIAl9CiAgfSk7CiAgCn0=", "pattern": null}, {"name": "python-security/mktemp", "language": "PYTHON", "ruleType": "AST_CHECK", "entityChecked": "FUNCTION_CALL", "code": "ZnVuY3Rpb24gdmlzaXQobm9kZSkgewogIGlmKCFub2RlLmFyZ3VtZW50cyB8fCAhbm9kZS5hcmd1bWVudHMudmFsdWVzKSB7CiAgICByZXR1cm47CiAgfQogIAogIGlmICghbm9kZS5mdW5jdGlvbk5hbWUgfHwgbm9kZS5mdW5jdGlvbk5hbWUudmFsdWUgIT09ICJta3RlbXAiKSB7CiAgICByZXR1cm47CiAgfQogIAogIGNvbnN0IGFyZ3VtZW50cyA9IG5vZGUuYXJndW1lbnRzLnZhbHVlczsKICBjb25zdCBuYkFyZ3VtZW50cyA9IG5vZGUuYXJndW1lbnRzLnZhbHVlcy5sZW5ndGg7CiAgY29uc3QgYWxsUGFja2FnZXMgPSBub2RlLmdldEltcG9ydHMoKS5maWx0ZXIociA9PiByLnBhY2thZ2VzKS5mbGF0TWFwKGkgPT4gaS5wYWNrYWdlcy5tYXAocCA9PiBwLm5hbWUuc3RyKSk7CiAgY29uc3QgdXNlVGVtcGZpbGVQYWNrYWdlID0gYWxsUGFja2FnZXMuZmlsdGVyKGkgPT4gaSA9PT0gInRlbXBmaWxlIikubGVuZ3RoID4gMDsKICBjb25zdCBpbXBvcnRGcm9tID0gbm9kZS5nZXRJbXBvcnRzKCkKICAJLmZpbHRlcihyID0+IHIucGtnICYmIHIucGtnLnZhbHVlID09PSAidGVtcGZpbGUiICYmIHIuZWxlbWVudHMgJiYgci5lbGVtZW50cy5maWx0ZXIoZSA9PiBlLm5hbWUpLm1hcChlID0+IGUubmFtZS52YWx1ZSkuaW5jbHVkZXMoIm1rdGVtcCIpKTsKCWNvbnN0IHVzZUltcG9ydEZyb20gPSBpbXBvcnRGcm9tLmxlbmd0aCA+IDA7CiAgaWYgKCF1c2VUZW1wZmlsZVBhY2thZ2UgJiYgIXVzZUltcG9ydEZyb20pewogICAgcmV0dXJuOwogIH0KICAKCiAgaWYoKHVzZVRlbXBmaWxlUGFja2FnZSAmJiBub2RlLm1vZHVsZU9yT2JqZWN0ICYmIG5vZGUuZnVuY3Rpb25OYW1lICYmIG5vZGUuZnVuY3Rpb25OYW1lLnZhbHVlID09PSAibWt0ZW1wIiAmJiBub2RlLm1vZHVsZU9yT2JqZWN0LnZhbHVlID09PSAidGVtcGZpbGUiKSB8fAogICAgKHVzZUltcG9ydEZyb20gJiYgbm9kZS5mdW5jdGlvbk5hbWUudmFsdWUgPT09ICJta3RlbXAiKSApewogICAgY29uc3QgZXJyb3IgPSBidWlsZEVycm9yKG5vZGUuc3RhcnQubGluZSwgbm9kZS5zdGFydC5jb2wsIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vZGUuZW5kLmxpbmUsIG5vZGUuZW5kLmNvbCwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIm1rdGVtcCBpcyB1bnNhZmUiLCAiQ1JJVElDQUwiLCAiU0VDVVJJVFkiKTsKCiAgICBjb25zdCBlZGl0cyA9IFtdOwogICAgY29uc3QgZWRpdCA9IGJ1aWxkRWRpdFVwZGF0ZShub2RlLmZ1bmN0aW9uTmFtZS5zdGFydC5saW5lLCBub2RlLmZ1bmN0aW9uTmFtZS5zdGFydC5jb2wsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vZGUuZnVuY3Rpb25OYW1lLmVuZC5saW5lLCBub2RlLmZ1bmN0aW9uTmFtZS5lbmQuY29sLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAibWtzdGVtcCIpOwogICAgCiAgICBpZih1c2VJbXBvcnRGcm9tKSB7CiAgICAgIAogICAgICAgY29uc3QgYWRkTWlzc2luZ0ltcG9ydCA9IGJ1aWxkRWRpdFVwZGF0ZShpbXBvcnRGcm9tWzBdLmVsZW1lbnRzWzBdLnN0YXJ0LmxpbmUsIGltcG9ydEZyb21bMF0uZWxlbWVudHNbMF0uc3RhcnQuY29sLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbXBvcnRGcm9tWzBdLmVsZW1lbnRzWzBdLmVuZC5saW5lLCBpbXBvcnRGcm9tWzBdLmVsZW1lbnRzWzBdLmVuZC5jb2wsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAkJCQkJCQkJIm1rc3RlbXAiKTsKICAgICAgZWRpdHMucHVzaChhZGRNaXNzaW5nSW1wb3J0KTsKICAgIH0KICAgIAogICAgZWRpdHMucHVzaChlZGl0KTsKICAgIGNvbnN0IGZpeCA9IGJ1aWxkRml4KCJ1c2UgbWtzdGVtcCBpbnN0ZWFkIiwgZWRpdHMpOwogICAgYWRkRXJyb3IoZXJyb3IuYWRkRml4KGZpeCkpOwogIH0KICAKfQ==", "pattern": null}, {"name": "python-security/requests-timeout", "language": "PYTHON", "ruleType": "AST_CHECK", "entityChecked": "FUNCTION_CALL", "code": "ZnVuY3Rpb24gdmlzaXQobm9kZSkgewogIGlmKCFub2RlLmFyZ3VtZW50cyB8fCAhbm9kZS5hcmd1bWVudHMudmFsdWVzKSB7CiAgICByZXR1cm47CiAgfQogIAogIGNvbnN0IGZ1bmN0aW9ucyA9IFsicG9zdCIsICJnZXQiLCAicHV0IiwgInBhdGNoIl07CiAgCiAgaWYgKCEgbm9kZS5mdW5jdGlvbk5hbWUgfHwgIWZ1bmN0aW9ucy5pbmNsdWRlcyhub2RlLmZ1bmN0aW9uTmFtZS52YWx1ZSkpIHsKICAgIHJldHVybjsKICB9CiAgCiAgY29uc3QgYXJndW1lbnRzID0gbm9kZS5hcmd1bWVudHMudmFsdWVzOwogIGNvbnN0IG5iQXJndW1lbnRzID0gbm9kZS5hcmd1bWVudHMudmFsdWVzLmxlbmd0aDsKICBjb25zdCBhbGxQYWNrYWdlcyA9IG5vZGUuZ2V0SW1wb3J0cygpLmZpbHRlcihyID0+IHIucGFja2FnZXMpLmZsYXRNYXAoaSA9PiBpLnBhY2thZ2VzLm1hcChwID0+IHAubmFtZS5zdHIpKTsKICBjb25zdCB1c2VSZXF1ZXN0c1BhY2thZ2UgPSBhbGxQYWNrYWdlcy5maWx0ZXIoaSA9PiBpID09PSAicmVxdWVzdHMiKS5sZW5ndGggPiAwOwoKCiAgY29uc3QgaGFzVGltZW91dCA9IG5vZGUuYXJndW1lbnRzLnZhbHVlcy5maWx0ZXIoYSA9PiBhLm5hbWUgJiYgYS5uYW1lLnZhbHVlID09ICJ0aW1lb3V0IikubGVuZ3RoID4gMDsKICAKICBmdW5jdGlvbnMuZm9yRWFjaChmdW5jdGlvbk5hbWUgPT4gewogICAgY29uc3QgaW1wb3J0RnJvbSA9IG5vZGUuZ2V0SW1wb3J0cygpCiAgICAJLmZpbHRlcihyID0+IHIucGtnICYmIHIucGtnLnZhbHVlID09PSAicmVxdWVzdHMiICYmIHIuZWxlbWVudHMgJiYgci5lbGVtZW50cy5maWx0ZXIoZSA9PiBlLm5hbWUpLm1hcChlID0+IGUubmFtZS52YWx1ZSkuaW5jbHVkZXMoZnVuY3Rpb25OYW1lKSk7CgkJY29uc3QgdXNlSW1wb3J0RnJvbSA9IGltcG9ydEZyb20ubGVuZ3RoID4gMDsKCiAgICBpZigodXNlUmVxdWVzdHNQYWNrYWdlICYmICFoYXNUaW1lb3V0ICYmIG5vZGUubW9kdWxlT3JPYmplY3QgJiYgbm9kZS5mdW5jdGlvbk5hbWUgJiYgbm9kZS5mdW5jdGlvbk5hbWUudmFsdWUgPT09IGZ1bmN0aW9uTmFtZSAmJiBub2RlLm1vZHVsZU9yT2JqZWN0LnZhbHVlID09PSAicmVxdWVzdHMiKQogICAgICB8fCAodXNlSW1wb3J0RnJvbSAmJiBub2RlLmZ1bmN0aW9uTmFtZS52YWx1ZSA9PT0gZnVuY3Rpb25OYW1lICYmICFoYXNUaW1lb3V0KSl7CiAgICBjb25zdCBlcnJvciA9IGJ1aWxkRXJyb3Iobm9kZS5zdGFydC5saW5lLCBub2RlLnN0YXJ0LmNvbCwgbm9kZS5lbmQubGluZSwgbm9kZS5lbmQuY29sLCAidGltZW91dCBub3QgZGVmaW5lZCIsICJDUklUSUNBTCIsICJTQUZFVFkiKTsKICAgIGNvbnN0IGxpbmVUb0luc2VydCA9IGFyZ3VtZW50c1thcmd1bWVudHMubGVuZ3RoIC0gMV0uZW5kLmxpbmU7CiAgICBjb25zdCBjb2xUb0luc2VydCA9IGFyZ3VtZW50c1thcmd1bWVudHMubGVuZ3RoIC0gMV0uZW5kLmNvbDsKICAgIGNvbnN0IGVkaXQgPSBidWlsZEVkaXRBZGQobGluZVRvSW5zZXJ0LCBjb2xUb0luc2VydCwgIiwgdGltZW91dD01IikKICAgIGNvbnN0IGZpeCA9IGJ1aWxkRml4KCJhZGQgdGltZW91dCBhcmd1bWVudCIsIFtlZGl0XSk7CiAgICBhZGRFcnJvcihlcnJvci5hZGRGaXgoZml4KSk7CiAgfQogIH0pOwogIAp9", "pattern": null}, {"name": "python-security/yaml-load", "language": "PYTHON", "ruleType": "AST_CHECK", "entityChecked": "FUNCTION_CALL", "code": "ZnVuY3Rpb24gdmlzaXQobm9kZSwgZmlsZW5hbWUsIGNvZGUpIHsKICAKICAvLyBJZiBmaWxlbmFtZSBzdGFydHMgb3IgZW5kcyB3aXRoIHRlc3RfIG9yIF90ZXN0LCBkbyBub3QgZG8gYW55dGhpbmcKICBpZihmaWxlbmFtZS5pbmNsdWRlcygiX3Rlc3QucHkiKSB8fCBmaWxlbmFtZS5zdGFydHNXaXRoKCJ0ZXN0XyIpKSB7CiAgICByZXR1cm47CiAgfQogIAogIC8vIGlmIHRoZSBmdW5jdGlvbiBpcyBub3QgZGVmaW5lZCBvciBub3QgZXF1YWwgdG8gImluZm8iCiAgLy8gd2UgY2FuIHJldHVybi4KICBpZighbm9kZS5mdW5jdGlvbk5hbWUgfHwgbm9kZS5mdW5jdGlvbk5hbWUudmFsdWUgIT09ICJsb2FkIil7CiAgICByZXR1cm47CiAgfQogIAogIC8vIElmIHRoZSBhbmFseXplciBkaWQgbm90IGdldCB0aGUgYXJndW1lbnRzIG9yIGlmIHRoZXJlIGlzIG5vIGFyZ3VtZW50LCBleGl0CiAgaWYoIW5vZGUuYXJndW1lbnRzIHx8ICFub2RlLmFyZ3VtZW50cy52YWx1ZXMgfHwgbm9kZS5hcmd1bWVudHMudmFsdWVzLmxlbmd0aCAgPT09IDApIHsKICAgIHJldHVybjsKICB9CiAgCgogIAogIC8vIEdldCB0aGUgbGlzdCBvZiBhcmd1bWVudAogIGNvbnN0IGFyZ3VtZW50cyA9IG5vZGUuYXJndW1lbnRzLnZhbHVlczsKICBjb25zdCBuYkFyZ3VtZW50cyA9IG5vZGUuYXJndW1lbnRzLnZhbHVlcy5sZW5ndGg7CiAgCiAgLy8gR2V0IGFsbCB0aGUgcGFja2FnZSBsaXN0IHRoYXQgYXJlIGltcG9ydGVkIHdpdGggImltcG9ydCA8bmFtZT4iCiAgY29uc3QgYWxsUGFja2FnZXMgPSBub2RlLmdldEltcG9ydHMoKS5maWx0ZXIociA9PiByLnBhY2thZ2VzKS5mbGF0TWFwKGkgPT4gaS5wYWNrYWdlcy5tYXAocCA9PiBwLm5hbWUuc3RyKSk7CiAgCiAgLy8gRG8gd2UgdXNlIHRoZSBsb2dnaW5nIHBhY2thZ2UgZm9yIFB5dGhvbj8KICBjb25zdCB1c2VZYW1sUGFja2FnZSA9IGFsbFBhY2thZ2VzLmZpbHRlcihpID0+IGkgPT09ICJ5YW1sIikubGVuZ3RoID4gMDsKCiAgY29uc3QgdXNlQnlJbXBvcnQgPSB1c2VZYW1sUGFja2FnZSAmJiBub2RlLm1vZHVsZU9yT2JqZWN0ICYmIG5vZGUubW9kdWxlT3JPYmplY3QudmFsdWUgPT09ICJ5YW1sIjsKCiAgCiAgY29uc3QgaW1wb3J0RnJvbVN0YXRlbWVudHMgPSBub2RlLmdldEltcG9ydHMoKQogIAkuZmlsdGVyKHIgPT4gci5wa2cgJiYgci5wa2cudmFsdWUgPT09ICJ5YW1sIiAmJiByLmVsZW1lbnRzICYmIAogICAgICAgICAgICByLmVsZW1lbnRzLmZpbHRlcihlID0+IGUubmFtZSkubWFwKGUgPT4gZS5uYW1lLnZhbHVlKS5pbmNsdWRlcygibG9hZCIpKTsKICBjb25zdCBpbXBvcnRGcm9tID0gaW1wb3J0RnJvbVN0YXRlbWVudHMubGVuZ3RoID4gMDsKCWNvbnN0IHVzZUJ5SW1wb3J0RnJvbSA9IGltcG9ydEZyb20gJiYgIW5vZGUubW9kdWxlT3JPYmplY3Q7CiAgCiAgCiAgY29uc3QgaGFzU2FmZUxvYWRlciA9IGFyZ3VtZW50cy5maWx0ZXIoYSA9PiBhLm5hbWUgJiYgYS5uYW1lID09PSAiTG9hZGVyIiAmJiBhLnZhbHVlICYmIGEudmFsdWUudmFsdWUuaW5jbHVkZXMoIlNhZmVMb2FkZXIiKSkubGVuZ3RoID4gMDsKICAKICBpZighaGFzU2FmZUxvYWRlciAmJiAodXNlQnlJbXBvcnQgfHwgdXNlQnlJbXBvcnRGcm9tKSl7CiAgICAvLyBidWlsZCB0aGUgZXJyb3IKICAgIGNvbnN0IGVycm9yID0gYnVpbGRFcnJvcihub2RlLmZ1bmN0aW9uTmFtZS5zdGFydC5saW5lLCBub2RlLmZ1bmN0aW9uTmFtZS5zdGFydC5jb2wsIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vZGUuZnVuY3Rpb25OYW1lLmVuZC5saW5lLCBub2RlLmZ1bmN0aW9uTmFtZS5lbmQuY29sLCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAicHJlZmVyIHVzaW5nIHNhZmVfbG9hZCB0byBhdm9pZCBhcmJpdHJhcnkgY29kZSBleGVjdXRpb24iLCAiV0FSTklORyIsICJTRUNVUklUWSIpOwogICAgY29uc3QgZWRpdHMgPSBbXTsKICAgIC8vIGJ1aWxkIHRoZSBmaXggKHJlcGxhY2UgZm9vIGJ5IGJhcikKICAgIGNvbnN0IGVkaXQgPSBidWlsZEVkaXRVcGRhdGUobm9kZS5mdW5jdGlvbk5hbWUuc3RhcnQubGluZSwgbm9kZS5mdW5jdGlvbk5hbWUuc3RhcnQuY29sLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBub2RlLmZ1bmN0aW9uTmFtZS5lbmQubGluZSwgbm9kZS5mdW5jdGlvbk5hbWUuZW5kLmNvbCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgInNhZmVfbG9hZCIpOwogICAgaWYgKGltcG9ydEZyb20pIHsKICAgICAgY29uc29sZS5sb2coImFkZGl0aW9uYWwgZml4Iik7CiAgICAgIGNvbnN0IGVsZW1lbnRUb1VwZGF0ZSA9IGltcG9ydEZyb21TdGF0ZW1lbnRzWzBdLmVsZW1lbnRzLmZpbHRlcihlID0+IGUubmFtZSAmJiBlLm5hbWUudmFsdWUgPT09ICJsb2FkIilbMF07CiAgICAJY29uc3QgZWRpdEltcG9ydEZyb20gPSBidWlsZEVkaXRVcGRhdGUoZWxlbWVudFRvVXBkYXRlLnN0YXJ0LmxpbmUsIGVsZW1lbnRUb1VwZGF0ZS5zdGFydC5jb2wsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsZW1lbnRUb1VwZGF0ZS5lbmQubGluZSwgZWxlbWVudFRvVXBkYXRlLmVuZC5jb2wsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJzYWZlX2xvYWQiKTsKICAgICAgZWRpdHMucHVzaChlZGl0SW1wb3J0RnJvbSk7CiAgICB9CiAgICBlZGl0cy5wdXNoKGVkaXQpOwogICAgLy8gYnVpbGQgYSBmaXggd2l0aCBvbmUgZWRpdAogICAgY29uc3QgZml4ID0gYnVpbGRGaXgoInVzZSBzYWZlX2xvYWQiLCBlZGl0cyk7CiAgICAKICAgIC8vIHJlcG9ydCBhbiBlcnJvciB3aXRoIGEgZml4CiAgICBhZGRFcnJvcihlcnJvci5hZGRGaXgoZml4KSk7CiAgfQp9CiAg", "pattern": null}, {"name": "python-security/avoid-random", "language": "PYTHON", "ruleType": "AST_CHECK", "entityChecked": "FUNCTION_CALL", "code": "ZnVuY3Rpb24gdmlzaXQobm9kZSwgZmlsZW5hbWUsIGNvZGUpIHsKICBpZiAoZmlsZW5hbWUuaW5jbHVkZXMoIl90ZXN0LnB5IikgfHwgZmlsZW5hbWUuc3RhcnRzV2l0aCgidGVzdF8iKSkgewogIAlyZXR1cm47Cgl9CiAgCiAgaWYoIW5vZGUuZnVuY3Rpb25OYW1lKXsKICAgIHJldHVybjsKICB9CiAgaWYobm9kZS5mdW5jdGlvbk5hbWUudmFsdWUgIT09ICJyYW5kcmFuZ2UiICYmIG5vZGUuZnVuY3Rpb25OYW1lLnZhbHVlICE9PSAicmFuZG9tIil7CiAgICByZXR1cm47CiAgfQogIAogIGNvbnN0IGFsbFBhY2thZ2VzID0gbm9kZS5nZXRJbXBvcnRzKCkuZmlsdGVyKHIgPT4gci5wYWNrYWdlcykuZmxhdE1hcChpID0+IGkucGFja2FnZXMubWFwKHAgPT4gcC5uYW1lLnN0cikpOwogIGNvbnN0IHVzZVJhbmRvbVBhY2thZ2UgPSBhbGxQYWNrYWdlcy5maWx0ZXIoaSA9PiBpID09PSAicmFuZG9tIikubGVuZ3RoID4gMDsKICBjb25zdCB1c2VTZWNyZXRzUGFja2FnZSA9IGFsbFBhY2thZ2VzLmZpbHRlcihpID0+IGkgPT09ICJzZWNyZXRzIikubGVuZ3RoID4gMDsKICBjb25zdCBpbXBvcnRSYW5kb21GdW5jdGlvbkZyb20gPSBub2RlLmdldEltcG9ydHMoKQogIAkuZmlsdGVyKHIgPT4gci5wa2cgJiYgci5wa2cudmFsdWUgPT09ICJyYW5kb20iICYmIHIuZWxlbWVudHMgJiYgci5lbGVtZW50cy5maWx0ZXIoZSA9PiBlLm5hbWUpLm1hcChlID0+IGUubmFtZS52YWx1ZSkuaW5jbHVkZXMoInJhbmRvbSIpKS5sZW5ndGggPiAwOwoJY29uc3QgaW1wb3J0UmFuZFJhbmdlRnVuY3Rpb25Gcm9tID0gbm9kZS5nZXRJbXBvcnRzKCkKICAJLmZpbHRlcihyID0+IHIucGtnICYmIHIucGtnLnZhbHVlID09PSAicmFuZG9tIiAmJiByLmVsZW1lbnRzICYmIHIuZWxlbWVudHMuZmlsdGVyKGUgPT4gZS5uYW1lKS5tYXAoZSA9PiBlLm5hbWUudmFsdWUpLmluY2x1ZGVzKCJyYW5kcmFuZ2UiKSkubGVuZ3RoID4gMDsKICAKCWNvbnN0IGVkaXRzID0gW107CgoKICBpZighbm9kZS5mdW5jdGlvbk5hbWUpewogICAgcmV0dXJuOwogIH0KCiAgY29uc3QgZWRpdEFkZEltcG9ydCA9IGJ1aWxkRWRpdEFkZCgxLCAxLCAiaW1wb3J0IHNlY3JldHNcbiIpOwogIAogIGlmKHVzZVJhbmRvbVBhY2thZ2UgJiYgbm9kZS5tb2R1bGVPck9iamVjdCAmJiAKICAgICBub2RlLmZ1bmN0aW9uTmFtZSAmJiBub2RlLmZ1bmN0aW9uTmFtZS52YWx1ZSA9PT0gInJhbmRvbSIgJiYgCiAgICAgbm9kZS5tb2R1bGVPck9iamVjdC52YWx1ZSA9PT0gInJhbmRvbSIpewogICAgY29uc3QgaGFzQXJndW1lbnRzID0gKG5vZGUuYXJndW1lbnRzICYmIG5vZGUuYXJndW1lbnRzLnZhbHVlcyAmJiBub2RlLmFyZ3VtZW50cy52YWx1ZXMgJiYgbm9kZS5hcmd1bWVudHMudmFsdWVzLmxlbmd0aCA+IDApIHx8IGZhbHNlOwogIAkKICAgIHZhciBlcnJvciA9IGJ1aWxkRXJyb3Iobm9kZS5zdGFydC5saW5lLCBub2RlLnN0YXJ0LmNvbCwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vZGUuZW5kLmxpbmUsIG5vZGUuZW5kLmNvbCwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgImRvIG5vdCB1c2UgcmFuZG9tIiwgIldBUk5JTkciLCAiU0VDVVJJVFkiKTsKCiAgICBpZighaGFzQXJndW1lbnRzKSB7CiAgICAgICAgICAKICAgICAJY29uc3QgZWRpdCA9IGJ1aWxkRWRpdFVwZGF0ZShub2RlLnN0YXJ0LmxpbmUsIG5vZGUuc3RhcnQuY29sLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vZGUuZW5kLmxpbmUsIG5vZGUuZW5kLmNvbCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAic2VjcmV0cy5yYW5kYmVsb3coMTAwKSAvIDEwMCIpOwogICAgICBlZGl0cy5wdXNoKGVkaXQpOwogICAgICBpZighdXNlU2VjcmV0c1BhY2thZ2UpewogICAgICAgIGVkaXRzLnB1c2goYnVpbGRFZGl0QWRkKDEsIDEsICJpbXBvcnQgc2VjcmV0c1xuIikpOwogICAgICB9CiAgICAgIGNvbnN0IGZpeCA9IGJ1aWxkRml4KCJ1c2Ugc2VjcmV0cy5yYW5kYmVsb3cgaW5zdGVhZCIsIGVkaXRzKTsKICAgICAgZXJyb3IgPSBlcnJvci5hZGRGaXgoZml4KTsKICAgIH0KICAgIAogICAJYWRkRXJyb3IoZXJyb3IpOwogIH0KICBpZihpbXBvcnRSYW5kb21GdW5jdGlvbkZyb20gJiYgCiAgICAgbm9kZS5mdW5jdGlvbk5hbWUgJiYgbm9kZS5mdW5jdGlvbk5hbWUudmFsdWUgPT09ICJyYW5kb20iKXsKICAgIGNvbnN0IGhhc0FyZ3VtZW50cyA9IChub2RlLmFyZ3VtZW50cyAmJiBub2RlLmFyZ3VtZW50cy52YWx1ZXMgJiYgCiAgICAgICAgICAgICAgICAgICAgICAgICAgbm9kZS5hcmd1bWVudHMudmFsdWVzICYmIG5vZGUuYXJndW1lbnRzLnZhbHVlcy5sZW5ndGggPiAwKSB8fCBmYWxzZTsKICAJCiAgICB2YXIgZXJyb3IgPSBidWlsZEVycm9yKG5vZGUuc3RhcnQubGluZSwgbm9kZS5zdGFydC5jb2wsIAogICAgICAgICAgICAgICAgICAgICAgICAgICBub2RlLmVuZC5saW5lLCBub2RlLmVuZC5jb2wsIAogICAgICAgICAgICAgICAgICAgICAgICAgICJkbyBub3QgdXNlIHJhbmRvbSIsICJXQVJOSU5HIiwgIlNFQ1VSSVRZIik7CgogICAgaWYoIWhhc0FyZ3VtZW50cykgewogICAgICAgICAgCiAgICAgCWNvbnN0IGVkaXQgPSBidWlsZEVkaXRVcGRhdGUobm9kZS5zdGFydC5saW5lLCBub2RlLnN0YXJ0LmNvbCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBub2RlLmVuZC5saW5lLCBub2RlLmVuZC5jb2wsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgInNlY3JldHMucmFuZGJlbG93KDEwMCkgLyAxMDAiKTsKICAgICAgZWRpdHMucHVzaChlZGl0KTsKICAgICAgaWYoIXVzZVNlY3JldHNQYWNrYWdlKXsKICAgICAgICBlZGl0cy5wdXNoKGJ1aWxkRWRpdEFkZCgxLCAxLCAiaW1wb3J0IHNlY3JldHNcbiIpKTsKICAgICAgfQogICAgICBjb25zdCBmaXggPSBidWlsZEZpeCgidXNlIHNlY3JldHMucmFuZGJlbG93IGluc3RlYWQiLCBlZGl0cyk7CiAgICAgIGVycm9yID0gZXJyb3IuYWRkRml4KGZpeCk7CiAgICB9CiAgICAKICAgIGNvbnN0IGVkaXRBZGRJbXBvcnQgPSBidWlsZEVkaXRBZGQoMSwgMSwgImltcG9ydCBzeXNcbiIpOwogICAJYWRkRXJyb3IoZXJyb3IpOwogIH0KICBpZih1c2VSYW5kb21QYWNrYWdlICYmIG5vZGUubW9kdWxlT3JPYmplY3QgJiYgCiAgICAgbm9kZS5mdW5jdGlvbk5hbWUgJiYgbm9kZS5mdW5jdGlvbk5hbWUudmFsdWUgPT09ICJyYW5kcmFuZ2UiICYmIAogICAgIG5vZGUubW9kdWxlT3JPYmplY3QudmFsdWUgPT09ICJyYW5kb20iKXsKICAgIGNvbnN0IGhhc0FyZ3VtZW50cyA9IChub2RlLmFyZ3VtZW50cyAmJiBub2RlLmFyZ3VtZW50cy52YWx1ZXMgJiYgbm9kZS5hcmd1bWVudHMudmFsdWVzICYmIG5vZGUuYXJndW1lbnRzLnZhbHVlcy5sZW5ndGggPiAwKSB8fCBmYWxzZTsKICAJY29uc29sZS5sb2coImhlcmUiKTsKICAgIGlmIChoYXNBcmd1bWVudHMpIHsKICAgICAgCXZhciBlcnJvciA9IGJ1aWxkRXJyb3Iobm9kZS5zdGFydC5saW5lLCBub2RlLnN0YXJ0LmNvbCwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vZGUuZW5kLmxpbmUsIG5vZGUuZW5kLmNvbCwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJkbyBub3QgdXNlIHJhbmdyYW5nZSIsICJXQVJOSU5HIiwgIlNFQ1VSSVRZIik7CgogICAgICBjb25zdCBmaXJzdEFyZ3VtZW50VmFsdWUgPSBub2RlLmFyZ3VtZW50cy52YWx1ZXNbMF0udmFsdWUudmFsdWU7CiAgICAgIGNvbnN0IGVkaXQgPSBidWlsZEVkaXRVcGRhdGUobm9kZS5zdGFydC5saW5lLCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBub2RlLnN0YXJ0LmNvbCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBub2RlLmVuZC5saW5lLCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBub2RlLmVuZC5jb2wsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYHNlY3JldHMucmFuZGJlbG93KCR7Zmlyc3RBcmd1bWVudFZhbHVlfSlgKTsKICAgICAgZWRpdHMucHVzaChlZGl0KTsKICAgICAgaWYoIXVzZVNlY3JldHNQYWNrYWdlKXsKICAgICAgICBlZGl0cy5wdXNoKGJ1aWxkRWRpdEFkZCgxLCAxLCAiaW1wb3J0IHNlY3JldHNcbiIpKTsKICAgICAgfQogICAgICBjb25zdCBmaXggPSBidWlsZEZpeCgidXNlIHNlY3JldHMucmFuZGJlbG93IGluc3RlYWQiLCBlZGl0cyk7CiAgICAgIGVycm9yID0gZXJyb3IuYWRkRml4KGZpeCk7CgogICAgCWFkZEVycm9yKGVycm9yKTsKICAgIH0KICB9CiAgCiAgaWYoaW1wb3J0UmFuZFJhbmdlRnVuY3Rpb25Gcm9tICYmIAogICAgIG5vZGUuZnVuY3Rpb25OYW1lICYmIG5vZGUuZnVuY3Rpb25OYW1lLnZhbHVlID09PSAicmFuZHJhbmdlIil7CiAgICBjb25zdCBoYXNBcmd1bWVudHMgPSAobm9kZS5hcmd1bWVudHMgJiYgbm9kZS5hcmd1bWVudHMudmFsdWVzICYmIG5vZGUuYXJndW1lbnRzLnZhbHVlcyAmJiBub2RlLmFyZ3VtZW50cy52YWx1ZXMubGVuZ3RoID4gMCkgfHwgZmFsc2U7CiAgCQogICAgdmFyIGVycm9yID0gYnVpbGRFcnJvcihub2RlLnN0YXJ0LmxpbmUsIG5vZGUuc3RhcnQuY29sLCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9kZS5lbmQubGluZSwgbm9kZS5lbmQuY29sLCAKICAgICAgICAgICAgICAgICAgICAgICAgICAiZG8gbm90IHVzZSByYW5kcmFuZ2UiLCAiV0FSTklORyIsICJTRUNVUklUWSIpOwoKICAgIGlmKCFoYXNBcmd1bWVudHMpIHsKICAgICAgICAgIAogICAgIAljb25zdCBlZGl0ID0gYnVpbGRFZGl0VXBkYXRlKG5vZGUuc3RhcnQubGluZSwgbm9kZS5zdGFydC5jb2wsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9kZS5lbmQubGluZSwgbm9kZS5lbmQuY29sLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJzZWNyZXRzLnJhbmRiZWxvdygxMDApIC8gMTAwIik7CiAgICAgIGVkaXRzLnB1c2goZWRpdCk7CiAgICAgIGlmKCF1c2VTZWNyZXRzUGFja2FnZSl7CiAgICAgICAgZWRpdHMucHVzaChidWlsZEVkaXRBZGQoMSwgMSwgImltcG9ydCBzZWNyZXRzXG4iKSk7CiAgICAgIH0KICAgICAgY29uc3QgZml4ID0gYnVpbGRGaXgoInVzZSBzZWNyZXRzLnJhbmRiZWxvdyBpbnN0ZWFkIiwgZWRpdHMpOwogICAgICBlcnJvciA9IGVycm9yLmFkZEZpeChmaXgpOwogICAgfQogICAgCiAgICBjb25zdCBlZGl0QWRkSW1wb3J0ID0gYnVpbGRFZGl0QWRkKDEsIDEsICJpbXBvcnQgc3lzXG4iKTsKICAgCWFkZEVycm9yKGVycm9yKTsKICB9CiAgCn0=", "pattern": null}, {"name": "python-security/subprocess-shell-true", "language": "PYTHON", "ruleType": "AST_CHECK", "entityChecked": "FUNCTION_CALL", "code": "ZnVuY3Rpb24gdmlzaXQobm9kZSwgZmlsZW5hbWUsIGNvZGUpIHsKICBpZiAoIW5vZGUuYXJndW1lbnRzIHx8ICFub2RlLmFyZ3VtZW50cy52YWx1ZXMgfHwgIW5vZGUuZnVuY3Rpb25OYW1lKXsKICAgIHJldHVybjsKICB9CiAgCiAgY29uc3QgZnVuY3Rpb25zID0gWyJQb3BlbiIsICJydW4iLCAiY2FsbCJdOwogIAogIGlmICghZnVuY3Rpb25zLmluY2x1ZGVzKG5vZGUuZnVuY3Rpb25OYW1lLnZhbHVlKSkgewogICAgcmV0dXJuOwogIH0KICAKICBmdW5jdGlvbnMuZm9yRWFjaChmdW5jdGlvbk5hbWUgPT4gewogICAgY29uc3QgaGFzU2hlbGxUcnVlID0gbm9kZS5hcmd1bWVudHMudmFsdWVzLmZpbHRlcihhID0+IGEubmFtZSAmJiBhLm5hbWUudmFsdWUgPT0gInNoZWxsIiAmJiBhLnZhbHVlICYmIGEudmFsdWUudmFsdWUgPT0gIlRydWUiKS5sZW5ndGggPiAwOwogICAgY29uc3QgYWxsUGFja2FnZXMgPSBub2RlLmdldEltcG9ydHMoKS5maWx0ZXIoaSA9PiBpLnBhY2thZ2VzKS5mbGF0TWFwKGkgPT4gaS5wYWNrYWdlcy5tYXAocCA9PiBwLm5hbWUuc3RyKSk7CiAgICBjb25zdCB1c2VTdWJwcm9jZXNzUGFja2FnZSA9IGFsbFBhY2thZ2VzLmZpbHRlcihpID0+IGkgPT09ICJzdWJwcm9jZXNzIikubGVuZ3RoID4gMDsKICAgIGNvbnN0IGltcG9ydEZyb20gPSBub2RlLmdldEltcG9ydHMoKQogICAgICAgIC5maWx0ZXIociA9PiByLnBrZyAmJiByLnBrZy52YWx1ZSA9PT0gInN1YnByb2Nlc3MiICYmIHIuZWxlbWVudHMgJiYgci5lbGVtZW50cy5maWx0ZXIoZSA9PiBlLm5hbWUpLm1hcChlID0+IGUubmFtZS52YWx1ZSkuaW5jbHVkZXMoZnVuY3Rpb25OYW1lKSk7CiAgICBjb25zdCB1c2VJbXBvcnRGcm9tID0gaW1wb3J0RnJvbS5sZW5ndGggPiAwOwogICAgaWYoKGhhc1NoZWxsVHJ1ZSAmJiB1c2VTdWJwcm9jZXNzUGFja2FnZSAmJiBub2RlLmZ1bmN0aW9uTmFtZS52YWx1ZSA9PT0gZnVuY3Rpb25OYW1lICYmIG5vZGUubW9kdWxlT3JPYmplY3QudmFsdWUgPT09ICJzdWJwcm9jZXNzIil8fAogICAgICAgKHVzZUltcG9ydEZyb20gJiYgbm9kZS5mdW5jdGlvbk5hbWUudmFsdWUgPT09IGZ1bmN0aW9uTmFtZSkpewogICAgICAKICAgICAgCiAgICAgIGZvciAodmFyIGkgPSAwIDsgaSA8IG5vZGUuYXJndW1lbnRzLnZhbHVlcy5sZW5ndGggOyBpKyspIHsKICAgICAgICBjb25zdCBhcmcgPSBub2RlLmFyZ3VtZW50cy52YWx1ZXNbaV07CiAgICAgICAgY29uc3QgbmJBcmd1bWVudHMgPSBub2RlLmFyZ3VtZW50cy52YWx1ZXMubGVuZ3RoOwogICAgICAgIGlmKGFyZy5uYW1lICYmIGFyZy5uYW1lLnZhbHVlID09ICJzaGVsbCIgJiYgYXJnLnZhbHVlICYmIGFyZy52YWx1ZS52YWx1ZSA9PSAiVHJ1ZSIpIHsKICAgICAgICAgIHZhciBlcnJvciA9IGJ1aWxkRXJyb3Iobm9kZS5zdGFydC5saW5lLCBub2RlLnN0YXJ0LmNvbCwgbm9kZS5lbmQubGluZSwgbm9kZS5lbmQuY29sLCAic2hlbGwgZGVmaW5lZCB3aXRoIHRydWUiLCAiQ1JJVElDQUwiLCAiU0VDVVJJVFkiKTsKCgoJCQkJCWlmKGkgPiAwKSB7CiAgICAgICAgICAgY29uc3QgcHJldmlvdXNBcmd1bWVudCA9IG5vZGUuYXJndW1lbnRzLnZhbHVlc1tpLTFdOwogICAgICAgICAgIGNvbnN0IGVkaXQgPSBidWlsZEVkaXRSZW1vdmUocHJldmlvdXNBcmd1bWVudC5lbmQubGluZSwgcHJldmlvdXNBcmd1bWVudC5lbmQuY29sLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXJnLmVuZC5saW5lLCBhcmcuZW5kLmNvbCkKICAgIAkJCSBjb25zdCBmaXggPSBidWlsZEZpeCgicmVtb3ZlIHNoZWxsIGFyZ3VtZW50IiwgW2VkaXRdKTsKICAgICAgICAgICBlcnJvciA9IGVycm9yLmFkZEZpeChmaXgpOwogICAgICAgICAgfQoKICAgICAgICAgIAoJCQkJCSBhZGRFcnJvcihlcnJvcik7CiAgICAgICAgfQogICAgICB9ICAgICAgCiAgICB9CiAgfSk7Cn0=", "pattern": null}, {"name": "python-security/no-empty-array-as-parameter", "language": "PYTHON", "ruleType": "AST_CHECK", "entityChecked": "FUNCTION_DEFINITION", "code": "ZnVuY3Rpb24gdmlzaXQobm9kZSkgewogIGlmIChub2RlLnBhcmFtZXRlcnMgJiYgbm9kZS5wYXJhbWV0ZXJzLnZhbHVlcykgewogICAgY29uc3QgcGFyYW1ldGVyc1dpdGhFbXB0eUFycmF5ID0gbm9kZS5wYXJhbWV0ZXJzLnZhbHVlcy5maWx0ZXIocCA9PiBwICYmIHAuZGVmYXVsdFZhbHVlICYmIHAuZGVmYXVsdFZhbHVlLnZhbHVlID09PSAiW10iKTsKCiAgICBmb3IodmFyIGkgPSAwIDsgaSA8IHBhcmFtZXRlcnNXaXRoRW1wdHlBcnJheS5sZW5ndGggOyBpKyspIHsKICAgICAgY29uc3QgcGFyYW1ldGVyID0gcGFyYW1ldGVyc1dpdGhFbXB0eUFycmF5W2ldOwogICAgICBjb25zdCBlcnJvciA9IGJ1aWxkRXJyb3IocGFyYW1ldGVyLmRlZmF1bHRWYWx1ZS5zdGFydC5saW5lLCBwYXJhbWV0ZXIuZGVmYXVsdFZhbHVlLnN0YXJ0LmNvbCwgcGFyYW1ldGVyLmRlZmF1bHRWYWx1ZS5lbmQubGluZSwgcGFyYW1ldGVyLmRlZmF1bHRWYWx1ZS5lbmQuY29sLCAiY2Fubm90IHVzZSBkZWZhdWx0IGluaXRpYWxpemVyIFtdIGluIGZ1bmN0aW9uIiwgIkNSSVRJQ0FMIiwgIlNBRkVUWSIpOwogICAgICBhZGRFcnJvcihlcnJvcik7CiAgICB9CiAgfQp9", "pattern": null}, {"name": "python-security/mysql-security-credentials", "language": "PYTHON", "ruleType": "AST_CHECK", "entityChecked": "FUNCTION_CALL", "code": "ZnVuY3Rpb24gdmlzaXQobm9kZSwgZmlsZW5hbWUsIGNvZGUpIHsKICAKICAvLyBJZiBmaWxlbmFtZSBzdGFydHMgb3IgZW5kcyB3aXRoIHRlc3RfIG9yIF90ZXN0LCBkbyBub3QgZG8gYW55dGhpbmcKICBpZihmaWxlbmFtZS5pbmNsdWRlcygiX3Rlc3QucHkiKSB8fCBmaWxlbmFtZS5zdGFydHNXaXRoKCJ0ZXN0XyIpKSB7CiAgICByZXR1cm47CiAgfQogIC8vIElmIHRoZSBhbmFseXplciBkaWQgbm90IGdldCB0aGUgYXJndW1lbnRzIG9yIGlmIHRoZXJlIGlzIG5vIGFyZ3VtZW50LCBleGl0CiAgaWYoIW5vZGUuYXJndW1lbnRzIHx8ICFub2RlLmFyZ3VtZW50cy52YWx1ZXMgfHwgbm9kZS5hcmd1bWVudHMudmFsdWVzLmxlbmd0aCAgPT09IDApIHsKICAgIHJldHVybjsKICB9CgogIGlmKCFub2RlLm1vZHVsZU9yT2JqZWN0IHx8IG5vZGUubW9kdWxlT3JPYmplY3QudmFsdWUgIT09ICJteXNxbC5jb25uZWN0b3IiKXsKICAgIHJldHVybjsKICB9CiAgCgogIGlmKCFub2RlLmZ1bmN0aW9uTmFtZSB8fCBub2RlLmZ1bmN0aW9uTmFtZS52YWx1ZSAhPT0gImNvbm5lY3QiKXsKICAgIHJldHVybjsKICB9CiAgCiAgLy8gR2V0IHRoZSBsaXN0IG9mIGFyZ3VtZW50CiAgY29uc3QgYXJndW1lbnRzID0gbm9kZS5hcmd1bWVudHMudmFsdWVzOwogIGNvbnN0IG5iQXJndW1lbnRzID0gbm9kZS5hcmd1bWVudHMudmFsdWVzLmxlbmd0aDsKICAvLyBHZXQgYWxsIHRoZSBwYWNrYWdlIGxpc3QgdGhhdCBhcmUgaW1wb3J0ZWQgd2l0aCAiaW1wb3J0IDxuYW1lPiIKICBjb25zdCBhbGxQYWNrYWdlcyA9IG5vZGUuZ2V0SW1wb3J0cygpLmZpbHRlcihyID0+IHIucGFja2FnZXMpLmZsYXRNYXAoaSA9PiBpLnBhY2thZ2VzLm1hcChwID0+IHAubmFtZS5zdHIpKTsKICAvLyBEbyB3ZSB1c2UgdGhlIGxvZ2dpbmcgcGFja2FnZSBmb3IgUHl0aG9uPwogIGNvbnN0IHVzZU15c3FsQ29ubmVjdG9yUGFja2FnZSA9IGFsbFBhY2thZ2VzLmZpbHRlcihpID0+IGkgPT09ICJteXNxbC5jb25uZWN0b3IiKS5sZW5ndGggPiAwOwogIGlmICghdXNlTXlzcWxDb25uZWN0b3JQYWNrYWdlKXsKICAgIHJldHVybjsKICB9CiAgCiAgLy8gSXMgdGhlIGZpcnN0IGFyZ3VtZW50IHZhbHVlIGZvbz8KICBjb25zdCBhcmd1bWVudFBhc3N3b3JkcyA9IG5vZGUuYXJndW1lbnRzLnZhbHVlcy5maWx0ZXIoYSA9PiBhLm5hbWUgJiYgYS5uYW1lLnZhbHVlID09PSAicGFzc3dkIik7CiAgCiAgaWYoYXJndW1lbnRQYXNzd29yZHMgJiYgYXJndW1lbnRQYXNzd29yZHMubGVuZ3RoID4gMCl7CiAgICBjb25zdCBhcmd1bWVudFBhc3N3b3JkID0gYXJndW1lbnRQYXNzd29yZHNbMF07CiAgICBpZiAoIWFyZ3VtZW50UGFzc3dvcmQudmFsdWUgfHwgIWFyZ3VtZW50UGFzc3dvcmQudmFsdWUudmFsdWUpIHsKICAgICAgcmV0dXJuOwogICAgfQogICAgY29uc3QgYXJndW1lbnRWYWx1ZSA9IGFyZ3VtZW50UGFzc3dvcmQudmFsdWUudmFsdWU7CiAgICAKICAgIGlmKGFyZ3VtZW50VmFsdWUuc3RhcnRzV2l0aCgiXCIiKSB8fCBhcmd1bWVudFZhbHVlLnN0YXJ0c1dpdGgoImZcIiIpKSB7CiAgICAgICAKICAgICAgLy8gYnVpbGQgdGhlIGVycm9yCiAgICAgIGNvbnN0IGVycm9yID0gYnVpbGRFcnJvcihhcmd1bWVudFBhc3N3b3JkLnZhbHVlLnN0YXJ0LmxpbmUsIGFyZ3VtZW50UGFzc3dvcmQudmFsdWUuc3RhcnQuY29sLCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3VtZW50UGFzc3dvcmQudmFsdWUuZW5kLmxpbmUsIGFyZ3VtZW50UGFzc3dvcmQudmFsdWUuZW5kLmNvbCwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiaGFyZGNvZGVkIGNyZWRlbnRpYWwiLCAiQ1JJVElDQUwiLCAiU0VDVVJJVFkiKTsKCiAgICAgIC8vIHJlcG9ydCBhbiBlcnJvciB3aXRoIGEgZml4CiAgICAgIGFkZEVycm9yKGVycm9yKTsKICAJfQogIH0KfQogIA==", "pattern": null}, {"name": "python-security/insecure-jwt", "language": "PYTHON", "ruleType": "AST_CHECK", "entityChecked": "FUNCTION_CALL", "code": "ZnVuY3Rpb24gdmlzaXQobm9kZSwgZmlsZW5hbWUsIGNvZGUpIHsKICAKICAvLyBJZiB0aGUgYW5hbHl6ZXIgZGlkIG5vdCBnZXQgdGhlIGFyZ3VtZW50cyBvciBpZiB0aGVyZSBpcyBubyBhcmd1bWVudCwgZXhpdAogIGlmKCFub2RlLmFyZ3VtZW50cyB8fCAhbm9kZS5hcmd1bWVudHMudmFsdWVzIHx8IG5vZGUuYXJndW1lbnRzLnZhbHVlcy5sZW5ndGggID09PSAwKSB7CiAgICByZXR1cm47CiAgfQogIAogIGlmKCFub2RlLm1vZHVsZU9yT2JqZWN0IHx8IG5vZGUubW9kdWxlT3JPYmplY3QudmFsdWUgIT09ICJqd3QiKXsKICAgIHJldHVybjsKICB9CiAgCiAgLy8gaWYgdGhlIGZ1bmN0aW9uIGlzIG5vdCBkZWZpbmVkIG9yIG5vdCBlcXVhbCB0byAiaW5mbyIKICAvLyB3ZSBjYW4gcmV0dXJuLgogIGlmKCFub2RlLmZ1bmN0aW9uTmFtZSB8fCBub2RlLmZ1bmN0aW9uTmFtZS52YWx1ZSAhPT0gImRlY29kZSIpewogICAgcmV0dXJuOwogIH0KICAKICBjb25zdCBhcmd1bWVudHMgPSBub2RlLmFyZ3VtZW50cy52YWx1ZXM7CiAgY29uc3QgbmJBcmd1bWVudHMgPSBub2RlLmFyZ3VtZW50cy52YWx1ZXMubGVuZ3RoOwogIAogIGNvbnN0IGFsbFBhY2thZ2VzID0gbm9kZS5nZXRJbXBvcnRzKCkuZmlsdGVyKHIgPT4gci5wYWNrYWdlcykuZmxhdE1hcChpID0+IGkucGFja2FnZXMubWFwKHAgPT4gcC5uYW1lLnN0cikpOwogIAogIGNvbnN0IHVzZUp3dFBhY2thZ2UgPSBhbGxQYWNrYWdlcy5maWx0ZXIoaSA9PiBpID09PSAiand0IikubGVuZ3RoID4gMDsKICBpZiAoIXVzZUp3dFBhY2thZ2UpewogICAgcmV0dXJuOwogIH0KICAKICAvLyBEbyB3ZSBoYXZlIGFuIG9wdGlvbnMgYXJndW1lbnRzPwogIGNvbnN0IG9wdGlvbkFyZ3VtZW50cyA9IGFyZ3VtZW50cy5maWx0ZXIoYSA9PiBhLm5hbWUgJiYgYS5uYW1lLnZhbHVlID09PSAib3B0aW9ucyIpOwogIAogIGlmKG9wdGlvbkFyZ3VtZW50cyAmJiBvcHRpb25Bcmd1bWVudHMubGVuZ3RoID4gMCl7CiAgICBjb25zdCBvcHRpb25Bcmd1bWVudCA9IG9wdGlvbkFyZ3VtZW50c1swXTsKCiAgICBpZiAob3B0aW9uQXJndW1lbnQudmFsdWUudmFsdWUuaW5jbHVkZXMoIntcInZlcmlmeV9zaWduYXR1cmVcIjpUcnVlfSIpKSB7CiAgICAgICAgLy8gYnVpbGQgdGhlIGVycm9yCiAgICAgICAgY29uc3QgZXJyb3IgPSBidWlsZEVycm9yKG9wdGlvbkFyZ3VtZW50LnN0YXJ0LmxpbmUsIG9wdGlvbkFyZ3VtZW50LnN0YXJ0LmNvbCwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbkFyZ3VtZW50LmVuZC5saW5lLCBvcHRpb25Bcmd1bWVudC5lbmQuY29sLCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgImluc2VjdXJlIEpXVCwgY2hhbmdlIHZlcmlmeV9zaWduYXR1cmUgdG8gVHJ1ZSIsICJXQVJOSU5HIiwgIlNFQ1VSSVRZIik7CgogICAgICAgIGFkZEVycm9yKGVycm9yKTsKICAgIH0KICB9Cn0KICA=", "pattern": null}, {"name": "python-security/no-eval", "language": "PYTHON", "ruleType": "AST_CHECK", "entityChecked": "FUNCTION_CALL", "code": "ZnVuY3Rpb24gdmlzaXQobm9kZSkgewogIGlmKG5vZGUuZnVuY3Rpb25OYW1lLnZhbHVlID09PSAiZXZhbCIgJiYgIW5vZGUubW9kdWxlT3JPYmplY3QpewogICAgY29uc3QgaGFzT25lQXJndW1lbnQgPSBub2RlLmFyZ3VtZW50cyAmJiBub2RlLmFyZ3VtZW50cy52YWx1ZXMgJiYgbm9kZS5hcmd1bWVudHMudmFsdWVzLmxlbmd0aCA9PT0gMTsKCiAgICBjb25zdCBlcnJvciA9IGJ1aWxkRXJyb3Iobm9kZS5zdGFydC5saW5lLCBub2RlLnN0YXJ0LmNvbCwgbm9kZS5lbmQubGluZSwgbm9kZS5lbmQuY29sLCAiZG8gbm90IHVzZSBldmFsIGFzIHRoaXMgaXMgdW5zYWZlIiwgIkNSSVRJQ0FMIiwgIlNBRkVUWSIpOwoKICAgIGNvbnN0IGFyZ3VtZW50VmFsdWUgPSBub2RlLmFyZ3VtZW50cy52YWx1ZXNbMF0udmFsdWUuc3RyOwogICAgY29uc3QgbmV3RnVuY3Rpb25DYWxsID0gYGxpdGVyYWxfZXZhbCgke2FyZ3VtZW50VmFsdWV9KWA7CiAgICBjb25zdCBlZGl0UmVwbGFjZUZ1bmN0aW9uQ2FsbCA9IGJ1aWxkRWRpdFVwZGF0ZShub2RlLnN0YXJ0LmxpbmUsIG5vZGUuc3RhcnQuY29sLCBub2RlLmVuZC5saW5lLCBub2RlLmVuZC5jb2wsIG5ld0Z1bmN0aW9uQ2FsbCkKCiAgICBjb25zdCBlZGl0QWRkSW1wb3J0ID0gYnVpbGRFZGl0QWRkKDEsIDEsICJmcm9tIGFzdCBpbXBvcnQgbGl0ZXJhbF9ldmFsXG4iKTsKCgogICAgY29uc3QgZml4ID0gYnVpbGRGaXgoInJlcGxhY2Ugd2l0aCBsaXRlcmFsX2V2YWwiLCBbZWRpdFJlcGxhY2VGdW5jdGlvbkNhbGwsIGVkaXRBZGRJbXBvcnRdKTsKICAgIGFkZEVycm9yKGVycm9yLmFkZEZpeChmaXgpKTsKICB9Cn0=", "pattern": null}, {"name": "python-security/insecure-hash-functions", "language": "PYTHON", "ruleType": "AST_CHECK", "entityChecked": "FUNCTION_CALL", "code": "ZnVuY3Rpb24gY2hlY2tBbGdvcml0aG0obm9kZSwgaGFzaE1ldGhvZCkgewogIGlmICghKG5vZGUuZnVuY3Rpb25OYW1lLnZhbHVlID09PSAibmV3IiAmJiBub2RlLm1vZHVsZU9yT2JqZWN0LnZhbHVlID09PSAiaGFzaGxpYiIpKSB7CiAgICByZXR1cm47CiAgfQogIGlmICghbm9kZS5hcmd1bWVudHMgfHwgIW5vZGUuYXJndW1lbnRzLnZhbHVlcyl7CiAgICByZXR1cm47CiAgfQoKICBjb25zdCB1c2VPdXRkYXRlZEhhc2hNZXRob2QgPSBub2RlLmFyZ3VtZW50cy52YWx1ZXMKICAJLmZpbHRlcihhID0+IGEudmFsdWUgJiYgYS52YWx1ZS5zdHIudG9Mb3dlckNhc2UoKSA9PSBgJyR7aGFzaE1ldGhvZH0nYCkubGVuZ3RoID4gMDsKCiAgY29uc3QgYWxsUGFja2FnZXMgPSBub2RlLmdldEltcG9ydHMoKQogIAkuZmlsdGVyKGkgPT4gaS5wYWNrYWdlcykKICAJLmZsYXRNYXAoaSA9PiBpLnBhY2thZ2VzLm1hcChwID0+IHAubmFtZS5zdHIpKTsKICBjb25zdCB1c2VIYXNobGliID0gYWxsUGFja2FnZXMuZmlsdGVyKGkgPT4gaSA9PT0gImhhc2hsaWIiKS5sZW5ndGggPiAwOwoKICBpZih1c2VPdXRkYXRlZEhhc2hNZXRob2QgJiYgdXNlSGFzaGxpYil7CiAgICBjb25zdCBlcnJvciA9IGJ1aWxkRXJyb3Iobm9kZS5zdGFydC5saW5lLCBub2RlLnN0YXJ0LmNvbCwgbm9kZS5lbmQubGluZSwgbm9kZS5lbmQuY29sLCBgVXNlIG9mIGluc2VjdXJlIGhhc2hpbmcgbWV0aG9kICR7aGFzaE1ldGhvZH1gLCAiQ1JJVElDQUwiLCAiU0VDVVJJVFkiKTsKICAgIGFkZEVycm9yKGVycm9yKTsKICB9IAp9CgpmdW5jdGlvbiB2aXNpdChub2RlKSB7CiAgY29uc3QgbWV0aG9kcyA9IFsibWQ0IiwgIm1kNSIsICJzaGExIl07CiAgbWV0aG9kcy5mb3JFYWNoKG1ldGhvZCA9PiB7CiAgICBjaGVja0FsZ29yaXRobShub2RlLCBtZXRob2QpOwogIH0pOwp9", "pattern": null}, {"name": "python-security/jinja2-autoescape", "language": "PYTHON", "ruleType": "AST_CHECK", "entityChecked": "FUNCTION_CALL", "code": "ZnVuY3Rpb24gdmlzaXQobm9kZSwgZmlsZW5hbWUsIGNvZGUpIHsKICAKICBpZighbm9kZS5mdW5jdGlvbk5hbWUpIHsKICAgIHJldHVybjsKICB9CiAgCiAgaWYgKG5vZGUuZnVuY3Rpb25OYW1lLnZhbHVlID09PSAiRW52aXJvbm1lbnQiKSB7CiAgICAKICAgIGNvbnN0IHVzZUppbmphMkVudmlyb25tZW50ID0gbm9kZS5nZXRJbXBvcnRzKCkuZmlsdGVyKGkgPT4gaS5lbGVtZW50cyAmJiBpLnBrZykuZmlsdGVyKGkgPT4gaS5lbGVtZW50cy5tYXAoZSA9PiBlLm5hbWUudmFsdWUpLmluY2x1ZGVzKCJFbnZpcm9ubWVudCIpICYmIGkucGtnLnZhbHVlID09PSAiamluamEyIikubGVuZ3RoID4gMDsKCQogICAgaWYodXNlSmluamEyRW52aXJvbm1lbnQpIHsKICAgICAgaWYoIW5vZGUuYXJndW1lbnRzIHx8ICFub2RlLmFyZ3VtZW50cy52YWx1ZXMpewogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICAKICAgICAgY29uc3QgaGFzQXV0b0VzY2FwZSA9IG5vZGUuYXJndW1lbnRzLnZhbHVlcy5maWx0ZXIoYSA9PiBhLm5hbWUgJiYgYS5uYW1lLnZhbHVlID09ICJhdXRvZXNjYXBlIikubGVuZ3RoID4gMDsKCQkJCiAgICAgIGlmKGhhc0F1dG9Fc2NhcGUpewogICAgICAJY29uc3QgYXJnID0gbm9kZS5hcmd1bWVudHMudmFsdWVzLmZpbHRlcihhID0+IGEubmFtZSAmJiBhLm5hbWUudmFsdWUgPT0gImF1dG9lc2NhcGUiKVswXTsKICAgICAgICBpZihhcmcudmFsdWUudmFsdWUgPT09ICJGYWxzZSIpewogICAgICAgICAgICAgY29uc3QgZXJyb3IgPSBidWlsZEVycm9yKGFyZy5zdGFydC5saW5lLCBhcmcuc3RhcnQuY29sLCBhcmcuZW5kLmxpbmUsIGFyZy5lbmQuY29sLCAiYXV0b2VzY2FwZT1GYWxzZSBsZWFkcyB0byBYU1MgaXNzdWVzIiwgIkNSSVRJQ0FMIiwgIlNFQ1VSSVRZIik7CgogICAgICAgICAgICAgY29uc3QgZWRpdCA9IGJ1aWxkRWRpdFVwZGF0ZSgKICAgICAgICAgICAgICAgYXJnLnZhbHVlLnN0YXJ0LmxpbmUsIGFyZy52YWx1ZS5zdGFydC5jb2wsCiAgICAgICAgICAgICAgIGFyZy52YWx1ZS5lbmQubGluZSwgYXJnLnZhbHVlLmVuZC5jb2wsICJUcnVlIikKICAgIAkJCQljb25zdCBmaXggPSBidWlsZEZpeCgidXNlIGF1dG9lc2NhcGUgVHJ1ZSIsIFtlZGl0XSk7CiAgICAJCQkJYWRkRXJyb3IoZXJyb3IuYWRkRml4KGZpeCkpOwogICAgICAgIH0KICAgICAgfQogICAgfQogIH0KICAKfQ==", "pattern": null}, {"name": "python-security/file-write-others", "language": "PYTHON", "ruleType": "PATTERN", "entityChecked": null, "code": "ZnVuY3Rpb24gdmlzaXQocGF0dGVybiwgZmlsZW5hbWUsIGNvZGUpIHsKICBjb25zdCBtb2RlID0gcGF0dGVybi52YXJpYWJsZXMuZ2V0KCJtb2RlIik7CiAgCiAgaWYoZmlsZW5hbWUuaW5jbHVkZXMoIl90ZXN0LnB5IikgfHwgZmlsZW5hbWUuc3RhcnRzV2l0aCgidGVzdF8iKSkgewogICAgcmV0dXJuOwogIH0KCiAgY29uc29sZS5sb2cobW9kZS52YWx1ZSk7CiAgaWYgKG1vZGUudmFsdWUuaW5jbHVkZXMoInN0YXQuU19JV09USCIpKSB7CiAgICBjb25zdCBlcnJvciA9IGJ1aWxkRXJyb3IobW9kZS5zdGFydC5saW5lLCBtb2RlLnN0YXJ0LmNvbCwgbW9kZS5lbmQubGluZSwgbW9kZS5lbmQuY29sLCAiZmlsZSBjYW4gYmUgd3JpdHRlbiBieSBvdGhlcnMiLCAiQ1JJVElDQUwiLCAic2VjdXJpdHkiKTsKICAgIGNvbnN0IGZpbGVuYW1lID0gcGF0dGVybi52YXJpYWJsZXMuZ2V0KCJmaWxlIikudmFsdWU7CiAgICBjb25zdCBtb2RlcyA9IG1vZGUudmFsdWUucmVwbGFjZUFsbCgiICIsICIiKS5zcGxpdCgifCIpLmZpbHRlcihlID0+IGUgIT09ICJzdGF0LlNfSVdPVEgiKTsKICAgIGNvbnN0IG5ld01vZGVzID0gbW9kZXMuam9pbigiIHwgIik7CiAgICBjb25zdCBlZGl0ID0gYnVpbGRFZGl0KG1vZGUuc3RhcnQubGluZSwgbW9kZS5zdGFydC5jb2wsIG1vZGUuZW5kLmxpbmUsIG1vZGUuZW5kLmNvbCwgInVwZGF0ZSIsIG5ld01vZGVzKTsKICAgIGNvbnN0IGZpeCA9IGJ1aWxkRml4KCJyZW1vdmUgdGhlIHdyaXRlIGZsYWciLCBbZWRpdF0pOwogICAgYWRkRXJyb3IoZXJyb3IuYWRkRml4KGZpeCkpOwogIH0KCn0=", "pattern": "os.chmod(${file}, ${mode})"}, {"name": "python-inclusive/variable-name", "language": "PYTHON", "ruleType": "AST_CHECK", "entityChecked": "ASSIGNMENT", "code": "Y29uc3QgTkFNRVNfVE9fUkVQTEFDRSA9IG5ldyBNYXAoWwogIFsnYmxhY2tsaXN0JywgJ2RlbnlsaXN0J10sCiAgWyd3aGl0ZWxpc3QnLCAnYWxsb3dsaXN0J10sCiAgWydtYXN0ZXInLCAncHJpbWFyeSddLAogIFsnc2xhdmUnLCAnc2Vjb25kYXJ5J10sCiAgWydkdW1teScsICdwbGFjZWhvbGRlciddLApdKTsKCgpjb25zdCBjaGVja1N0cmluZyA9IChub2RlLCBhdm9pZFN0cmluZywgcmVwbGFjZVN0cmluZykgPT4gewogIGlmKG5vZGUgJiYgbm9kZS52YWx1ZSAmJiBub2RlLnZhbHVlLmluY2x1ZGVzKGF2b2lkU3RyaW5nKSkgewogICAgY29uc3QgdXBkYXRlZE5hbWUgPSBub2RlLnZhbHVlLnJlcGxhY2UoYXZvaWRTdHJpbmcsIHJlcGxhY2VTdHJpbmcpOwogICAgY29uc3QgZXJyb3IgPSBidWlsZEVycm9yKG5vZGUuc3RhcnQubGluZSwgbm9kZS5zdGFydC5jb2wsIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vZGUuZW5kLmxpbmUsIG5vZGUuZW5kLmNvbCwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYGRvIG5vdCB1c2Ugd29yZCAke2F2b2lkU3RyaW5nfWAsICJJTkZPIiwgIkJFU1RfUFJBQ1RJQ0VTIik7CiAgICBjb25zdCBlZGl0ID0gYnVpbGRFZGl0VXBkYXRlKG5vZGUuc3RhcnQubGluZSwgbm9kZS5zdGFydC5jb2wsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vZGUuZW5kLmxpbmUsIG5vZGUuZW5kLmNvbCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdXBkYXRlZE5hbWUpOwogICAgY29uc3QgZml4ID0gYnVpbGRGaXgoYHVzZSAke3VwZGF0ZWROYW1lfSBpbnN0ZWFkYCwgW2VkaXRdKTsKICAgIGFkZEVycm9yKGVycm9yLmFkZEZpeChmaXgpKTsKICB9Cn0KCgpmdW5jdGlvbiB2aXNpdChub2RlLCBmaWxlbmFtZSwgY29kZSkgewoJaWYoIW5vZGUubGVmdCkgewogICAgcmV0dXJuOwogIH0KCiAgZm9yIChjb25zdCBuYW1lIG9mIE5BTUVTX1RPX1JFUExBQ0Uua2V5cygpKSB7CiAgICBjb25zdCByZXBsYWNlbWVudCA9IE5BTUVTX1RPX1JFUExBQ0UuZ2V0KG5hbWUpOwogICAgaWYobm9kZS5sZWZ0LmFzdFR5cGUgPT09ICJzdHJpbmciKSB7CiAgICAgIGNoZWNrU3RyaW5nKG5vZGUubGVmdCwgbmFtZSwgcmVwbGFjZW1lbnQpOwogICAgfQogICAgaWYobm9kZS5sZWZ0LmFzdFR5cGUgPT09ICJsaXN0IikgewogICAgICBpZihub2RlLmxlZnQuZWxlbWVudHMpIHsKICAgICAgICBub2RlLmxlZnQuZWxlbWVudHMuZm9yRWFjaChlbGVtZW50ID0+IHsKICAgICAgICAgIGlmKGVsZW1lbnQuYXN0VHlwZSA9PT0gInN0cmluZyIpewogICAgICAgICAgICBjaGVja1N0cmluZyhlbGVtZW50LCBuYW1lLCByZXBsYWNlbWVudCk7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0KICB9Cn0=", "pattern": null}, {"name": "python-inclusive/function-definition", "language": "PYTHON", "ruleType": "AST_CHECK", "entityChecked": "FUNCTION_DEFINITION", "code": "Y29uc3QgTkFNRVNfVE9fUkVQTEFDRSA9IG5ldyBNYXAoWwogIFsnYmxhY2tsaXN0JywgJ2RlbnlsaXN0J10sCiAgWyd3aGl0ZWxpc3QnLCAnYWxsb3dsaXN0J10sCiAgWydtYXN0ZXInLCAncHJpbWFyeSddLAogIFsnc2xhdmUnLCAnc2Vjb25kYXJ5J10sCiAgWydkdW1teScsICdwbGFjZWhvbGRlciddLApdKTsKCmNvbnN0IGNoZWNrU3RyaW5nID0gKG5vZGUsIGF2b2lkU3RyaW5nLCByZXBsYWNlU3RyaW5nKSA9PiB7CiAgaWYobm9kZSAmJiBub2RlLnZhbHVlICYmIG5vZGUudmFsdWUuaW5jbHVkZXMoYXZvaWRTdHJpbmcpKSB7CiAgICBjb25zdCB1cGRhdGVkTmFtZSA9IG5vZGUudmFsdWUucmVwbGFjZShhdm9pZFN0cmluZywgcmVwbGFjZVN0cmluZyk7CiAgICBjb25zdCBlcnJvciA9IGJ1aWxkRXJyb3Iobm9kZS5zdGFydC5saW5lLCBub2RlLnN0YXJ0LmNvbCwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9kZS5lbmQubGluZSwgbm9kZS5lbmQuY29sLCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICBgZG8gbm90IHVzZSB3b3JkICR7YXZvaWRTdHJpbmd9YCwgIklORk8iLCAiQkVTVF9QUkFDVElDRVMiKTsKICAgIGNvbnN0IGVkaXQgPSBidWlsZEVkaXRVcGRhdGUobm9kZS5zdGFydC5saW5lLCBub2RlLnN0YXJ0LmNvbCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9kZS5lbmQubGluZSwgbm9kZS5lbmQuY29sLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cGRhdGVkTmFtZSk7CiAgICBjb25zdCBmaXggPSBidWlsZEZpeChgdXNlICR7dXBkYXRlZE5hbWV9IGluc3RlYWRgLCBbZWRpdF0pOwogICAgYWRkRXJyb3IoZXJyb3IuYWRkRml4KGZpeCkpOwogIH0KfQoKZnVuY3Rpb24gdmlzaXQobm9kZSwgZmlsZW5hbWUsIGNvZGUpIHsKICAKICAvLyBJZiBmaWxlbmFtZSBzdGFydHMgb3IgZW5kcyB3aXRoIHRlc3RfIG9yIF90ZXN0LCBkbyBub3QgZG8gYW55dGhpbmcKICBpZihmaWxlbmFtZS5pbmNsdWRlcygiX3Rlc3QucHkiKSB8fCBmaWxlbmFtZS5zdGFydHNXaXRoKCJ0ZXN0XyIpKSB7CiAgICByZXR1cm47CiAgfQogIGZvciAoY29uc3QgbmFtZSBvZiBOQU1FU19UT19SRVBMQUNFLmtleXMoKSkgewogICAgCWNvbnN0IHJlcGxhY2VtZW50ID0gTkFNRVNfVE9fUkVQTEFDRS5nZXQobmFtZSk7CiAgICAgIGlmKG5vZGUubmFtZSAmJiBub2RlLm5hbWUudmFsdWUpIHsKCQkJCWNoZWNrU3RyaW5nKG5vZGUubmFtZSwgbmFtZSwgcmVwbGFjZW1lbnQpOwogICAgICB9CgogICAgICAvLyBpZiB0aGUgcGFyYW1ldGVycyBvZiB0aGUgZnVuY3Rpb24gYXJlIGRlZmluZWQKICAgICAgaWYgKG5vZGUucGFyYW1ldGVycyAmJiBub2RlLnBhcmFtZXRlcnMudmFsdWVzKSB7CgogICAgICAgIG5vZGUucGFyYW1ldGVycy52YWx1ZXMuZm9yRWFjaChwYXJhbWV0ZXIgPT4gewogICAgICAgICAgY2hlY2tTdHJpbmcocGFyYW1ldGVyLm5hbWUsIG5hbWUsIHJlcGxhY2VtZW50KTsKICAgICAgICB9KTsKICAgICAgfQogIH0KfQ==", "pattern": null}, {"name": "python-code-style/assignment-names", "language": "PYTHON", "ruleType": "AST_CHECK", "entityChecked": "ASSIGNMENT", "code": "Y29uc3QgY2FtZWxUb1NuYWtlQ2FzZSA9IHN0ciA9PiBzdHIucmVwbGFjZSgvW0EtWl0vZywgbGV0dGVyID0+IGBfJHtsZXR0ZXIudG9Mb3dlckNhc2UoKX1gKTsKY29uc3QgdXNlQ2FtZWxDYXNlID0gKHN0cmluZykgPT4gL1tBLVpdLy50ZXN0KHN0cmluZyk7CmNvbnN0IHR3b0NvbnNlY3V0aXZlQ2FwaXRhbExldHRlcnMgPSAoc3RyaW5nKSA9PiAvW0EtWl17Mix9Ly50ZXN0KHN0cmluZyk7Cgpjb25zdCBjaGVja1N0cmluZyA9IChlbGVtZW50KSA9PiB7CgogIGlmKHVzZUNhbWVsQ2FzZShlbGVtZW50LnZhbHVlKSAmJiAhdHdvQ29uc2VjdXRpdmVDYXBpdGFsTGV0dGVycyhlbGVtZW50LnZhbHVlKSkgewogICAgY29uc3Qgc25ha2VDYXNlVmFsdWUgPSBjYW1lbFRvU25ha2VDYXNlKGVsZW1lbnQudmFsdWUpOwogICAgY29uc3QgZXJyb3IgPSBidWlsZEVycm9yKGVsZW1lbnQuc3RhcnQubGluZSwgZWxlbWVudC5zdGFydC5jb2wsIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsZW1lbnQuZW5kLmxpbmUsIGVsZW1lbnQuZW5kLmNvbCwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgInVzZSBzbmFrZV9jYXNlIGFuZCBub3QgY2FtZWxDYXNlIiwgIk1JTk9SIiwgIkJFU1RfUFJBQ1RJQ0VTIik7CiAgICBjb25zdCBlZGl0ID0gYnVpbGRFZGl0VXBkYXRlKGVsZW1lbnQuc3RhcnQubGluZSwgZWxlbWVudC5zdGFydC5jb2wsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsZW1lbnQuZW5kLmxpbmUsIGVsZW1lbnQuZW5kLmNvbCwgc25ha2VDYXNlVmFsdWUpOwogICAgY29uc3QgZml4ID0gYnVpbGRGaXgoYCR7c25ha2VDYXNlVmFsdWV9IGluc3RlYWQgb2YgJHtlbGVtZW50LnZhbHVlfWAsIFtlZGl0XSk7CiAgICBhZGRFcnJvcihlcnJvci5hZGRGaXgoZml4KSk7CiAgfQp9OwoKZnVuY3Rpb24gdmlzaXQobm9kZSwgZmlsZW5hbWUsIGNvZGUpIHsKCWlmKCFub2RlLmxlZnQpIHsKICAgIHJldHVybjsKICB9CiAgaWYobm9kZS5sZWZ0LmFzdFR5cGUgPT09ICJzdHJpbmciKXsKICAgIGNoZWNrU3RyaW5nKG5vZGUubGVmdCk7CiAgfQogIGlmKG5vZGUubGVmdC5hc3RUeXBlID09PSAibGlzdCIpIHsKICAgIGlmKG5vZGUubGVmdC5lbGVtZW50cykgewogICAgICBub2RlLmxlZnQuZWxlbWVudHMuZm9yRWFjaChlbGVtZW50ID0+IHsKICAgICAgICBpZihlbGVtZW50LmFzdFR5cGUgPT09ICJzdHJpbmciKXsKICAgICAgICAgIGNoZWNrU3RyaW5nKGVsZW1lbnQpOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9CiAgfQp9", "pattern": null}, {"name": "python-code-style/function-naming", "language": "PYTHON", "ruleType": "AST_CHECK", "entityChecked": "FUNCTION_DEFINITION", "code": "Y29uc3QgY2FtZWxUb1NuYWtlQ2FzZSA9IHN0ciA9PiBzdHIucmVwbGFjZSgvW0EtWl0vZywgbGV0dGVyID0+IGBfJHtsZXR0ZXIudG9Mb3dlckNhc2UoKX1gKTsKY29uc3QgdXNlQ2FtZWxDYXNlID0gKHN0cmluZykgPT4gL1tBLVpdLy50ZXN0KHN0cmluZyk7CgpmdW5jdGlvbiB2aXNpdChub2RlLCBmaWxlbmFtZSwgY29kZSkgewogIGNvbnN0IGZ1bmN0aW9uTmFtZSA9IG5vZGUubmFtZS52YWx1ZTsKCWlmKHVzZUNhbWVsQ2FzZShmdW5jdGlvbk5hbWUpKSB7CiAgICBjb25zdCBlcnJvciA9IGJ1aWxkRXJyb3Iobm9kZS5uYW1lLnN0YXJ0LmxpbmUsIG5vZGUubmFtZS5zdGFydC5jb2wsIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vZGUubmFtZS5lbmQubGluZSwgbm9kZS5uYW1lLmVuZC5jb2wsIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICJ1c2Ugc25ha2VfY2FzZSBhbmQgbm90IGNhbWVsQ2FzZSIsICJNSU5PUiIsICJCRVNUX1BSQUNUSUNFUyIpOwogICAgY29uc3QgZWRpdCA9IGJ1aWxkRWRpdFVwZGF0ZShub2RlLm5hbWUuc3RhcnQubGluZSwgbm9kZS5uYW1lLnN0YXJ0LmNvbCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9kZS5uYW1lLmVuZC5saW5lLCBub2RlLm5hbWUuZW5kLmNvbCwgY2FtZWxUb1NuYWtlQ2FzZShmdW5jdGlvbk5hbWUpKTsKICAgIGNvbnN0IGZpeCA9IGJ1aWxkRml4KCJjb252ZXJ0IHRvIHNuYWtlX2Nhc2UiLCBbZWRpdF0pOwogICAgYWRkRXJyb3IoZXJyb3IuYWRkRml4KGZpeCkpOwogIH0KICAKICBpZihub2RlLnBhcmFtZXRlcnMgJiYgbm9kZS5wYXJhbWV0ZXJzLnZhbHVlcykgewogICAgbm9kZS5wYXJhbWV0ZXJzLnZhbHVlcy5mb3JFYWNoKHBhcmFtZXRlciA9PiB7CiAgICAgIGNvbnN0IHBhcmFtZXRlck5hbWUgPSBwYXJhbWV0ZXIubmFtZTsKICAgICAgCiAgICAgIAlpZih1c2VDYW1lbENhc2UocGFyYW1ldGVyTmFtZS52YWx1ZSkpIHsKICAgIAkJCWNvbnN0IGVycm9yID0gYnVpbGRFcnJvcihwYXJhbWV0ZXJOYW1lLnN0YXJ0LmxpbmUsIHBhcmFtZXRlck5hbWUuc3RhcnQuY29sLCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAJCQkgcGFyYW1ldGVyTmFtZS5lbmQubGluZSwgcGFyYW1ldGVyTmFtZS5lbmQuY29sLCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAJCQkidXNlIHNuYWtlX2Nhc2UgYW5kIG5vdCBjYW1lbENhc2UiLCAiTUlOT1IiLCAiQkVTVF9QUkFDVElDRVMiKTsKICAgIAkJCWNvbnN0IGVkaXQgPSBidWlsZEVkaXRVcGRhdGUocGFyYW1ldGVyTmFtZS5zdGFydC5saW5lLCBwYXJhbWV0ZXJOYW1lLnN0YXJ0LmNvbCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFyYW1ldGVyTmFtZS5lbmQubGluZSwgcGFyYW1ldGVyTmFtZS5lbmQuY29sLCBjYW1lbFRvU25ha2VDYXNlKHBhcmFtZXRlck5hbWUudmFsdWUpKTsKICAgIAkJCWNvbnN0IGZpeCA9IGJ1aWxkRml4KCJjb252ZXJ0IHRvIHNuYWtlX2Nhc2UiLCBbZWRpdF0pOwogICAgCQkJYWRkRXJyb3IoZXJyb3IuYWRkRml4KGZpeCkpOwogIAkJCX0gCiAgICB9KTsKICB9Cn0=", "pattern": null}]}